<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.24.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="ts除了基础类型，还有通过ts的语法来定义的很多类型 基础类型 String Number Boolean symbol: 表示唯一且不可变的值，通常用作对象属性的键。 bigint：大整数 Null：表示 null 值，未赋值 Undefined：表示未定义  对象结构类型 Object Function： 函数类型 接口	interface User { id: number }	结构化契约">
<meta property="og:type" content="article">
<meta property="og:title" content="【TS】类型">
<meta property="og:url" content="http://example.com/2025/08/14/Typescript/%E3%80%90TS%E3%80%91%E7%B1%BB%E5%9E%8B/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="ts除了基础类型，还有通过ts的语法来定义的很多类型 基础类型 String Number Boolean symbol: 表示唯一且不可变的值，通常用作对象属性的键。 bigint：大整数 Null：表示 null 值，未赋值 Undefined：表示未定义  对象结构类型 Object Function： 函数类型 接口	interface User { id: number }	结构化契约">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-08-14T03:18:06.481Z">
<meta property="article:modified_time" content="2025-08-14T03:19:48.778Z">
<meta property="article:author" content="yangxin">
<meta property="article:tag" content="Typescript">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/2025/08/14/Typescript/%E3%80%90TS%E3%80%91%E7%B1%BB%E5%9E%8B/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://example.com/2025/08/14/Typescript/%E3%80%90TS%E3%80%91%E7%B1%BB%E5%9E%8B/","path":"2025/08/14/Typescript/【TS】类型/","title":"【TS】类型"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>【TS】类型 | Hexo</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  






  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Hexo</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>







</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.</span> <span class="nav-text">基础类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%B9%E8%B1%A1%E7%BB%93%E6%9E%84%E7%B1%BB%E5%9E%8B"><span class="nav-number">2.</span> <span class="nav-text">对象结构类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%86%85%E7%BD%AE%E5%AF%B9%E8%B1%A1%E7%B1%BB%E5%9E%8B"><span class="nav-number">3.</span> <span class="nav-text">内置对象类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%89%B9%E6%AE%8A%E5%9F%BA%E7%A1%80%E7%B1%BB%E5%9E%8B"><span class="nav-number">4.</span> <span class="nav-text">特殊基础类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%8D%E5%90%88%E7%B1%BB%E5%9E%8B"><span class="nav-number">5.</span> <span class="nav-text">复合类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%AB%98%E7%BA%A7%E7%B1%BB%E5%9E%8B"><span class="nav-number">6.</span> <span class="nav-text">高级类型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%9B%E5%9E%8B"><span class="nav-number">6.1.</span> <span class="nav-text">泛型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E6%B3%9B%E5%9E%8B"><span class="nav-number">6.1.1.</span> <span class="nav-text">函数泛型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8E%A5%E5%8F%A3%E6%B3%9B%E5%9E%8B"><span class="nav-number">6.1.2.</span> <span class="nav-text">接口泛型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B1%BB%E6%B3%9B%E5%9E%8B"><span class="nav-number">6.1.3.</span> <span class="nav-text">类泛型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B1%BB%E5%9E%8B%E7%BA%A6%E6%9D%9F"><span class="nav-number">6.1.4.</span> <span class="nav-text">类型约束</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%BB%98%E8%AE%A4%E7%B1%BB%E5%9E%8B%E5%8F%82%E6%95%B0"><span class="nav-number">6.1.5.</span> <span class="nav-text">默认类型参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B1%BB%E5%9E%8B%E6%8E%A8%E6%96%AD"><span class="nav-number">6.1.6.</span> <span class="nav-text">类型推断</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%87%E6%BB%A4%E7%AD%9B%E9%80%89"><span class="nav-number">6.1.7.</span> <span class="nav-text">过滤筛选</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#keyof-%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="nav-number">6.1.8.</span> <span class="nav-text">keyof 操作符</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6%E7%B1%BB%E5%9E%8B"><span class="nav-number">6.2.</span> <span class="nav-text">条件类型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#infer"><span class="nav-number">6.2.1.</span> <span class="nav-text">infer</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E5%B8%83%E5%BC%8F%E6%9D%A1%E4%BB%B6%E7%B1%BB%E5%9E%8B"><span class="nav-number">6.2.2.</span> <span class="nav-text">分布式条件类型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A3%B8%E7%B1%BB%E5%9E%8B%E5%8F%82%E6%95%B0"><span class="nav-number">6.2.3.</span> <span class="nav-text">裸类型参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%94%A8%E6%B3%95"><span class="nav-number">6.2.4.</span> <span class="nav-text">用法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%B1%BB%E5%9E%8B%E6%8E%A8%E6%96%AD-1"><span class="nav-number">6.2.4.1.</span> <span class="nav-text">类型推断</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%B1%BB%E5%9E%8B%E8%BF%87%E6%BB%A4"><span class="nav-number">6.2.4.2.</span> <span class="nav-text">类型过滤</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6%E6%98%A0%E5%B0%84"><span class="nav-number">6.2.4.3.</span> <span class="nav-text">条件映射</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B3%9B%E5%9E%8B%E7%BA%A6%E6%9D%9F"><span class="nav-number">6.2.4.4.</span> <span class="nav-text">泛型约束</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%98%A0%E5%B0%84%E7%B1%BB%E5%9E%8B"><span class="nav-number">6.3.</span> <span class="nav-text">映射类型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%9A%E8%BF%87%E6%98%A0%E5%B0%84%E5%AE%9E%E7%8E%B0ts%E9%83%A8%E5%88%86%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7%E7%B1%BB%E5%9E%8B"><span class="nav-number">6.3.1.</span> <span class="nav-text">通过映射实现ts部分使用工具类型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B1%BB%E5%9E%8B%E5%80%BC%E8%BD%AC%E6%8D%A2"><span class="nav-number">6.3.2.</span> <span class="nav-text">类型值转换</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%94%AE%E5%90%8D%E9%87%8D%E6%98%A0%E5%B0%84"><span class="nav-number">6.3.3.</span> <span class="nav-text">键名重映射</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B7%B1%E5%BA%A6%E9%80%92%E5%BD%92%E6%98%A0%E5%B0%84"><span class="nav-number">6.3.4.</span> <span class="nav-text">深度递归映射</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9E%9A%E4%B8%BE%E9%94%AE%E7%9A%84%E6%98%A0%E5%B0%84"><span class="nav-number">6.3.5.</span> <span class="nav-text">枚举键的映射</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E6%9D%BF%E5%AD%97%E9%9D%A2%E9%87%8F"><span class="nav-number">6.4.</span> <span class="nav-text">模板字面量</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%81%8D%E5%8E%86%E7%BB%84%E5%90%88%E7%94%9F%E6%88%90%E6%96%B0%E7%B1%BB%E5%9E%8B"><span class="nav-number">6.4.1.</span> <span class="nav-text">遍历组合生成新类型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%93%E5%90%88infer%E8%BF%9B%E8%A1%8C%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D"><span class="nav-number">6.4.2.</span> <span class="nav-text">结合infer进行模式匹配</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%92%E5%BD%92%E6%A8%A1%E6%9D%BF"><span class="nav-number">6.4.3.</span> <span class="nav-text">递归模板</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SQL%E6%A0%A1%E9%AA%8C"><span class="nav-number">6.4.4.</span> <span class="nav-text">SQL校验</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-API-%E8%B7%AF%E5%BE%84%E5%8F%82%E6%95%B0%E8%87%AA%E5%8A%A8%E6%8F%90%E5%8F%96%EF%BC%88RESTful-%E6%9C%8D%E5%8A%A1%EF%BC%89"><span class="nav-number">6.4.5.</span> <span class="nav-text">5. API 路径参数自动提取（RESTful 服务）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-%E7%BC%96%E8%AF%91%E6%97%B6%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E9%AA%8C%E8%AF%81%EF%BC%88%E9%AB%98%E7%BA%A7%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D%EF%BC%89"><span class="nav-number">6.4.6.</span> <span class="nav-text">6. 编译时正则表达式验证（高级模式匹配）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B1%BB%E5%9E%8B%E8%B0%93%E8%AF%8D-%E7%B1%BB%E5%9E%8B%E6%94%B6%E7%AA%84%EF%BC%9Ain"><span class="nav-number">6.5.</span> <span class="nav-text">类型谓词&#x2F;类型收窄：in</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%A4%E6%96%AD%E6%95%B0%E7%BB%84%E6%98%AF%E5%90%A6%E6%98%AF%E9%9D%9E%E7%A9%BA"><span class="nav-number">6.5.1.</span> <span class="nav-text">判断数组是否是非空</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B1%BB%E5%9E%8B%E8%B0%93%E8%AF%8D%E5%B7%A5%E5%8E%82"><span class="nav-number">6.5.2.</span> <span class="nav-text">类型谓词工厂</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%81%94%E5%90%88%E7%B1%BB%E5%9E%8B%E6%94%B6%E7%AA%84%EF%BC%88%E5%A4%84%E7%90%86%E5%A4%8D%E6%9D%82%E8%81%94%E5%90%88%E7%B1%BB%E5%9E%8B%EF%BC%89"><span class="nav-number">6.5.3.</span> <span class="nav-text">联合类型收窄（处理复杂联合类型）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%92%E5%BD%92%E7%B1%BB%E5%9E%8B%E5%AE%88%E5%8D%AB%EF%BC%88%E5%A4%84%E7%90%86%E5%B5%8C%E5%A5%97%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%EF%BC%89"><span class="nav-number">6.5.4.</span> <span class="nav-text">递归类型守卫（处理嵌套数据结构）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%82%E6%AD%A5%E7%B1%BB%E5%9E%8B%E5%AE%88%E5%8D%AB%EF%BC%88%E7%BB%93%E5%90%88-Promise%EF%BC%89"><span class="nav-number">6.5.5.</span> <span class="nav-text">异步类型守卫（结合 Promise）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%93%81%E7%89%8C%E5%8C%96%E7%B1%BB%E5%9E%8B%EF%BC%88Nominal-Typing%EF%BC%89%E9%AA%8C%E8%AF%81"><span class="nav-number">6.5.6.</span> <span class="nav-text">品牌化类型（Nominal Typing）验证</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B1%BB%E5%9E%8B%E8%B0%93%E8%AF%8D%E4%B8%8E%E6%96%AD%E8%A8%80%E5%87%BD%E6%95%B0%E7%BB%93%E5%90%88"><span class="nav-number">6.5.7.</span> <span class="nav-text">类型谓词与断言函数结合</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%86%85%E7%BD%AE%E9%AB%98%E7%BA%A7%E7%B1%BB%E5%9E%8B"><span class="nav-number">7.</span> <span class="nav-text">内置高级类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E9%93%BE"><span class="nav-number">8.</span> <span class="nav-text">参链</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">yangxin</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">104</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">25</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">26</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/08/14/Typescript/%E3%80%90TS%E3%80%91%E7%B1%BB%E5%9E%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="yangxin">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="【TS】类型 | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          【TS】类型
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2025-08-14 11:18:06 / Modified: 11:19:48" itemprop="dateCreated datePublished" datetime="2025-08-14T11:18:06+08:00">2025-08-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Typescript/" itemprop="url" rel="index"><span itemprop="name">Typescript</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>ts除了基础类型，还有通过ts的语法来定义的很多类型</p>
<h2 id="基础类型"><a href="#基础类型" class="headerlink" title="基础类型"></a>基础类型</h2><ul>
<li>String</li>
<li>Number</li>
<li>Boolean</li>
<li>symbol: 表示唯一且不可变的值，通常用作对象属性的键。</li>
<li>bigint：大整数</li>
<li>Null：表示 null 值，未赋值</li>
<li>Undefined：表示未定义</li>
</ul>
<h2 id="对象结构类型"><a href="#对象结构类型" class="headerlink" title="对象结构类型"></a>对象结构类型</h2><ul>
<li>Object</li>
<li>Function： 函数类型</li>
<li>接口	interface User { id: number }	结构化契约</li>
<li>构造函数类型	new (name: string) &#x3D;&gt; Animal	类构造函数</li>
<li>索引签名	{ [key: string]: number }	动态键值类型</li>
</ul>
<h2 id="内置对象类型"><a href="#内置对象类型" class="headerlink" title="内置对象类型"></a>内置对象类型</h2><ul>
<li>Array  Array<T> 数组</li>
<li>Date	new Date()	日期对象</li>
<li>RegExp	&#x2F;ab+c&#x2F;	正则表达式</li>
<li>Error	new Error()	错误对象</li>
<li>Map&lt;K,V&gt;	new Map&lt;string, number&gt;()	ES6 Map</li>
<li>Set<T>	new Set<number>()	ES6 Set</li>
<li>Promise<T>	Promise.resolve(42)	异步操作</li>
</ul>
<h2 id="特殊基础类型"><a href="#特殊基础类型" class="headerlink" title="特殊基础类型"></a>特殊基础类型</h2><ul>
<li>Never：永远也不出现的值，一般表示为错误</li>
<li>any：任何类型</li>
<li>void: 表示空，一般用于函数返回</li>
<li>unknown：表示未知类型，比any更安全，因为不能直接对其进行操作</li>
</ul>
<h2 id="复合类型"><a href="#复合类型" class="headerlink" title="复合类型"></a>复合类型</h2><ul>
<li>enum： 枚举</li>
<li>tuple：元组，固定长度和类型的数组<ul>
<li>[T, …T[]]: 至少有一个元素（T），长度不固定（…T[]）</li>
</ul>
</li>
<li>联合类型： type T &#x3D; string | number | boolean;</li>
<li>可辨识联合类型： type T &#x3D;  { kind: “circle”; radius: number } | { kind: “square”; size: number };例如redux的action</li>
<li>交叉类型： type T &#x3D; { a: string } &amp; { b: number };</li>
<li>字面量类型：type T &#x3D; “success” | “fail” | “loading”</li>
</ul>
<p>可辨识联合类型和联合类型区别</p>
<ul>
<li>可辨识联合类型<strong>必须有共同字面量类型标签属性</strong>； 联合类型<strong>没有</strong>可辨识联合类型</li>
<li>因此可辨识联合类型可以通过标签属性自动精确区分， 而联合类型不行  <figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Shape</span> = </span><br><span class="line">&#123; <span class="attr">kind</span>: <span class="string">&quot;circle&quot;</span>; <span class="attr">radius</span>: <span class="built_in">number</span> &#125; </span><br><span class="line">| &#123; <span class="attr">kind</span>: <span class="string">&quot;square&quot;</span>; <span class="attr">size</span>: <span class="built_in">number</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 普通联合类型无法直接区分具体类型</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getArea</span>(<span class="params"><span class="attr">shape</span>: <span class="title class_">Shape</span></span>) &#123;</span><br><span class="line"><span class="comment">// ❌ 错误：TS 不知道 shape 是 circle 还是 square</span></span><br><span class="line"> <span class="keyword">return</span> shape.<span class="property">radius</span> * shape.<span class="property">radius</span> * <span class="title class_">Math</span>.<span class="property">PI</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 使用标签属性进行类型收窄</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getArea</span>(<span class="params"><span class="attr">shape</span>: <span class="title class_">DiscriminatedShape</span></span>): <span class="built_in">number</span> &#123;</span><br><span class="line"><span class="keyword">switch</span> (shape.<span class="property">kind</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;circle&quot;</span>:</span><br><span class="line">    <span class="comment">// ✅ 自动识别为 circle 类型</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="property">PI</span> * shape.<span class="property">radius</span> ** <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;square&quot;</span>:</span><br><span class="line">    <span class="comment">// ✅ 自动识别为 square 类型</span></span><br><span class="line">    <span class="keyword">return</span> shape.<span class="property">size</span> ** <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>可辨识联合需要用switch&#x2F;case手动收窄，联合类型需要手动类型断言</li>
<li>可辨识联合安全性高于联合类型</li>
</ul>
<h2 id="高级类型"><a href="#高级类型" class="headerlink" title="高级类型"></a>高级类型</h2><h3 id="泛型"><a href="#泛型" class="headerlink" title="泛型"></a>泛型</h3><p>泛型（Generics）是 TypeScript 的核心类型编程特性，它允许创建可重用的类型&#x2F;函数组件，这些组件可以动态适应不同数据类型而不丢失类型安全</p>
<p>泛型本质：类型参数化</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 基础语法：在尖括号中声明类型变量</span></span><br><span class="line"><span class="keyword">function</span> identity&lt;T&gt;(<span class="attr">arg</span>: T): T &#123;</span><br><span class="line">  <span class="keyword">return</span> arg;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用：显式或隐式指定类型</span></span><br><span class="line"><span class="keyword">const</span> num = identity&lt;<span class="built_in">number</span>&gt;(<span class="number">42</span>);     <span class="comment">// 显式</span></span><br><span class="line"><span class="keyword">const</span> str = <span class="title function_">identity</span>(<span class="string">&quot;hello&quot;</span>);        <span class="comment">// 隐式推断为 string</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>命名规范：使用单字母大写（T, U, K）或描述性名称（TData）</li>
<li>避免 any：优先用泛型替代 any 保持类型安全</li>
<li>渐进复杂：从简单约束开始，逐步增加类型操作</li>
<li>组合使用：泛型 + 条件类型 + 映射类型 &#x3D; 强大类型系统</li>
</ul>
<h4 id="函数泛型"><a href="#函数泛型" class="headerlink" title="函数泛型"></a>函数泛型</h4><p>自动推断函数的参数和返回的类型</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fun</span>(<span class="params"><span class="attr">parans</span>: T[]</span>): T[] | <span class="literal">undefined</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> parans[];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> num = <span class="title function_">firstElement</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);  <span class="comment">// number | undefined</span></span><br><span class="line"><span class="keyword">const</span> str = <span class="title function_">firstElement</span>([<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>]); <span class="comment">// string | undefined</span></span><br></pre></td></tr></table></figure>

<h4 id="接口泛型"><a href="#接口泛型" class="headerlink" title="接口泛型"></a>接口泛型</h4><p>定义灵活数据结构</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">TResponse</span>&lt;T&gt; = &#123;</span><br><span class="line">  <span class="attr">data</span>: T</span><br><span class="line">  <span class="attr">code</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">msg</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">TRequest1</span> = <span class="title class_">TResponse</span>&lt;&#123;</span><br><span class="line">  <span class="attr">list</span>: <span class="built_in">number</span>[]</span><br><span class="line">&#125;&gt;  </span><br><span class="line"><span class="comment">// TRequest1 = &#123;</span></span><br><span class="line"><span class="comment">//     data: &#123;</span></span><br><span class="line"><span class="comment">//         list: number[];</span></span><br><span class="line"><span class="comment">//     &#125;;</span></span><br><span class="line"><span class="comment">//     code: number;</span></span><br><span class="line"><span class="comment">//     msg: string;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="类泛型"><a href="#类泛型" class="headerlink" title="类泛型"></a>类泛型</h4><p>创建可复用组件</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 泛型栈类（支持任意元素类型）</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Stack</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">items</span>: T[] = [];</span><br><span class="line">  </span><br><span class="line">  <span class="title function_">push</span>(<span class="params"><span class="attr">item</span>: T</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">items</span>.<span class="title function_">push</span>(item);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="title function_">pop</span>(): T | <span class="literal">undefined</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">items</span>.<span class="title function_">pop</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> numberStack = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;<span class="built_in">number</span>&gt;();</span><br><span class="line">numberStack.<span class="title function_">push</span>(<span class="number">1</span>);  <span class="comment">// ✅ 合法</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> stringStack = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;<span class="built_in">string</span>&gt;();</span><br><span class="line">stringStack.<span class="title function_">push</span>(<span class="string">&quot;text&quot;</span>); <span class="comment">// ✅ 合法</span></span><br><span class="line">stringStack.<span class="title function_">push</span>(<span class="number">123</span>);    <span class="comment">// ❌ 类型错误</span></span><br></pre></td></tr></table></figure>

<p>使用原型属性推断并约束构造函数与类实例的关系</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">BeeKeeper</span> &#123;</span><br><span class="line">    <span class="attr">hasMask</span>: <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ZooKeeper</span> &#123;</span><br><span class="line">    <span class="attr">nametag</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="attr">numLegs</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Bee</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Animal</span> &#123;</span><br><span class="line">    <span class="attr">keeper</span>: <span class="title class_">BeeKeeper</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Lion</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Animal</span> &#123;</span><br><span class="line">    <span class="attr">keeper</span>: <span class="title class_">ZooKeeper</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> createInstance&lt;A <span class="keyword">extends</span> <span class="title class_">Animal</span>&gt;(<span class="attr">c</span>: <span class="title function_">new</span> () =&gt; A): A &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title function_">c</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">createInstance</span>(<span class="title class_">Lion</span>).<span class="property">keeper</span>.<span class="property">nametag</span>;  <span class="comment">// typechecks!</span></span><br><span class="line"><span class="title function_">createInstance</span>(<span class="title class_">Bee</span>).<span class="property">keeper</span>.<span class="property">hasMask</span>;   <span class="comment">// typechecks!</span></span><br></pre></td></tr></table></figure>

<h4 id="类型约束"><a href="#类型约束" class="headerlink" title="类型约束"></a>类型约束</h4><p>限制泛型范围</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 要求 T 必须包含 length 属性</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Lengthwise</span> = &#123;</span><br><span class="line">  <span class="attr">length</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> logLength&lt;T <span class="keyword">extends</span> <span class="title class_">Lengthwise</span>&gt;(<span class="attr">obj</span>: T) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">length</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">logLength</span>(<span class="string">&quot;hello&quot;</span>); <span class="comment">// ✅ 合法 (length=5)</span></span><br><span class="line"><span class="title function_">logLength</span>(<span class="number">42</span>);      <span class="comment">// ❌ 错误：数字没有 length</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="默认类型参数"><a href="#默认类型参数" class="headerlink" title="默认类型参数"></a>默认类型参数</h4><p>提供备用类型</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 默认泛型类型为 number</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Pagination</span>&lt;T = <span class="built_in">number</span>&gt; &#123;</span><br><span class="line">  <span class="attr">currentPage</span>: T;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="attr">page</span>: T</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">currentPage</span> = page;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> page1 = <span class="keyword">new</span> <span class="title class_">Pagination</span>(<span class="number">1</span>);     <span class="comment">// T = number</span></span><br><span class="line"><span class="keyword">const</span> page2 = <span class="keyword">new</span> <span class="title class_">Pagination</span>&lt;<span class="built_in">string</span>&gt;(<span class="string">&quot;home&quot;</span>); <span class="comment">// T = string</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="类型推断"><a href="#类型推断" class="headerlink" title="类型推断"></a>类型推断</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 提取函数返回类型</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ReturnType</span>&lt;T&gt; = T <span class="title function_">extends</span> (...<span class="attr">args</span>: <span class="built_in">any</span>[]) =&gt; infer R ? R : <span class="built_in">never</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">FnReturn</span> = <span class="title class_">ReturnType</span>&lt;<span class="function">() =&gt;</span> <span class="built_in">number</span>&gt;; <span class="comment">// number</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="过滤筛选"><a href="#过滤筛选" class="headerlink" title="过滤筛选"></a>过滤筛选</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 过滤出函数类型</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">FunctionType</span>&lt;T&gt; = T <span class="title function_">extends</span> (...<span class="attr">args</span>: <span class="built_in">any</span>[]) =&gt; <span class="built_in">any</span> ? T : <span class="built_in">never</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Mixed</span> = <span class="built_in">string</span> | (<span class="function">() =&gt;</span> <span class="built_in">void</span>) | <span class="built_in">number</span>;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">FunctionsOnly</span> = <span class="title class_">FunctionType</span>&lt;<span class="title class_">Mixed</span>&gt;; <span class="comment">// () =&gt; void</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="keyof-操作符"><a href="#keyof-操作符" class="headerlink" title="keyof 操作符"></a>keyof 操作符</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> fun&lt;T, K <span class="keyword">extends</span> keyof T&gt;(<span class="attr">params</span>: T, <span class="attr">key</span>: K): T[K] &#123;</span><br><span class="line">  <span class="keyword">return</span> params[key]</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">fun</span>(&#123; <span class="attr">a</span>: <span class="number">1</span> &#125;, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"><span class="title function_">fun</span>(&#123; <span class="attr">a</span>: <span class="number">1</span> &#125;, <span class="string">&#x27;b&#x27;</span>)<span class="comment">//错误，b不在params的属性中</span></span><br></pre></td></tr></table></figure>

<h3 id="条件类型"><a href="#条件类型" class="headerlink" title="条件类型"></a>条件类型</h3><p>基于类型条件来定义类型的机制，使用extends关键字。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">IsString</span>&lt;T&gt; = T <span class="keyword">extends</span> <span class="built_in">string</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">type</span> A = <span class="title class_">IsString</span>&lt;<span class="string">&quot;abc&quot;</span>&gt;;</span><br></pre></td></tr></table></figure>

<p>可以依据传入的参数而返回不同的类型，比如判断传入的参数是否为字符串，如果是字符串则返回 true，否则返回 false</p>
<h4 id="infer"><a href="#infer" class="headerlink" title="infer"></a>infer</h4><p>infer是只能和extends一起搭配使用，因为infer 的设计初衷是在类型匹配的过程中提取信息，它依赖于 extends 所提供的类型匹配机制。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Example</span>&lt;T&gt; = T <span class="keyword">extends</span> infer U ? U : <span class="built_in">never</span>;</span><br></pre></td></tr></table></figure>

<p>使用规则：</p>
<ul>
<li>infer 必须出现在extends 条件类型的左侧</li>
<li>作用是在类型系统中推断某个子类型</li>
</ul>
<p>和<code>typeof</code>区别：</p>
<ul>
<li><p><code>typeof</code>: 获取一个值的类型，即某个值&#x2F;函数的类型是已经确定好了的，在运行时获取这个值的类型</p>
  <figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> name = <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line"><span class="keyword">type</span> T = <span class="keyword">typeof</span> name; <span class="comment">// string</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> user = &#123; <span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span>, <span class="attr">age</span>: <span class="number">30</span> &#125;;</span><br><span class="line"><span class="keyword">type</span> T = <span class="keyword">typeof</span> user; <span class="comment">// &#123; name: string; age: number &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params"><span class="attr">a</span>: <span class="built_in">number</span>, <span class="attr">b</span>: <span class="built_in">number</span></span>) &#123;</span><br><span class="line"><span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> T = <span class="keyword">typeof</span> add; <span class="comment">// (a: number, b: number) =&gt; number</span></span><br></pre></td></tr></table></figure>

<ul>
<li>适用场景：<ul>
<li>获取变量的类型</li>
<li>获取函数的类型签名</li>
<li>获取对象的结构类型</li>
<li>用于类型守卫中做运行时判断</li>
</ul>
</li>
</ul>
</li>
<li><p><code>infer</code>: 推断某个类型的子类型，只能和<code>extends</code>一起使用</p>
  <figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">GetReturnType</span>&lt;T&gt; = T <span class="title function_">extends</span> (...<span class="attr">args</span>: <span class="built_in">any</span>[]) =&gt; infer R ? R : <span class="built_in">never</span>;</span><br><span class="line"><span class="keyword">type</span> R = <span class="title class_">GetReturnType</span>&lt;<span class="function">() =&gt;</span> <span class="built_in">string</span>&gt;; <span class="comment">// string</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">GetElementType</span>&lt;T&gt; = T <span class="keyword">extends</span> <span class="title class_">Array</span>&lt;infer E&gt; ? E : <span class="built_in">never</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> E = <span class="title class_">GetElementType</span>&lt;<span class="built_in">number</span>[]&gt;; <span class="comment">// number</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">UnwrapPromise</span>&lt;T&gt; = T <span class="keyword">extends</span> <span class="title class_">Promise</span>&lt;infer P&gt; ? P : T;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> P = <span class="title class_">UnwrapPromise</span>&lt;<span class="title class_">Promise</span>&lt;<span class="built_in">string</span>&gt;&gt;; <span class="comment">// string</span></span><br></pre></td></tr></table></figure>
<ul>
<li>适用场景：<ul>
<li>提取函数返回值类型（如 ReturnType<T>）</li>
<li>提取数组元素类型（如 ExtractArrayElement<T>）</li>
<li>提取 Promise 内部类型（如 UnwrapPromise<T>）</li>
<li>类型编程中做类型转换和提取</li>
</ul>
</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th>特性</th>
<th>typeof</th>
<th>infer</th>
</tr>
</thead>
<tbody><tr>
<td>作用</td>
<td>获取值的类型</td>
<td>在类型中提取子类型</td>
</tr>
<tr>
<td>使用位置</td>
<td>可用于任意类型声明</td>
<td>只能在 extends 条件类型中使用</td>
</tr>
<tr>
<td>作用对象</td>
<td>运行时值（变量、对象、函数等）</td>
<td>类型（函数类型、数组类型、Promise 等）</td>
</tr>
<tr>
<td>是否用于类型推断</td>
<td>是，基于值推断类型</td>
<td>是，基于类型推断子类型</td>
</tr>
<tr>
<td>是否影响运行时</td>
<td>否</td>
<td>否</td>
</tr>
<tr>
<td>典型用途</td>
<td>类型复用、类型守卫</td>
<td>类型提取、类型转换、泛型编程</td>
</tr>
</tbody></table>
<h4 id="分布式条件类型"><a href="#分布式条件类型" class="headerlink" title="分布式条件类型"></a>分布式条件类型</h4><p>分布式条件类型是 TypeScript 中的一种特殊行为，当条件类型作用于泛型类型参数时，如果该类型是 联合类型（A | B），则条件会 分布 到每一个联合成员上，分别计算，再将结果合并成一个新的联合类型。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">ToFlag</span>&lt;T&gt; = T <span class="keyword">extends</span> <span class="built_in">number</span> ? <span class="string">&quot;num&quot;</span> : <span class="string">&quot;other&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> R = <span class="title class_">ToFlag</span>&lt;<span class="built_in">number</span> | <span class="built_in">string</span> | <span class="built_in">boolean</span>&gt;;</span><br><span class="line"><span class="comment">// 分布后：</span></span><br><span class="line"><span class="comment">// ToFlag&lt;number&gt; | ToFlag&lt;string&gt; | ToFlag&lt;boolean&gt;</span></span><br><span class="line"><span class="comment">// =&gt; &#x27;num&#x27; | &#x27;other&#x27; | &#x27;other&#x27;</span></span><br><span class="line"><span class="comment">// =&gt; &#x27;num&#x27; | &#x27;other&#x27;</span></span><br><span class="line"><span class="comment">// =&gt; R=&#x27;num&#x27; | &#x27;other&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="裸类型参数"><a href="#裸类型参数" class="headerlink" title="裸类型参数"></a>裸类型参数</h4><p>裸类型参数，就是指这个类型参数 T 被直接写在 extends 的左侧，没有被任何结构包裹住</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">T <span class="keyword">extends</span> <span class="built_in">string</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br></pre></td></tr></table></figure>

<p>这里的<code>T</code>就是裸类型参数，它没有被放进数组、对象或别的东西里</p>
<p>条件类型中，如果 T 是裸类型参数，并且 T 是联合类型，TypeScript 会将其拆分每个成员进行判断；一旦我们用结构包裹了 T，它就失去了这种分布能力。</p>
<ul>
<li>分布式特性</li>
</ul>
<p>当我们传入的泛型类型是联合类型，比如 number | string | boolean，而条件类型的写法又是 T extends U ? X : Y 这种形式时，TypeScript 会自动对联合类型的每个成员<strong>分别</strong>进行判断。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">ToFlag</span>&lt;T&gt; = T <span class="keyword">extends</span> <span class="built_in">number</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Num</span> = <span class="title class_">ToFlag</span>&lt;<span class="built_in">number</span>&gt;;<span class="comment">// true</span></span><br><span class="line"><span class="keyword">type</span> R = <span class="title class_">ToFlag</span>&lt;<span class="built_in">number</span> | <span class="built_in">string</span> | <span class="built_in">boolean</span>&gt;; <span class="comment">// boolean(true | false)</span></span><br></pre></td></tr></table></figure>

<p>但只有当T是裸类型参数时，才会进行分布式判断。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">ToFlag</span>&lt;T&gt; = [T] <span class="keyword">extends</span> [<span class="built_in">number</span>] ? <span class="literal">true</span> : <span class="literal">false</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Num</span> = <span class="title class_">ToFlag</span>&lt;<span class="built_in">number</span>&gt; <span class="comment">// true</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Arr</span> = <span class="title class_">ToFlag</span>&lt;[<span class="built_in">number</span>]&gt;; <span class="comment">// false</span></span><br><span class="line"><span class="keyword">type</span> R = <span class="title class_">ToFlag</span>&lt;<span class="built_in">number</span> | <span class="built_in">string</span> | <span class="built_in">boolean</span>&gt;; <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<p>因为这里的T已经被包裹起来的，所以是对整体进行一个判断，如果满足条件，则返回true，否则返回false。</p>
<p>条件类型中，如果 T 是裸类型参数，并且 T 是联合类型，TypeScript 会将其拆分每个成员进行判断；一旦我们用结构包裹了 T，它就失去了这种分布能力。</p>
<h4 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h4><h5 id="类型推断-1"><a href="#类型推断-1" class="headerlink" title="类型推断"></a>类型推断</h5><p>对无子类型进行推断：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">IsString</span>&lt;T&gt; = T <span class="keyword">extends</span> <span class="built_in">string</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">GetStyle</span>&lt;T&gt; = <span class="title class_">IsString</span>&lt;T&gt; <span class="keyword">extends</span> <span class="literal">true</span> ? T : <span class="built_in">never</span>;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Test1</span> = <span class="title class_">GetStyle</span>&lt;<span class="string">&#x27;abc&#x27;</span>&gt;;   <span class="comment">// &#x27;abc&#x27;</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Test2</span> = <span class="title class_">GetStyle</span>&lt;<span class="built_in">number</span>&gt;;  <span class="comment">// never</span></span><br></pre></td></tr></table></figure>

<p>对带子类型进行推断：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">GetChildType</span>&lt;T&gt; = T <span class="keyword">extends</span> <span class="title class_">Array</span>&lt;infer E&gt; ? E : <span class="built_in">never</span>;</span><br><span class="line"><span class="keyword">const</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]; <span class="comment">// 类型为number[]</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">NumType</span> = <span class="title class_">GetChildType</span>&lt;<span class="keyword">typeof</span> numbers&gt;; <span class="comment">// NumType 推断为 number</span></span><br></pre></td></tr></table></figure>

<h5 id="类型过滤"><a href="#类型过滤" class="headerlink" title="类型过滤"></a>类型过滤</h5><p>从一个联合类型中，筛选出需要的类型</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">FunctionFilter</span>&lt;T&gt; = T <span class="title function_">extends</span> (...args) =&gt; <span class="built_in">void</span> ? T : <span class="built_in">never</span>;S</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Mixed</span> = <span class="built_in">string</span> | (<span class="function">() =&gt;</span> <span class="built_in">void</span>) | <span class="built_in">number</span>;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">OnlyFunctions</span> = <span class="title class_">FunctionFilter</span>&lt;<span class="title class_">Mixed</span>&gt;; <span class="comment">// OnlyFunctions 为 () =&gt; void</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义条件类型：提取键名，如果属性值是字符串类型</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ExtractStringKeys</span>&lt;T&gt; = &#123;</span><br><span class="line">  [K <span class="keyword">in</span> keyof T]: T[K] <span class="keyword">extends</span> <span class="built_in">string</span> ? K : <span class="built_in">never</span></span><br><span class="line">&#125;[keyof T]; <span class="comment">// 映射类型过滤，并提取非 never 的键</span></span><br></pre></td></tr></table></figure>

<h5 id="条件映射"><a href="#条件映射" class="headerlink" title="条件映射"></a>条件映射</h5><p>在映射类型中使用条件，例如创建只读或可写版本、选择或排除满足条件的属性。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将联合类型合并为一个类型，例如 &#123;a: string&#125; &amp; &#123;b: number&#125; =&gt; &#123;a: string, b: number&#125;</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Combine</span>&lt;T&gt; = &#123; [K <span class="keyword">in</span> keyof T]: T[K] &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将类型中，string类型的数据转为只读类型，其他类型不变</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ReadonlyIfString</span>&lt;T&gt; = <span class="title class_">Combine</span>&lt;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// 筛选出string类型的属性，将其加上readonly变为只读</span></span><br><span class="line">    <span class="keyword">readonly</span> [K <span class="keyword">in</span> keyof T <span class="keyword">as</span> T[K] <span class="keyword">extends</span> <span class="built_in">string</span> ? K : <span class="built_in">never</span>]: T[K]</span><br><span class="line">  &#125; &amp; &#123;</span><br><span class="line">    <span class="comment">// T[K] extends string ? never : K  排除掉string类型</span></span><br><span class="line">    <span class="comment">// K in keyof T  循环非string类型的属性</span></span><br><span class="line">    <span class="comment">// T[K] extends object如果是对象，那么递归处理，当然如果不需要递归，可以直接省略掉这里的extends，直接返回T[K]</span></span><br><span class="line">    [K <span class="keyword">in</span> keyof T <span class="keyword">as</span> T[K] <span class="keyword">extends</span> <span class="built_in">string</span> ? <span class="built_in">never</span> : K]: T[K] <span class="keyword">extends</span> <span class="built_in">object</span></span><br><span class="line">      ? <span class="title class_">ReadonlyIfString</span>&lt;T[K]&gt;</span><br><span class="line">      : T[K]</span><br><span class="line">  &#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>

<h5 id="泛型约束"><a href="#泛型约束" class="headerlink" title="泛型约束"></a>泛型约束</h5><p>依据不同的输入返回不同的结果</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义条件类型：基于输入类型返回不同输出</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ConvertedType</span>&lt;T&gt; = T <span class="keyword">extends</span> <span class="built_in">string</span> ? <span class="built_in">number</span> : T <span class="keyword">extends</span> <span class="built_in">number</span> ? <span class="built_in">string</span> : <span class="built_in">never</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 泛型函数实现（使用类型断言简化）</span></span><br><span class="line"><span class="keyword">function</span> convert&lt;T&gt;(<span class="attr">input</span>: T): <span class="title class_">ConvertedType</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> input === <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">parseInt</span>(input) <span class="keyword">as</span> <span class="title class_">ConvertedType</span>&lt;T&gt;; <span class="comment">// 实际实现需处理转换</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> input === <span class="string">&#x27;number&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> input.<span class="title function_">toString</span>() <span class="keyword">as</span> <span class="title class_">ConvertedType</span>&lt;T&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Unsupported type&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用示例</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">strResult</span>: <span class="built_in">number</span> = <span class="title function_">convert</span>(<span class="string">&quot;123&quot;</span>); <span class="comment">// 输入 string, 输出 number</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">numResult</span>: <span class="built_in">string</span> = <span class="title function_">convert</span>(<span class="number">123</span>); <span class="comment">// 输入 number, 输出 string</span></span><br></pre></td></tr></table></figure>

<ul>
<li>函数重载简化</li>
</ul>
<p>用条件类型替代多个函数重载，使类型定义更简洁。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 传统函数重载（多个声明）</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">process</span>(<span class="params"><span class="attr">input</span>: <span class="built_in">string</span></span>): <span class="built_in">number</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">process</span>(<span class="params"><span class="attr">input</span>: <span class="built_in">number</span></span>): <span class="built_in">string</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">process</span>(<span class="params"><span class="attr">input</span>: <span class="built_in">any</span></span>): <span class="built_in">any</span> &#123;</span><br><span class="line">  <span class="comment">// 实现略</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 用条件类型简化：定义单一泛型函数</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ProcessedType</span>&lt;T&gt; = T <span class="keyword">extends</span> <span class="built_in">string</span> ? <span class="built_in">number</span> : T <span class="keyword">extends</span> <span class="built_in">number</span> ? <span class="built_in">string</span> : <span class="built_in">never</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> process&lt;T&gt;(<span class="attr">input</span>: T): <span class="title class_">ProcessedType</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> input === <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> input.<span class="property">length</span> <span class="keyword">as</span> <span class="title class_">ProcessedType</span>&lt;T&gt;; <span class="comment">// 示例：返回字符串长度</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> input === <span class="string">&#x27;number&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> input.<span class="title function_">toString</span>() <span class="keyword">as</span> <span class="title class_">ProcessedType</span>&lt;T&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Invalid input&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用示例</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">result1</span>: <span class="built_in">number</span> = <span class="title function_">process</span>(<span class="string">&quot;hello&quot;</span>); <span class="comment">// 输入 string, 输出 number</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">result2</span>: <span class="built_in">string</span> = <span class="title function_">process</span>(<span class="number">42</span>); <span class="comment">// 输入 number, 输出 string</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="映射类型"><a href="#映射类型" class="headerlink" title="映射类型"></a>映射类型</h3><p>允许你基于现有类型动态创建新类型，通过遍历键集合并应用转换规则实现</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 基础语法：遍历键集合（K in KeyType）并转换值类型</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">MappedType</span>&lt;T&gt; = &#123;</span><br><span class="line">  [P <span class="keyword">in</span> keyof T]: <span class="title class_">NewType</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="通过映射实现ts部分使用工具类型"><a href="#通过映射实现ts部分使用工具类型" class="headerlink" title="通过映射实现ts部分使用工具类型"></a>通过映射实现ts部分使用工具类型</h4><table>
<thead>
<tr>
<th>工具类型</th>
<th>作用</th>
<th>映射类型实现</th>
</tr>
</thead>
<tbody><tr>
<td>Partial<T></td>
<td>将所有属性变为可选</td>
<td><code>[P in keyof T]?: T[P]</code></td>
</tr>
<tr>
<td>Required<T></td>
<td>将所有属性变为必选</td>
<td><code>[P in keyof T]-?: T[P]</code></td>
</tr>
<tr>
<td>Readonly<T></td>
<td>将所有属性变为只读</td>
<td><code>[P in keyof T]: T[P]</code></td>
</tr>
<tr>
<td>Pick&lt;T,K&gt;</td>
<td>从T中选择一组键位于并集K中的属性</td>
<td><code>[P in K]: T[P]</code></td>
</tr>
<tr>
<td>Record&lt;K,T&gt;</td>
<td>构造一个具有类型T的一组属性K的类型</td>
<td><code>[P in K]: T</code></td>
</tr>
</tbody></table>
<p><code>-?</code>：移除可选标记</p>
<h4 id="类型值转换"><a href="#类型值转换" class="headerlink" title="类型值转换"></a>类型值转换</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 所有属性转为 boolean</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Flags</span>&lt;T&gt; = &#123;</span><br><span class="line">  [P <span class="keyword">in</span> keyof T]: <span class="built_in">boolean</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 所有属性转为 Promise</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">AsyncData</span>&lt;T&gt; = &#123;</span><br><span class="line">  [P <span class="keyword">in</span> keyof T]: <span class="title class_">Promise</span>&lt;T[P]&gt;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">UserFlags</span> = <span class="title class_">Flags</span>&lt;<span class="title class_">User</span>&gt;; </span><br><span class="line"><span class="comment">// &#123; name: boolean; age: boolean &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">AsyncUser</span> = <span class="title class_">AsyncData</span>&lt;<span class="title class_">User</span>&gt;;</span><br><span class="line"><span class="comment">// &#123; name: Promise&lt;string&gt;; age: Promise&lt;number&gt; &#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="键名重映射"><a href="#键名重映射" class="headerlink" title="键名重映射"></a>键名重映射</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 添加前缀（模板字面量类型）</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">AddPrefix</span>&lt;T&gt; = &#123;</span><br><span class="line">  [P <span class="keyword">in</span> keyof T <span class="keyword">as</span> <span class="string">`get<span class="subst">$&#123;Capitalize&lt;<span class="built_in">string</span> &amp; P&gt;&#125;</span>`</span>]: <span class="function">() =&gt;</span> T[P];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">UserAccessors</span> = <span class="title class_">AddPrefix</span>&lt;<span class="title class_">User</span>&gt;;</span><br><span class="line"><span class="comment">// &#123; </span></span><br><span class="line"><span class="comment">//   getName: () =&gt; string; </span></span><br><span class="line"><span class="comment">//   getAge: () =&gt; number </span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="深度递归映射"><a href="#深度递归映射" class="headerlink" title="深度递归映射"></a>深度递归映射</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 递归所有层级添加 readonly</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">DeepReadonly</span>&lt;T&gt; = &#123;</span><br><span class="line">  <span class="keyword">readonly</span> [P <span class="keyword">in</span> keyof T]: T[P] <span class="keyword">extends</span> <span class="built_in">object</span> </span><br><span class="line">    ? <span class="title class_">DeepReadonly</span>&lt;T[P]&gt; </span><br><span class="line">    : T[P];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">NestedData</span> = &#123;</span><br><span class="line">  <span class="attr">user</span>: &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">permissions</span>: <span class="built_in">string</span>[];</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">LockedData</span> = <span class="title class_">DeepReadonly</span>&lt;<span class="title class_">NestedData</span>&gt;;</span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//   readonly user: &#123;</span></span><br><span class="line"><span class="comment">//     readonly name: string;</span></span><br><span class="line"><span class="comment">//     readonly permissions: readonly string[];</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="枚举键的映射"><a href="#枚举键的映射" class="headerlink" title="枚举键的映射"></a>枚举键的映射</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">LogLevel</span> &#123;</span><br><span class="line">  <span class="variable constant_">DEBUG</span>,</span><br><span class="line">  <span class="variable constant_">INFO</span>,</span><br><span class="line">  <span class="variable constant_">ERROR</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建基于枚举键的类型</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">LogConfig</span> = &#123;</span><br><span class="line">  [<span class="title class_">Level</span> <span class="keyword">in</span> keyof <span class="keyword">typeof</span> <span class="title class_">LogLevel</span>]: &#123;</span><br><span class="line">    <span class="attr">output</span>: <span class="string">&quot;console&quot;</span> | <span class="string">&quot;file&quot;</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 结果：</span></span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//   DE<span class="doctag">BUG:</span> &#123; output: &quot;console&quot; | &quot;file&quot; &#125;;</span></span><br><span class="line"><span class="comment">//   INFO: &#123; output: &quot;console&quot; | &quot;file&quot; &#125;;</span></span><br><span class="line"><span class="comment">//   ERROR: &#123; output: &quot;console&quot; | &quot;file&quot; &#125;;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="模板字面量"><a href="#模板字面量" class="headerlink" title="模板字面量"></a>模板字面量</h3><p>基于字符串字面量创建新类型，支持模式匹配和动态字符串类型生成</p>
<ul>
<li>动态生成字符串字面量类型。</li>
<li>结合联合类型，可以创建所有可能的字符串组合。</li>
<li>常用于事件名称、路径模式、CSS类名等场景。</li>
<li>类型层面的模式匹配</li>
</ul>
<p>但是这些都只能是在编译时的校验，无法使用动态的数据校验</p>
<h4 id="遍历组合生成新类型"><a href="#遍历组合生成新类型" class="headerlink" title="遍历组合生成新类型"></a>遍历组合生成新类型</h4><ul>
<li>事件名称</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">EventType</span> = <span class="string">&#x27;click&#x27;</span> | <span class="string">&#x27;scroll&#x27;</span>;</span><br><span class="line"><span class="comment">// Capitalize 函数将字符串的第一个字符大写</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">EventName</span> = <span class="string">`on<span class="subst">$&#123;Capitalize&lt;EventType&gt;&#125;</span>`</span>;  <span class="comment">// &quot;onClick&quot; | &quot;onScroll&quot;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleEvent</span> = (<span class="params"><span class="attr">event</span>: <span class="title class_">EventName</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Handling event: <span class="subst">$&#123;event&#125;</span>`</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title function_">handleEvent</span>(<span class="string">&quot;onClick&quot;</span>);  <span class="comment">// ✅</span></span><br><span class="line"><span class="title function_">handleEvent</span>(<span class="string">&quot;onScroll&quot;</span>); <span class="comment">// ✅</span></span><br><span class="line"><span class="title function_">handleEvent</span>(<span class="string">&quot;onhover&quot;</span>);  <span class="comment">// ❌ 错误，因为&#x27;onhover&#x27;不在允许的类型中</span></span><br></pre></td></tr></table></figure>

<ul>
<li>props：例如弹窗位置的ts定义</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">VerticalAlignment</span> = <span class="string">&quot;top&quot;</span> | <span class="string">&quot;middle&quot;</span> | <span class="string">&quot;bottom&quot;</span>;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">HorizontalAlignment</span> = <span class="string">&quot;left&quot;</span> | <span class="string">&quot;center&quot;</span> | <span class="string">&quot;right&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Alignment</span> = <span class="string">`<span class="subst">$&#123;VerticalAlignment&#125;</span>-<span class="subst">$&#123;HorizontalAlignment&#125;</span>`</span>;</span><br><span class="line"><span class="comment">// 结果为： &quot;top-left&quot; | &quot;top-center&quot; | &quot;top-right&quot; </span></span><br><span class="line"><span class="comment">//        | &quot;middle-left&quot; | &quot;middle-center&quot; | &quot;middle-right&quot;</span></span><br><span class="line"><span class="comment">//        | &quot;bottom-left&quot; | &quot;bottom-center&quot; | &quot;bottom-right&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>对象取键</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">NestedKeyPaths</span>&lt;T, <span class="title class_">Prefix</span> <span class="keyword">extends</span> <span class="built_in">string</span> = <span class="string">&#x27;&#x27;</span>&gt; = </span><br><span class="line">  T <span class="keyword">extends</span> <span class="built_in">object</span> </span><br><span class="line">    ? &#123;</span><br><span class="line">        [K <span class="keyword">in</span> keyof T]: K <span class="keyword">extends</span> <span class="built_in">string</span> </span><br><span class="line">          ? (<span class="title class_">Prefix</span> <span class="keyword">extends</span> <span class="string">&#x27;&#x27;</span> ? K : <span class="string">`<span class="subst">$&#123;Prefix&#125;</span>.<span class="subst">$&#123;K&#125;</span>`</span>) | <span class="title class_">NestedKeyPaths</span>&lt;T[K], <span class="title class_">Prefix</span> <span class="keyword">extends</span> <span class="string">&#x27;&#x27;</span> ? K : <span class="string">`<span class="subst">$&#123;Prefix&#125;</span>.<span class="subst">$&#123;K&#125;</span>`</span>&gt;</span><br><span class="line">          : <span class="built_in">never</span>;</span><br><span class="line">      &#125;[keyof T]</span><br><span class="line">    : <span class="built_in">never</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Messages</span> &#123;</span><br><span class="line">  <span class="attr">user</span>: &#123;</span><br><span class="line">    <span class="attr">login</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">logout</span>: <span class="built_in">string</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="attr">error</span>: &#123;</span><br><span class="line">    <span class="attr">notFound</span>: <span class="built_in">string</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">MessageKeys</span> = <span class="title class_">NestedKeyPaths</span>&lt;<span class="title class_">Messages</span>&gt;; </span><br><span class="line"><span class="comment">// &quot;user&quot; | &quot;user.login&quot; | &quot;user.logout&quot; | &quot;error&quot; | &quot;error.notFound&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="结合infer进行模式匹配"><a href="#结合infer进行模式匹配" class="headerlink" title="结合infer进行模式匹配"></a>结合infer进行模式匹配</h4><p>结合infer和条件类型，可以从字符串中提取部分内容。</p>
<ul>
<li><p>提取路由</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">ExtractRouteParams</span>&lt;T <span class="keyword">extends</span> <span class="built_in">string</span>&gt; = T extenhs <span class="string">`<span class="subst">$&#123;<span class="built_in">string</span>&#125;</span>/:<span class="subst">$&#123;infer Param&#125;</span>/<span class="subst">$&#123;infer Param2&#125;</span>`</span> ? <span class="title class_">Param</span> | <span class="title class_">ExtractRouteParams</span>&lt;<span class="title class_">Param2</span>&gt; : T <span class="keyword">extends</span> <span class="string">`<span class="subst">$&#123;<span class="built_in">string</span>&#125;</span>/:<span class="subst">$&#123;infer Param&#125;</span>`</span> ? <span class="title class_">Param</span> : <span class="built_in">never</span>; </span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Params</span> = <span class="title class_">ExtractRouteParams</span>&lt;<span class="string">&#x27;/user/:userId/post/:postId&#x27;</span>&gt;;</span><br><span class="line"><span class="comment">// 结果为: &quot;userId&quot; | &quot;postId&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> createRoute&lt;<span class="title class_">Path</span> <span class="keyword">extends</span> <span class="built_in">string</span>&gt;(<span class="attr">path</span>: <span class="title class_">Path</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">match</span>: <span class="function">(<span class="params"><span class="attr">url</span>: <span class="built_in">string</span></span>) =&gt;</span> url === path ? &#123;&#125; : <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">params</span>: &#123;&#125; <span class="keyword">as</span> <span class="title class_">ExtractRouteParams</span>&lt;<span class="title class_">Path</span>&gt;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> userRoute = <span class="title function_">createRoute</span>(<span class="string">&quot;/user/:id/post/:postId&quot;</span>);</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Params</span> = <span class="keyword">typeof</span> userRoute.<span class="property">params</span>;</span><br><span class="line"><span class="comment">// 自动推断为: &#123; id: string; postId: string &#125;</span></span><br><span class="line"></span><br><span class="line">userRoute.<span class="title function_">match</span>(<span class="string">&quot;/user/123/post/456&quot;</span>)?.<span class="property">params</span>.<span class="property">id</span>; <span class="comment">// ✅ &quot;123&quot;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>提取url参数</p>
</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 定义 URL 模式</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">URLPattern</span> = <span class="string">`<span class="subst">$&#123;<span class="string">&quot;http&quot;</span> | <span class="string">&quot;https&quot;</span>&#125;</span>://<span class="subst">$&#123;<span class="built_in">string</span>&#125;</span>.<span class="subst">$&#123;<span class="string">&quot;com&quot;</span> | <span class="string">&quot;org&quot;</span> | <span class="string">&quot;net&quot;</span>&#125;</span>/<span class="subst">$&#123;<span class="built_in">string</span>&#125;</span>`</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 提取域名部分</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ExtractDomain</span>&lt;T&gt; = </span><br><span class="line">  T <span class="keyword">extends</span> <span class="string">`<span class="subst">$&#123;<span class="built_in">string</span>&#125;</span>://<span class="subst">$&#123;infer Domain&#125;</span>.<span class="subst">$&#123;<span class="built_in">string</span>&#125;</span>/<span class="subst">$&#123;<span class="built_in">string</span>&#125;</span>`</span> </span><br><span class="line">    ? <span class="title class_">Domain</span> </span><br><span class="line">    : <span class="built_in">never</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 使用</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">BlogDomain</span> = <span class="title class_">ExtractDomain</span>&lt;<span class="string">&quot;https://blog.example.com/posts&quot;</span>&gt;;</span><br><span class="line"><span class="comment">// 推断为 &quot;blog.example&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. 应用：安全路由处理</span></span><br><span class="line"><span class="keyword">function</span> handleRoute&lt;<span class="title class_">Path</span> <span class="keyword">extends</span> <span class="title class_">URLPattern</span>&gt;(<span class="attr">path</span>: <span class="title class_">Path</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> domain = path.<span class="title function_">split</span>(<span class="string">&quot;://&quot;</span>)[<span class="number">1</span>].<span class="title function_">split</span>(<span class="string">&quot;.&quot;</span>)[<span class="number">0</span>];</span><br><span class="line">  <span class="comment">// 自动推断 domain 类型为 string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="递归模板"><a href="#递归模板" class="headerlink" title="递归模板"></a>递归模板</h4><p>自动生成文档结构</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">GenerateMarkdown</span>&lt;<span class="title class_">Depth</span> <span class="keyword">extends</span> <span class="built_in">number</span>&gt; = </span><br><span class="line">  <span class="title class_">Depth</span> <span class="keyword">extends</span> <span class="number">1</span> ? <span class="string">`# <span class="subst">$&#123;<span class="built_in">string</span>&#125;</span>`</span> :</span><br><span class="line">  <span class="title class_">Depth</span> <span class="keyword">extends</span> <span class="number">2</span> ? <span class="string">`## <span class="subst">$&#123;<span class="built_in">string</span>&#125;</span>`</span> :</span><br><span class="line">  <span class="title class_">Depth</span> <span class="keyword">extends</span> <span class="number">3</span> ? <span class="string">`### <span class="subst">$&#123;<span class="built_in">string</span>&#125;</span>`</span> :</span><br><span class="line">  <span class="built_in">never</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> createHeading&lt;D <span class="keyword">extends</span> <span class="built_in">number</span>&gt;(<span class="attr">depth</span>: D, <span class="attr">text</span>: <span class="built_in">string</span>)</span><br><span class="line">  : <span class="title class_">GenerateMarkdown</span>&lt;D&gt; </span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;<span class="string">&quot;#&quot;</span>.repeat(depth)&#125;</span> <span class="subst">$&#123;text&#125;</span>`</span> <span class="keyword">as</span> <span class="built_in">any</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> h1 = <span class="title function_">createHeading</span>(<span class="number">1</span>, <span class="string">&quot;Title&quot;</span>); <span class="comment">// &quot;# Title&quot;</span></span><br><span class="line"><span class="keyword">const</span> h3 = <span class="title function_">createHeading</span>(<span class="number">3</span>, <span class="string">&quot;Subtitle&quot;</span>); <span class="comment">// &quot;### Subtitle&quot;</span></span><br><span class="line"><span class="keyword">const</span> invalid = <span class="title function_">createHeading</span>(<span class="number">4</span>, <span class="string">&quot;Error&quot;</span>); <span class="comment">// ❌ 类型错误</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="SQL校验"><a href="#SQL校验" class="headerlink" title="SQL校验"></a>SQL校验</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 定义安全查询模式</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">SafeSelectQuery</span>&lt;<span class="title class_">Table</span> <span class="keyword">extends</span> <span class="built_in">string</span>&gt; = </span><br><span class="line">  <span class="string">`SELECT <span class="subst">$&#123;<span class="built_in">string</span>&#125;</span> FROM <span class="subst">$&#123;Table&#125;</span> WHERE <span class="subst">$&#123;<span class="built_in">string</span>&#125;</span> = <span class="subst">$&#123;<span class="built_in">string</span>&#125;</span>`</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 执行类型安全查询</span></span><br><span class="line"><span class="keyword">function</span> query&lt;T <span class="keyword">extends</span> <span class="built_in">string</span>&gt;(<span class="attr">sql</span>: <span class="title class_">SafeSelectQuery</span>&lt;T&gt;) &#123;</span><br><span class="line">  <span class="comment">// 执行数据库操作</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用</span></span><br><span class="line"><span class="title function_">query</span>(<span class="string">`SELECT * FROM users WHERE email = &#x27;user@example.com&#x27;`</span>); <span class="comment">// ✅</span></span><br><span class="line"><span class="title function_">query</span>(<span class="string">`DELETE FROM users`</span>); <span class="comment">// ❌ 不符合模式</span></span><br><span class="line"><span class="title function_">query</span>(<span class="string">`SELECT * FROM products WHERE id = 123`</span>); <span class="comment">// ❌ 值未加引号</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 扩展：带 JOIN 的复杂查询</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">JoinQuery</span> = </span><br><span class="line">  <span class="string">`SELECT <span class="subst">$&#123;<span class="built_in">string</span>&#125;</span> FROM <span class="subst">$&#123;<span class="built_in">string</span>&#125;</span> JOIN <span class="subst">$&#123;<span class="built_in">string</span>&#125;</span> ON <span class="subst">$&#123;<span class="built_in">string</span>&#125;</span> = <span class="subst">$&#123;<span class="built_in">string</span>&#125;</span>`</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="5-API-路径参数自动提取（RESTful-服务）"><a href="#5-API-路径参数自动提取（RESTful-服务）" class="headerlink" title="5. API 路径参数自动提取（RESTful 服务）"></a>5. <strong>API 路径参数自动提取（RESTful 服务）</strong></h4><p><strong>场景</strong>：自动推断路由参数类型  </p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 定义路由模式</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">RoutePattern</span>&lt;<span class="title class_">Path</span> <span class="keyword">extends</span> <span class="built_in">string</span>&gt; = </span><br><span class="line">  <span class="title class_">Path</span> <span class="keyword">extends</span> <span class="string">`<span class="subst">$&#123;infer Start&#125;</span>/:<span class="subst">$&#123;infer Param&#125;</span>/<span class="subst">$&#123;infer Rest&#125;</span>`</span></span><br><span class="line">    ? &#123; [K <span class="keyword">in</span> <span class="title class_">Param</span>]: <span class="built_in">string</span> &#125; &amp; <span class="title class_">RoutePattern</span>&lt;<span class="string">`/<span class="subst">$&#123;Rest&#125;</span>`</span>&gt;</span><br><span class="line">    : <span class="title class_">Path</span> <span class="keyword">extends</span> <span class="string">`<span class="subst">$&#123;<span class="built_in">string</span>&#125;</span>/:<span class="subst">$&#123;infer Param&#125;</span>`</span></span><br><span class="line">      ? &#123; [K <span class="keyword">in</span> <span class="title class_">Param</span>]: <span class="built_in">string</span> &#125;</span><br><span class="line">      : &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 实现类型安全路由</span></span><br><span class="line"><span class="keyword">function</span> createRoute&lt;<span class="title class_">Path</span> <span class="keyword">extends</span> <span class="built_in">string</span>&gt;(<span class="attr">path</span>: <span class="title class_">Path</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">match</span>: <span class="function">(<span class="params"><span class="attr">url</span>: <span class="built_in">string</span></span>) =&gt;</span> url === path ? &#123;&#125; : <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">params</span>: &#123;&#125; <span class="keyword">as</span> <span class="title class_">RoutePattern</span>&lt;<span class="title class_">Path</span>&gt;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 使用</span></span><br><span class="line"><span class="keyword">const</span> userRoute = <span class="title function_">createRoute</span>(<span class="string">&quot;/user/:id/post/:postId&quot;</span>);</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Params</span> = <span class="keyword">typeof</span> userRoute.<span class="property">params</span>;</span><br><span class="line"><span class="comment">// 自动推断为: &#123; id: string; postId: string &#125;</span></span><br><span class="line"></span><br><span class="line">userRoute.<span class="title function_">match</span>(<span class="string">&quot;/user/123/post/456&quot;</span>)?.<span class="property">params</span>.<span class="property">id</span>; <span class="comment">// ✅ &quot;123&quot;</span></span><br></pre></td></tr></table></figure>

<hr>
<h4 id="6-编译时正则表达式验证（高级模式匹配）"><a href="#6-编译时正则表达式验证（高级模式匹配）" class="headerlink" title="6. 编译时正则表达式验证（高级模式匹配）"></a>6. <strong>编译时正则表达式验证（高级模式匹配）</strong></h4><p><strong>场景</strong>：确保字符串符合复杂正则规则  </p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 创建类型安全邮箱格式</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ValidEmail</span> = </span><br><span class="line">  <span class="string">`<span class="subst">$&#123;<span class="built_in">string</span>&#125;</span>@<span class="subst">$&#123;<span class="built_in">string</span>&#125;</span>.<span class="subst">$&#123;<span class="built_in">string</span>&#125;</span>`</span> &amp; &#123; </span><br><span class="line">    <span class="attr">_pattern</span>: <span class="regexp">/^[^\s@]+@[^\s@]+\.[^\s@]+$/</span> </span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 使用条件类型验证</span></span><br><span class="line"><span class="keyword">function</span> assertEmail&lt;T <span class="keyword">extends</span> <span class="built_in">string</span>&gt;(</span><br><span class="line">  <span class="attr">value</span>: T <span class="keyword">extends</span> <span class="title class_">ValidEmail</span> ? T : <span class="built_in">never</span></span><br><span class="line">): <span class="title class_">ValidEmail</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> value <span class="keyword">as</span> <span class="title class_">ValidEmail</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 使用</span></span><br><span class="line"><span class="keyword">const</span> valid = <span class="title function_">assertEmail</span>(<span class="string">&quot;user@example.com&quot;</span>); <span class="comment">// ✅</span></span><br><span class="line"><span class="keyword">const</span> invalid = <span class="title function_">assertEmail</span>(<span class="string">&quot;invalid-email&quot;</span>); <span class="comment">// ❌ 类型错误</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. 扩展：密码强度验证</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">StrongPassword</span> = <span class="built_in">string</span> &amp; &#123;</span><br><span class="line">  <span class="attr">_pattern</span>: <span class="regexp">/^(?=.*[A-Z])(?=.*[!@#$%^&amp;*])(?=.&#123;8,&#125;)/</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">setPassword</span>(<span class="params"><span class="attr">pwd</span>: <span class="title class_">StrongPassword</span></span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="类型谓词-类型收窄：in"><a href="#类型谓词-类型收窄：in" class="headerlink" title="类型谓词&#x2F;类型收窄：in"></a>类型谓词&#x2F;类型收窄：in</h3><p>允许我们在函数中编写逻辑来判断某个值是否属于特定类型，并在条件分支中缩小类型范围。</p>
<p>用于自定义类型保护，通过返回布尔值的函数来缩小类型范围，增强类型安全性</p>
<p>语法：<code>parameterName is Type</code></p>
<ul>
<li>在函数中执行运行时检查，并告诉TypeScript编译器在某个作用域内变量的具体类型。</li>
<li>自定义复杂的类型保护逻辑。</li>
</ul>
<h4 id="判断数组是否是非空"><a href="#判断数组是否是非空" class="headerlink" title="判断数组是否是非空"></a>判断数组是否是非空</h4><p>利用了元组的特性，再加上<code>in</code>关键词</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">NonEmptyArray</span>&lt;T&gt; = [T, ...T[]];</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> isNonEmptyArray&lt;T&gt;(<span class="attr">arr</span>: T[]): arr is <span class="title class_">NonEmptyArray</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> arr.<span class="property">length</span> &gt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">arr1</span>: <span class="built_in">number</span>[] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">const</span> <span class="attr">arr2</span>: <span class="built_in">number</span>[] = [];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_">isNonEmptyArray</span>(arr1)) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;First element:&#x27;</span>, arr1[<span class="number">0</span>]); <span class="comment">// 这里arr1被识别为NonEmptyArray&lt;number&gt;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_">isNonEmptyArray</span>(arr2)) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;First element:&#x27;</span>, arr2[<span class="number">0</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Array is empty&#x27;</span>); <span class="comment">// 会执行这个分支</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="类型谓词工厂"><a href="#类型谓词工厂" class="headerlink" title="类型谓词工厂"></a>类型谓词工厂</h4><p>创建可配置的类型守卫，避免重复代码</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 定义工厂函数</span></span><br><span class="line"><span class="keyword">function</span> isType&lt;T&gt;(<span class="attr">typeName</span>: <span class="built_in">string</span>): <span class="function">(<span class="params"><span class="attr">value</span>: <span class="built_in">unknown</span></span>) =&gt;</span> value is T &#123;</span><br><span class="line">  <span class="keyword">return</span> (value): value is T =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(value) === <span class="string">`[object <span class="subst">$&#123;typeName&#125;</span>]`</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 创建特定类型守卫</span></span><br><span class="line"><span class="keyword">const</span> isArray = isType&lt;<span class="title class_">Array</span>&lt;<span class="built_in">any</span>&gt;&gt;(<span class="string">&#x27;Array&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> isDate = isType&lt;<span class="title class_">Date</span>&gt;(<span class="string">&#x27;Date&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 使用</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">data</span>: <span class="built_in">unknown</span> = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_">isArray</span>(data)) &#123;</span><br><span class="line">  data.<span class="title function_">push</span>(<span class="number">4</span>) <span class="comment">// ✅ data 被识别为 any[]</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">input</span>: <span class="built_in">unknown</span> = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_">isDate</span>(input)) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(input.<span class="title function_">getFullYear</span>()) <span class="comment">// ✅ 识别为 Date</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="联合类型收窄（处理复杂联合类型）"><a href="#联合类型收窄（处理复杂联合类型）" class="headerlink" title="联合类型收窄（处理复杂联合类型）"></a>联合类型收窄（处理复杂联合类型）</h4><p>当联合类型成员结构相似但无公共判别属性时，使用类型谓词精确区分</p>
<p>类似于<code>switch case</code>语法</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 定义易混淆的联合类型</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Result</span> = </span><br><span class="line">  | &#123; <span class="attr">success</span>: <span class="literal">true</span>; <span class="attr">data</span>: <span class="built_in">string</span> &#125;</span><br><span class="line">  | &#123; <span class="attr">error</span>: <span class="literal">true</span>; <span class="attr">code</span>: <span class="built_in">number</span> &#125;</span><br><span class="line">  | &#123; <span class="attr">status</span>: <span class="string">&quot;pending&quot;</span>; <span class="attr">id</span>: <span class="built_in">string</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 没有公共可辨识属性，需要自定义守卫</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isSuccess</span>(<span class="params"><span class="attr">result</span>: <span class="title class_">Result</span></span>): result is &#123; <span class="attr">success</span>: <span class="literal">true</span>; <span class="attr">data</span>: <span class="built_in">string</span> &#125; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;success&quot;</span> <span class="keyword">in</span> result &amp;&amp; result.<span class="property">success</span> === <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isError</span>(<span class="params"><span class="attr">result</span>: <span class="title class_">Result</span></span>): result is &#123; <span class="attr">error</span>: <span class="literal">true</span>; <span class="attr">code</span>: <span class="built_in">number</span> &#125; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;error&quot;</span> <span class="keyword">in</span> result &amp;&amp; result.<span class="property">error</span> === <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handle</span>(<span class="params"><span class="attr">result</span>: <span class="title class_">Result</span></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">isSuccess</span>(result)) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(result.<span class="property">data</span>); <span class="comment">// ✅ 收窄到成功类型</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="title function_">isError</span>(result)) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(result.<span class="property">code</span>); <span class="comment">// ✅ 收窄到错误类型</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(result.<span class="property">id</span>); <span class="comment">// ✅ 收窄到 pending 类型</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="递归类型守卫（处理嵌套数据结构）"><a href="#递归类型守卫（处理嵌套数据结构）" class="headerlink" title="递归类型守卫（处理嵌套数据结构）"></a>递归类型守卫（处理嵌套数据结构）</h4><p>验证递归结构的数据（如树形结构、嵌套对象）。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 定义树节点类型</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">TreeNode</span> = &#123;</span><br><span class="line">  <span class="attr">value</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">children</span>?: <span class="title class_">TreeNode</span>[];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 创建递归类型守卫</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isTreeNode</span>(<span class="params"><span class="attr">value</span>: <span class="built_in">unknown</span></span>): value is <span class="title class_">TreeNode</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> value !== <span class="string">&quot;object&quot;</span> || value === <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> obj = value <span class="keyword">as</span> <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="built_in">unknown</span>&gt;;</span><br><span class="line">  <span class="comment">// 检查 value 属性</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> obj.<span class="property">value</span> !== <span class="string">&quot;number&quot;</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  <span class="comment">// 递归检查 children</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="string">&quot;children&quot;</span> <span class="keyword">in</span> obj) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title class_">Array</span>.<span class="title function_">isArray</span>(obj.<span class="property">children</span>)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> obj.<span class="property">children</span>.<span class="title function_">every</span>(isTreeNode); <span class="comment">// 递归验证每个子节点</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 使用</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">data</span>: <span class="built_in">unknown</span> = &#123;</span><br><span class="line">  <span class="attr">value</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">children</span>: [</span><br><span class="line">    &#123; <span class="attr">value</span>: <span class="number">2</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">value</span>: <span class="number">3</span>, <span class="attr">children</span>: [&#123; <span class="attr">value</span>: <span class="number">4</span> &#125;] &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_">isTreeNode</span>(data)) &#123;</span><br><span class="line">  <span class="comment">// ✅ 识别为 TreeNode 类型</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(data.<span class="property">children</span>?.[<span class="number">0</span>]?.<span class="property">value</span>); <span class="comment">// 2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="异步类型守卫（结合-Promise）"><a href="#异步类型守卫（结合-Promise）" class="headerlink" title="异步类型守卫（结合 Promise）"></a>异步类型守卫（结合 Promise）</h4><p>在异步流程中验证数据形状（如 API 响应）。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 定义远程数据类型</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">RemoteData</span> = &#123; <span class="attr">ok</span>: <span class="literal">true</span>; <span class="attr">data</span>: <span class="built_in">string</span> &#125; | &#123; <span class="attr">ok</span>: <span class="literal">false</span>; <span class="attr">error</span>: <span class="built_in">string</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 创建异步类型守卫</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">isRemoteDataSuccess</span>(<span class="params"><span class="attr">response</span>: <span class="title class_">Promise</span>&lt;<span class="title class_">RemoteData</span>&gt;</span>)</span><br><span class="line">  : <span class="title class_">Promise</span>&lt;response is <span class="title class_">Promise</span>&lt;&#123; <span class="attr">ok</span>: <span class="literal">true</span>; <span class="attr">data</span>: <span class="built_in">string</span> &#125;&gt;&gt; </span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">const</span> result = <span class="keyword">await</span> response;</span><br><span class="line">  <span class="keyword">return</span> result.<span class="property">ok</span> === <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 使用</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fetchData</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">response</span>: <span class="title class_">Promise</span>&lt;<span class="title class_">RemoteData</span>&gt; = <span class="title function_">fetchAPI</span>(); <span class="comment">// 模拟 API 调用</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">await</span> <span class="title function_">isRemoteDataSuccess</span>(response)) &#123;</span><br><span class="line">    <span class="keyword">const</span> resolved = <span class="keyword">await</span> response;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(resolved.<span class="property">data</span>); <span class="comment">// ✅ 类型收窄为 &#123; ok: true; data: string &#125;</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> resolved = <span class="keyword">await</span> response;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(resolved.<span class="property">error</span>); <span class="comment">// ✅ 类型收窄为 &#123; ok: false; error: string &#125;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="品牌化类型（Nominal-Typing）验证"><a href="#品牌化类型（Nominal-Typing）验证" class="headerlink" title="品牌化类型（Nominal Typing）验证"></a>品牌化类型（Nominal Typing）验证</h4><p>在结构类型系统中模拟名义类型检查（如验证 UUID 格式）。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 定义品牌化类型</span></span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">UUID</span> = <span class="built_in">string</span> &amp; &#123; <span class="keyword">readonly</span> <span class="attr">brand</span>: unique <span class="built_in">symbol</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 类型守卫验证格式</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isUUID</span>(<span class="params"><span class="attr">value</span>: <span class="built_in">string</span></span>): value is <span class="variable constant_">UUID</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> regex = <span class="regexp">/^[0-9a-f]&#123;8&#125;-[0-9a-f]&#123;4&#125;-[0-9a-f]&#123;4&#125;-[0-9a-f]&#123;4&#125;-[0-9a-f]&#123;12&#125;$/i</span>;</span><br><span class="line">  <span class="keyword">return</span> regex.<span class="title function_">test</span>(value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 使用</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">saveId</span>(<span class="params"><span class="attr">id</span>: UUID</span>) &#123;</span><br><span class="line">  <span class="comment">// 保存操作</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">input</span>: <span class="built_in">string</span> = <span class="string">&quot;550e8400-e29b-41d4-a716-446655440000&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_">isUUID</span>(input)) &#123;</span><br><span class="line">  <span class="title function_">saveId</span>(input); <span class="comment">// ✅ 允许：input 被识别为 UUID</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;Invalid UUID&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="类型谓词与断言函数结合"><a href="#类型谓词与断言函数结合" class="headerlink" title="类型谓词与断言函数结合"></a>类型谓词与断言函数结合</h4><ul>
<li>类型谓词（Type Predicate）：value is string <ul>
<li>返回 boolean 值，用于类型收窄</li>
</ul>
</li>
<li>断言函数（Assertion Function）：asserts value is string <ul>
<li>不返回值，而是抛出异常或继续执行</li>
</ul>
</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 定义断言函数（类型谓词 + throw）</span></span><br><span class="line"><span class="comment">// 运行时行为：如果 condition 为 false，函数会抛出错误</span></span><br><span class="line"><span class="comment">// 编译时行为：如果函数成功返回（没有抛出错误），TypeScript 会认为 condition 为 true，并相应地缩小类型范围</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">assert</span>(<span class="params"><span class="attr">condition</span>: <span class="built_in">boolean</span>, <span class="attr">msg</span>?: <span class="built_in">string</span></span>): asserts condition &#123;</span><br><span class="line">  <span class="keyword">if</span> (!condition) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(msg);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 自定义类型断言</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">assertString</span>(<span class="params"><span class="attr">value</span>: <span class="built_in">unknown</span></span>): asserts value is <span class="built_in">string</span> &#123;</span><br><span class="line">  <span class="title function_">assert</span>(<span class="keyword">typeof</span> value === <span class="string">&quot;string&quot;</span>, <span class="string">&quot;Value must be string&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 使用</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">process</span>(<span class="params"><span class="attr">input</span>: <span class="built_in">unknown</span></span>) &#123;</span><br><span class="line">  <span class="title function_">assertString</span>(input);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(input.<span class="title function_">toUpperCase</span>()); <span class="comment">// ✅ input 被识别为 string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. 组合类型谓词</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">validateUser</span>(<span class="params"><span class="attr">user</span>: <span class="built_in">unknown</span></span>): asserts user is &#123; <span class="attr">name</span>: <span class="built_in">string</span>; <span class="attr">age</span>: <span class="built_in">number</span> &#125; &#123;</span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    <span class="keyword">typeof</span> user === <span class="string">&quot;object&quot;</span> &amp;&amp; </span><br><span class="line">    user !== <span class="literal">null</span> &amp;&amp; </span><br><span class="line">    <span class="string">&quot;name&quot;</span> <span class="keyword">in</span> user &amp;&amp; </span><br><span class="line">    <span class="keyword">typeof</span> user.<span class="property">name</span> === <span class="string">&quot;string&quot;</span> &amp;&amp;</span><br><span class="line">    <span class="string">&quot;age&quot;</span> <span class="keyword">in</span> user &amp;&amp;</span><br><span class="line">    <span class="keyword">typeof</span> user.<span class="property">age</span> === <span class="string">&quot;number&quot;</span></span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;Invalid user&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="内置高级类型"><a href="#内置高级类型" class="headerlink" title="内置高级类型"></a>内置高级类型</h2><table>
<thead>
<tr>
<th>类型</th>
<th>示例</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>Partial&lt;T&gt;</code></td>
<td>Partial<User></td>
<td>所有属性变为可选</td>
</tr>
<tr>
<td><code>Required&lt;T&gt;</code></td>
<td>Required<User></td>
<td>所有属性变为必选</td>
</tr>
<tr>
<td><code>Readonly&lt;T&gt;</code></td>
<td>Readonly<User></td>
<td>所有属性变为只读</td>
</tr>
<tr>
<td><code>Record&lt;K,T&gt;</code></td>
<td>Record&lt;’id’, string&gt;</td>
<td>键值映射</td>
</tr>
<tr>
<td><code>Pick&lt;T,K&gt;</code></td>
<td>Pick&lt;User, ‘name’&gt;</td>
<td>选择部分属性</td>
</tr>
<tr>
<td><code>Omit&lt;T,K&gt;</code></td>
<td>Omit&lt;User, ‘password’&gt;</td>
<td>排除部分属性</td>
</tr>
<tr>
<td><code>Exclude&lt;T,U&gt;</code></td>
<td>Exclude&lt;string</td>
<td>number, number&gt;</td>
</tr>
<tr>
<td><code>Extract&lt;T,U&gt;</code></td>
<td>Extract&lt;string</td>
<td>number, number&gt;</td>
</tr>
<tr>
<td><code>NonNullable&lt;T&gt;</code></td>
<td>NonNullable&lt;string</td>
<td>null&gt;	排除 null&#x2F;undefined</td>
</tr>
<tr>
<td><code>Parameters&lt;T&gt;</code></td>
<td>Parameters&lt;(a: string) &#x3D;&gt; void&gt;</td>
<td>获取函数参数类型元组</td>
</tr>
<tr>
<td><code>ReturnType&lt;T&gt;</code></td>
<td>ReturnType&lt;() &#x3D;&gt; number&gt;</td>
<td>获取函数返回值类型</td>
</tr>
<tr>
<td><code>ConstructorParameters&lt;T&gt;</code></td>
<td>ConstructorParameters<Error></td>
<td>获取构造函数参数类型</td>
</tr>
</tbody></table>
<h2 id="参链"><a href="#参链" class="headerlink" title="参链"></a>参链</h2><ul>
<li><a target="_blank" rel="noopener" href="https://juejin.cn/post/7511568225987346467">不是只有服务能分布，类型也能分布：解密 TypeScript 分布式条件类型</a></li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Typescript/" rel="tag"># Typescript</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/08/14/Typescript/%E3%80%90TS%E3%80%91%E6%A8%A1%E5%9D%97%E8%A7%A3%E6%9E%90/" rel="prev" title="【TS】模块解析">
                  <i class="fa fa-angle-left"></i> 【TS】模块解析
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/08/14/Typescript/%E3%80%90TS%E3%80%91%E8%AE%B0%E5%BD%95%E5%B0%8F%E7%82%B9/" rel="next" title="记录">
                  记录 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">yangxin</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
