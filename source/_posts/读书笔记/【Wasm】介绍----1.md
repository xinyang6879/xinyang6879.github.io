---
title: 【Wasm】介绍(未完成)
categories: webAssembly
tag: webAssembly
---

## 出现背景

webAssembly的堆栈式结构被设计为编码为一种高密度，可以被浏览器快速加载和执行的二进制格式。

webAssembly的设计初衷是希望浏览器以近似原生C/C++应用的运行速度，来调用Wasm模块中包含的这各类型平台（处理器架构）上都可以使用的通用硬件功能。

Wasm描述来一个内存安全的沙箱执行环境，可以在现有的js虚拟机中运行实现。当浏览器中运行一个Wasm模块时，Wasm将遵循浏览器中与Web应用一致的同源策略来保证其安全性。

## 基本原理

Wasm主要是中v8解析js的解析器和编译链路中进行处理（Pipeline链路）

- 链路中各个编译器的前置Parser的语法分析，转换为AST中间数据格式

- 优化编译，TurboFn优化编译器会使用IC（Inline Cache）和OSR（On Stack Replacement）等对js源码进行分析和优化

- 进行lowering操作，优化编译器会根据现有的已经优化好的js源码来生成一些处于低层级且与硬件架构相关的中间代码。

- <font color=red>此时加入Wasm操作</font>

引擎不需要对Wasm模块中的二进制代码进行优化，也不需要生成冗余的占用大量内存的AST结构信息。只需要把这些模块中的二进制代码直接加载到内存中，然后经过位于V8链路末端编译器后端的处理，最后生成的机器码便可以直接被浏览器执行。

- 位于V8链路最末端的编译器后端（backend）负责将这些经过处理后的代码直接转译成基于特定处理器架构的机器码，最后再被浏览器解析和执行
