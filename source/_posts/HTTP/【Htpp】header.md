---
title: 【Htpp】header
categories: http
tag: http
---

## 通用头部

### cache-control

控制缓存，可以接收多个参数，参数之间以“，”隔空。

> 请求和响应共用

- no-cache：表示强制使用最新的值而不使用缓存。请求头部包含no-cache，表示客户端不接收缓存过的响应，缓存服务器必须把客户端请求转发给源服务器；响应请求里面包含，那么缓存服务器不能对响应资源进行缓存。（协商缓存

- no-store：不应该缓存当前内容，表示对应的报文中包含机密信息，不缓存

- no-transform：缓存不能改变主体的媒体类型，能防止缓存服务器压缩图片资源等。

- max-age：缓存有效期（以秒为单位）。请求包含时，如果缓存资源的缓存时间比指定时间数值更小时则接受缓存资源，当值为0时，缓存服务器会把请求转发给源服务器；当响应包含时，缓存服务器不再确认资源的有效期，而以max-age数值作为缓存保存时长。

- s-maxage: 用于配置**代理服务器**的缓存，以秒为单位，优先级高于max-age，但只在代理服务器中生效，客户端依然使用max-age

#### max-age=0和no-cache

- `no-cache`：浏览器可以进行缓存，未定性缓存是否已经过期，禁用未经验证的缓存。但是在每次请求时，需要像服务端发送一个请求判断这次的资源是否过期。如果服务端返回304，说明资源还在有效期内，浏览器可以直接使用缓存资源；但是如果内容已经过期了，服务器会返回新的内容。比max-age=0更严格，确保每次都需要进行验证

- `max-age=0`: 将缓存已经视为过期了，但允许客户端复用缓存（通过验证），需要像服务器发起请求，如果服务端返回304，那么客户端依旧使用缓存，如果是200，那么就视为需要重新获取新数据。

Cache-Control: no-cache, max-age=0是冗余写法，但是可以确保浏览器的兼容性

|特性|max-age=0|no-cache|
|-----|------|-----|
|缓存是否保留|保留，但被视为过期|保留，但每次使用前需要验证|
|验证条件|可能被其他条件覆盖|强制无条件|
|优先级|较低|较高|
|场景|希望缓存快速更新，但允许复用|强制要求数据一致性（如实时数据）|

> 请求头部

- min-fresh：要求缓存服务器指定时间内返回响应（以秒为单位）

- only-if-cached：客户端仅在缓存服务器本地缓存目标资源的情况下才会要求其返回值，也就是说不会向源服务器转发请求。

> 响应头部

- [must-revalidate](https://blog.csdn.net/mK0vouYv4BwgX190fSd/article/details/89880083)：本地缓存过期前可以使用，否则必须进行有效性校验

- public：响应可能会被任何对象缓存，没有限制

- private： 响应只能被特定用户缓存，不能被其他用户使用

- proxy-revalidate：仅适用于共享缓存，私有缓存时忽略

### connection

- close: 当一方的connection为close时，表示关闭此次连接

- keep-live：持久化连接

### date

报文创建时间

## 请求头部

### accept

可以设置多个值，每个值通过“，”进行分割

常用值：text/html，application/xml；q=0.9等

注：q=x，是给当前类型赋予权重，范围为0～1，可精确到小数点后3位。和MIME子类型通过“，”分割，默认权重值为1。服务器会优先返回权重较大的类型，如果权重相等，则按照从左至右的顺序处理。

### accept-charset
客户端可以处理的字符集类型，通常不需要额外设置此项，每种文件类型都有默认的值。和accept一样可以设置权重

### accept-encoding
客户端可以接收的编码方式，通常这个字段值会是某种压缩算法，比如gzip等。和accept一样可以设置权重

### accept-language
客户端可以解析的自然语言，可以一次性指定多个语言并设置权重。

### authorization
告知服务端认证信息。通常在收到401后，在请求头里面加入authorization：type credentials

### host（必传）
告知服务器请求资源所处的互联网主机名和端口号（不指定将使用默认端口号）。

必传是因为服务器在接收到请求后将请求的主机号替换为ip地址，但是如果这个ip部署了多个域名，那么服务器无法转发到对应的请求

### if-modified-since
确认代理或者客户端本地资源的有效性。服务端在接受到这个值后，会与资源最近更新时间做对比，如果在字段指定的日期之后资源发生了变化，那么服务器会返回最新的资源，否则返回304

### if-none-match
用于判断本地缓存是否失效。存储的是上个响应头部的etag值。当指定的值与资源的etag值不一致时，服务器端才会处理请求

## 响应头部

### age

告知客户端服务端在多久前创建了响应，若创建该响应的是缓存服务器，age指的是缓存后响应再次发起认证到认证完成的时间。代理创建响应必须加上age字段

### etag

服务端在每次更新资源后生成一个唯一对应的标识，生成算法由服务器自行决定

分类：
- 强etag：资源发生变化就会改变

- 弱etag：资源发生了较大变化时才会改变。以W/来表示

### location

使用头部字段location可以引导请求发起方至某个与请求url位置不同的资源，一般会配合3xx进行使用

### www-authenticate

告知客户端当前服务器端可接收的认证方案，然后客户端可以在authentication字段中返回对应的值

## 主体头部

### allow

通知客户端能够支持的http请求方法。当服务端接收到不支持http请求方法时，会响应状态信息405，同时把支持的方法写入allow字段

### content-encoding

告知客户端当前响应内容的编码方式

### content-length

表明主体部分的大小，单位为字节

### content-type

表明响应主体内容的MIME类型

### last-modified

资源最后的修改时间，配合缓存使用

### expires

失效日期
