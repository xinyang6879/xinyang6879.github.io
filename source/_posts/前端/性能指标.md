---
title: 性能指标
categories: 前端
tag: 前端
---

## 基于用户的性能指标

### FCP：白屏时间

<h1></h1>

| FCP 时长 | 颜色编码                       | FCP 分数(HTTP 存档百分位数) |
| -------- | ------------------------------ | --------------------------- |
| 0-2s     | <font color=green>快速</font>  | 75-100                      |
| 2-4s     | <font color=yellow>中等</font> | 50-74                       |
| >4s      | <font color=red>慢</font>      | 0-49                        |

### LCP：主要内容可见时间

(可视区域最大-资源较大 元素到屏幕上的间隔时间)

<h1></h1>

并不是只初始加载页面的，而是指页面元素变化的时候

> LCP 考虑的元素

- `<img>`元素
- `<image>`元素的`<svg>`
- `<video>`
- 通过`[url()](https://developer.mozilla.org/en-US/docs/Web/CSS/url())`函数加载背景图片的元素
- 包含文本节点或者其他内联文字元素子级的块级元素

| LCP 时长 | 颜色编码                       |
| -------- | ------------------------------ |
| 0-2.5s   | <font color=green>快速</font>  |
| 2.5-4s   | <font color=yellow>中等</font> |
| >4s      | <font color=red>慢</font>      |

### FID：首次输入延迟

第一次与页面交互(点击按钮链接等)到浏览器实际能够响应这次交互的时间

<h1></h1>

> 输入延迟是因为浏览器的主线程处于繁忙状态(比如忙于解析和执行程序加载的大量计算的 js)，导致无法及时响应用户。

> 第一次的输入延迟通常发生在 FCP 和 TTI 之间，因为页面虽然已经呈现了，但是还无法可靠交互

| FID 时长 | 颜色编码                       |
| -------- | ------------------------------ |
| 0-0.1s   | <font color=green>快速</font>  |
| 0.1-0.3s | <font color=yellow>中等</font> |
| >0.3s    | <font color=red>慢</font>      |

### TTI：第一次完全达到可交互状态

浏览器可以持续性的响应用户的交互事件。完全达到可交互的状态时间点是在最后一个长文物(50ms 以上才能完成的任务)完成的事件，并且在随后的 5s 内网络和主线程是空闲的

<h1></h1>

| TTI 时长 | 颜色编码                       |
| -------- | ------------------------------ |
| 0-3.8s   | <font color=green>快速</font>  |
| 3.8-7.3s | <font color=yellow>中等</font> |
| >7.3s    | <font color=red>慢</font>      |

### TBT：总阻塞时间

即 FCP 和 TTI 之间的间隔时长，在改时间范围内，主线程被阻塞足够长的时间以防止用户的输入事件。

<h1></h1>

> 长任务，执行时长超过了 50ms

> 页面总阻塞时间=FCP 和 TTI 之间发生的每个长任务的阻塞时间总和

> 长任务的阻塞时间=长任务的实际执行时长-50ms

| TBT 时长 | 颜色编码                       |
| -------- | ------------------------------ |
| 0-0.3s   | <font color=green>快速</font>  |
| 0.3-0.6s | <font color=yellow>中等</font> |
| >0.6s    | <font color=red>慢</font>      |

### CLS：累计布局偏移

在整个生命周期中发生的每个意外的布局移位(即在不是预计的位置偏移或者样式错乱)的所有单独布局。

保证页面的视觉稳定性

<h1></h1>

> 元素的意外移动通常是由于异步加载资源或者 DOM 元素动态添加到现有内容商法的页面而发生的

> 可能是由于尺寸未知的多媒体资源，字体变化或者动态调整自身大小的第三方广告、小部件

| TBT 时长   | 颜色编码                       |
| ---------- | ------------------------------ |
| 0-0.1ms    | <font color=green>快速</font>  |
| 0.1-0.25ms | <font color=yellow>中等</font> |
| >0.25ms    | <font color=red>慢</font>      |

### 速度指数(SI)：页面可视区域中内容的填充速度

计算页面可见区域内容显示的平均时间来衡量

<h1></h1>

> 捕获浏览器加载页面过程的视频，然后对每 100ms 间隔的页面截图计算页面内容的填充百分比

| TBT 时长  | 颜色编码                       |
| --------- | ------------------------------ |
| 0-4.3s    | <font color=green>快速</font>  |
| 4.3-5.8ms | <font color=yellow>中等</font> |
| >5.8ms    | <font color=red>慢</font>      |

## [RAIL 性能模型](https://zhuanlan.zhihu.com/p/422402515)

> RAIL

- R(响应)：应该尽可能快速的响应用户，应该在 100ms 内相应用户
- A(Animation)：在展示动画的时候，每一帧应该以 16ms 进行渲染，这样可以保持动画的一致性，避免卡顿
- I(空闲)：当使用 JS 主线程的时候，应该把任务划分到执行时间小于 50ms 的片段中，这样可以释放线程以进行用户交互
- L(加载)：应该在小于 1s 的时间内完成加载网页，且可以进行用户交互

> 感知延迟的时间窗口

| 延迟时长 | 用户反映 |
| --- | --- |
| 0-16ms | 人眼可以感知每秒 60 帧的动画，即每帧 16ms，除了浏览器将一帧画面绘制到屏幕上的时间，网站应用大约需要 10ms 生成一帧 |
| 0-100ms | 在该范围内相应用户的操作，属于流畅的体验 |
| 100-1000ms | 能够感知明显延迟 |
| >1s | 用户注意力将离开对执行任务的关注 |
| >10s | 感到过于长以至于失望，可能回放弃任务 |

## Web Vitals

### Core Web Vitals

应用于所有 web 页面的 Web Vitals 子集，为其最重要的核心

主要指标

- LCP：加载性能
- FID：交互性
- CLS：视觉稳定性

## 测试工具

- LightHouse
- [WebPageTest](https://www.webpagetest.org)
- DevTools