<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="yangxin">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-æ‰‹å†™é¢˜" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/08/14/%E6%89%8B%E5%86%99%E9%A2%98/" class="article-date">
  <time class="dt-published" datetime="2025-08-14T03:18:33.981Z" itemprop="datePublished">2025-08-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/js/">js</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/08/14/%E6%89%8B%E5%86%99%E9%A2%98/">æ‰‹å†™é¢˜</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="å°†ä¸€ç»´æ•°ç»„è½¬åŒ–ä¸º-tree"><a href="#å°†ä¸€ç»´æ•°ç»„è½¬åŒ–ä¸º-tree" class="headerlink" title="å°†ä¸€ç»´æ•°ç»„è½¬åŒ–ä¸º tree"></a>å°†ä¸€ç»´æ•°ç»„è½¬åŒ–ä¸º tree</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> list = [</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="string">&quot;01&quot;</span>, <span class="attr">parentId</span>: <span class="number">0</span>, <span class="attr">name</span>: <span class="string">&quot;èŠ‚ç‚¹1&quot;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="string">&quot;011&quot;</span>, <span class="attr">parentId</span>: <span class="string">&quot;01&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;èŠ‚ç‚¹1-1&quot;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="string">&quot;0111&quot;</span>, <span class="attr">parentId</span>: <span class="string">&quot;011&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;èŠ‚ç‚¹1-1-1&quot;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="string">&quot;02&quot;</span>, <span class="attr">parentId</span>: <span class="number">0</span>, <span class="attr">name</span>: <span class="string">&quot;èŠ‚ç‚¹2&quot;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="string">&quot;022&quot;</span>, <span class="attr">parentId</span>: <span class="string">&quot;02&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;èŠ‚ç‚¹2-2&quot;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="string">&quot;023&quot;</span>, <span class="attr">parentId</span>: <span class="string">&quot;02&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;èŠ‚ç‚¹2-3&quot;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="string">&quot;0222&quot;</span>, <span class="attr">parentId</span>: <span class="string">&quot;022&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;èŠ‚ç‚¹2-2-2&quot;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="string">&quot;03&quot;</span>, <span class="attr">parentId</span>: <span class="number">0</span>, <span class="attr">name</span>: <span class="string">&quot;èŠ‚ç‚¹3&quot;</span> &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<ul>
<li><p>è§£æ³• 1ï¼š</p>
<p>ä½¿ç”¨å¾ªç¯+é€’å½’çš„å½¢å¼</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">findParent</span>(<span class="params">tree, child</span>) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> cur <span class="keyword">of</span> tree) &#123;</span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">      cur.<span class="property">id</span> !== child.<span class="property">parentId</span> &amp;&amp;</span><br><span class="line">      cur.<span class="property">children</span> &amp;&amp;</span><br><span class="line">      cur.<span class="property">children</span>.<span class="property">length</span> !== <span class="number">0</span></span><br><span class="line">    ) &#123;</span><br><span class="line">      cur = <span class="title function_">findParent</span>(cur.<span class="property">children</span>, child);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (cur.<span class="property">id</span> === child.<span class="property">parentId</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (cur.<span class="property">children</span>) &#123;</span><br><span class="line">        cur.<span class="property">children</span>.<span class="title function_">push</span>(child);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        cur.<span class="property">children</span> = [child];</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> tree;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> tree;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">arrToTree</span>(<span class="params">arr</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> tree = [];</span><br><span class="line">  <span class="keyword">const</span> len = arr.<span class="property">length</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (arr[i].<span class="property">parentId</span> === <span class="number">0</span>) &#123;</span><br><span class="line">      tree.<span class="title function_">push</span>(arr[i]);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      tree = <span class="title function_">findParent</span>(tree, arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> tree;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>è§£æ³• 2ï¼š</p>
<p>ä½¿ç”¨ map æ˜ å°„å’Œ js å½“å¼•ç”¨ç±»å‹èµ‹å€¼æ—¶ï¼Œæ˜¯<strong>æ‹·è´çš„åœ°å€</strong>çš„ç‰¹æ€§</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">con</span>(<span class="params">arr</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> res = [];</span><br><span class="line">  <span class="keyword">const</span> map = arr.<span class="title function_">reduce</span>(<span class="function">(<span class="params">res, v</span>) =&gt;</span> ((res[v.<span class="property">id</span>] = v), res), &#123;&#125;);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> item <span class="keyword">of</span> arr) &#123;</span><br><span class="line">    <span class="keyword">if</span> (item.<span class="property">parentId</span> <span class="keyword">in</span> map) &#123;</span><br><span class="line">      <span class="keyword">const</span> parent = map[item.<span class="property">parentId</span>];</span><br><span class="line">      parent.<span class="property">children</span> = parent.<span class="property">children</span> || [];</span><br><span class="line">      parent.<span class="property">children</span>.<span class="title function_">push</span>(item);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      res.<span class="title function_">push</span>(item);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="object-é”®æ‰å¹³åŒ–"><a href="#object-é”®æ‰å¹³åŒ–" class="headerlink" title="object é”®æ‰å¹³åŒ–"></a>object é”®æ‰å¹³åŒ–</h2><p>åŸå§‹æ•°æ®ï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;a&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;b&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;c&quot;</span><span class="punctuation">:</span> <span class="number">2</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;d&quot;</span><span class="punctuation">:</span> <span class="number">3</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;d&quot;</span><span class="punctuation">:</span> <span class="string">&quot;d&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;e&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;f&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;g&quot;</span><span class="punctuation">:</span> <span class="string">&quot;g&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;f&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;h&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;i&quot;</span><span class="punctuation">:</span> <span class="string">&quot;i&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;g&quot;</span><span class="punctuation">:</span> <span class="string">&quot;g2&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>è½¬æ¢æ•°æ®ï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;a.b.c&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;a.d&quot;</span><span class="punctuation">:</span> <span class="number">3</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;d&quot;</span><span class="punctuation">:</span> <span class="string">&quot;d&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;e.f.g&quot;</span><span class="punctuation">:</span> <span class="string">&quot;g&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;e.f.f.h.i&quot;</span><span class="punctuation">:</span> <span class="string">&quot;i&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;e.g&quot;</span><span class="punctuation">:</span> <span class="string">&quot;g2&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>è§£æ³• 1<br>é‡‡ç”¨ dfs æ€ç»´åš</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">dfs</span>(<span class="params">tree, preKey = <span class="string">&quot;&quot;</span></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> tree !== <span class="string">&quot;object&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">key</span>: preKey,</span><br><span class="line">      <span class="attr">value</span>: tree,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> keys = <span class="title class_">Reflect</span>.<span class="title function_">ownKeys</span>(tree);</span><br><span class="line">  <span class="keyword">let</span> res = [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">of</span> keys) &#123;</span><br><span class="line">    <span class="keyword">let</span> val = <span class="title function_">dfs</span>(tree[key], preKey + <span class="string">&quot;.&quot;</span> + key);</span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(val)) &#123;</span><br><span class="line">      res = res.<span class="title function_">concat</span>(val);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      res.<span class="title function_">push</span>(val);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ObjectKeyToStr</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> keys = <span class="title class_">Reflect</span>.<span class="title function_">ownKeys</span>(obj);</span><br><span class="line">  <span class="keyword">let</span> res = &#123;&#125;;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">of</span> keys) &#123;</span><br><span class="line">    <span class="keyword">const</span> data = <span class="title function_">dfs</span>(obj[key], key);</span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(data)) &#123;</span><br><span class="line">      data.<span class="title function_">forEach</span>(<span class="function">(<span class="params">ele</span>) =&gt;</span> &#123;</span><br><span class="line">        res[ele.<span class="property">key</span>] = ele.<span class="property">value</span>;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      res[data.<span class="property">key</span>] = data.<span class="property">value</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>è§£æ³• 2</p>
<p>é‡‡ç”¨ç±»bfsçš„æ€è·¯</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getKeys</span>(<span class="params">tree</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Reflect</span>.<span class="title function_">ownKeys</span>(tree);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">bfs</span>(<span class="params">tree</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> stack = [];</span><br><span class="line">  <span class="keyword">let</span> res = &#123;&#125;;</span><br><span class="line">  <span class="keyword">let</span> item = tree;</span><br><span class="line">  <span class="keyword">while</span> (item) &#123;</span><br><span class="line">    <span class="title function_">getKeys</span>(item).<span class="title function_">forEach</span>(<span class="function">(<span class="params">ele</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> currdata = item[ele];</span><br><span class="line">      <span class="comment">// å› ä¸ºé¢å¤–åŠ äº†_keyå±æ€§ï¼Œå› æ­¤éœ€è¦è·³è¿‡è¿™ä¸ªå±æ€§</span></span><br><span class="line">      <span class="keyword">if</span> (ele !== <span class="string">&quot;_key&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(currdata) === <span class="string">&quot;[object Object]&quot;</span>) &#123;</span><br><span class="line">          stack.<span class="title function_">unshift</span>(&#123;</span><br><span class="line">            ...currdata,</span><br><span class="line">            <span class="attr">_key</span>: item.<span class="property">_key</span> ? item.<span class="property">_key</span> + <span class="string">&quot;.&quot;</span> + ele : ele,</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">const</span> key = item.<span class="property">_key</span> ? item.<span class="property">_key</span> + <span class="string">&quot;.&quot;</span> + ele : ele;</span><br><span class="line">          <span class="keyword">delete</span> currdata.<span class="property">_key</span>;</span><br><span class="line">          res[key] = currdata;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    item = stack.<span class="title function_">shift</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/08/14/%E6%89%8B%E5%86%99%E9%A2%98/" data-id="cmebduivc000cpwfmfh0qe3cj" data-title="æ‰‹å†™é¢˜" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-ã€æ‰‹å†™ã€‘callã€applyã€bind" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/08/14/%E3%80%90%E6%89%8B%E5%86%99%E3%80%91call%E3%80%81apply%E3%80%81bind/" class="article-date">
  <time class="dt-published" datetime="2025-08-14T03:18:33.968Z" itemprop="datePublished">2025-08-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/js/">js</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/08/14/%E3%80%90%E6%89%8B%E5%86%99%E3%80%91call%E3%80%81apply%E3%80%81bind/">ã€æ‰‹å†™ã€‘callã€applyã€bind</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="call"><a href="#call" class="headerlink" title="call"></a><em>call</em></h2><p>call å¯ä»¥æ”¹å˜è°ƒç”¨å‡½æ•°æ—¶çš„ this æŒ‡å‘ï¼Œå½“è°ƒç”¨ä½†ä»€ä¹ˆéƒ½ä¸ä¼ å…¥æ—¶ï¼Œé»˜è®¤æ˜¯ window å¯¹è±¡</p>
<h3 id="å†…éƒ¨æµç¨‹"><a href="#å†…éƒ¨æµç¨‹" class="headerlink" title="å†…éƒ¨æµç¨‹"></a>å†…éƒ¨æµç¨‹</h3><p><a target="_blank" rel="noopener" href="https://tc39.es/ecma262/multipage/fundamental-objects.html#sec-function.prototype.call">es æ–‡æ¡£</a>ä¸Šç¼–å†™çš„æµç¨‹å¦‚ä¸‹:</p>
<ul>
<li><p>è®©ä¸€ä¸ªå‡½æ•° func æŒ‡å‘ this</p>
</li>
<li><p>å¦‚æœè¿™ä¸ªå‡½æ•° func ä¸èƒ½è¢«è°ƒç”¨ï¼Œé‚£ä¹ˆæŠ›å‡º TypeError</p>
</li>
<li><p>å‡†å¤‡å°¾è°ƒç”¨ PrepareForTailCall</p>
</li>
<li><p>è¿”å›æ‰§è¡Œç»“æœ</p>
</li>
</ul>
<p>æ€è·¯</p>
<ul>
<li><p>åˆ¤æ–­éœ€è¦æ”¹å˜çš„ context æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ºç©ºï¼Œé‚£ä¹ˆå°±é»˜è®¤æŒ‡ä¸º windowã€‚ä¿ç•™è¿™ä¸ªæ–°çš„ contextï¼Œä½œä¸ºåé¢å‡½æ•°è°ƒç”¨æ—¶éœ€è¦çš„ this æŒ‡å‘</p>
</li>
<li><p>å°†å½“å‰çš„ this æŒ‡å‘èµ‹å€¼ç»™ä¸Šä¸€æ­¥ä¿ç•™çš„ contextï¼Œä½œä¸º context çš„ä¸€ä¸ªå±æ€§</p>
</li>
<li><p>è°ƒç”¨ç¬¬ä¸€æ­¥ä¿ç•™çš„ context çš„ç¬¬äºŒæ­¥èµ‹å€¼çš„å±æ€§å‡½æ•°ï¼Œå°†æ‰€éœ€è¦çš„å‚æ•°ä¼ é€’ç»™ä¸Šä¸€æ­¥æ–°èµ‹å€¼çš„å±æ€§</p>
</li>
</ul>
<h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><ul>
<li>call</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">call_handle_writing</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">  <span class="comment">// ctxæŒ‡å‘objï¼Œå› ä¸ºfnä¸ºéç©º</span></span><br><span class="line">  <span class="keyword">const</span> ctx = fn || <span class="variable language_">window</span>;</span><br><span class="line">  <span class="comment">//   ctx.cbæŒ‡å‘çš„æ˜¯fn1</span></span><br><span class="line">  ctx.<span class="property">cb</span> = <span class="variable language_">this</span>;</span><br><span class="line">  <span class="comment">//   è·å–å‚æ•°</span></span><br><span class="line">  <span class="keyword">const</span> args = [...<span class="variable language_">arguments</span>].<span class="title function_">slice</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="comment">//   è°ƒç”¨fn1å‡½æ•°ï¼Œä½†æ˜¯ç”±äºæ˜¯ctxè°ƒç”¨çš„ï¼Œé‚£ä¹ˆfn1è¢«è°ƒç”¨çš„æ—¶å€™çš„thisæŒ‡å‘æ˜¯ctx</span></span><br><span class="line">  <span class="keyword">const</span> res = ctx.<span class="title function_">cb</span>(...args);</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">call_handle_writing</span> = call_handle_writing;</span><br></pre></td></tr></table></figure>

<ul>
<li>ä½¿ç”¨</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fn1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">a</span> = <span class="number">1</span>;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;out&quot;</span>, <span class="variable language_">this</span>, <span class="variable language_">arguments</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">100</span>,</span><br><span class="line">&#125;;</span><br><span class="line">fn1.<span class="title function_">call_handle_writing</span>(obj, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br></pre></td></tr></table></figure>

<h2 id="apply"><a href="#apply" class="headerlink" title="apply"></a>apply</h2><h3 id="å®ç°æµç¨‹"><a href="#å®ç°æµç¨‹" class="headerlink" title="å®ç°æµç¨‹"></a>å®ç°æµç¨‹</h3><blockquote>
<ol>
<li>Let func be the this value.</li>
<li>If IsCallable(func) is false, throw a TypeError exception.</li>
<li>If argArray is either undefined or null, then<blockquote>
<p>a. Perform PrepareForTailCall().<br /><br>b. Return ? <font color=red>Call(func, thisArg).</font></p>
</blockquote>
</li>
<li>Let argList be ? CreateListFromArrayLike(argArray).</li>
<li>Perform PrepareForTailCall().</li>
<li>Return ? Call(func, thisArg, argList).</li>
</ol>
</blockquote>
<p>å…¶å®å°±æ˜¯æ¥å—ä¸€ä¸ªæ•°ç»„ä½œä¸ºå‚æ•°ï¼Œå®é™…æœ€åçš„è°ƒç”¨æ—¶ï¼Œè°ƒç”¨çš„ä¹Ÿæ˜¯ call æ–¹æ³•</p>
<p>apply è°ƒç”¨ call çš„æ—¶å€™ï¼Œä¼šç”¨åˆ°æ‰©å±•è¿ç®—ç¬¦ï¼Œå°†å‚æ•°æ”¾åˆ° call çš„å‚æ•°ä¸­ï¼Œå› æ­¤è¿™åœ¨ä¸€å®šç¨‹åº¦ä¸Šï¼Œå¯¼è‡´äº† apply çš„æ€§èƒ½ä¼šç¨ä½äº call</p>
<h3 id="å…·ä½“å®ç°"><a href="#å…·ä½“å®ç°" class="headerlink" title="å…·ä½“å®ç°"></a>å…·ä½“å®ç°</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">apply_handle_writing</span>(<span class="params">fn, params</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(params)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">call_handle_writing</span>(fn, ...params);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">call_handle_writing</span>(fn);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">apply_handle_writing</span> = apply_handle_writing;</span><br></pre></td></tr></table></figure>

<h2 id="bind"><a href="#bind" class="headerlink" title="bind"></a>bind</h2><h3 id="å†…éƒ¨æµç¨‹-1"><a href="#å†…éƒ¨æµç¨‹-1" class="headerlink" title="å†…éƒ¨æµç¨‹"></a>å†…éƒ¨æµç¨‹</h3><blockquote>
<ol>
<li>Let Target be the this value.</li>
<li>If IsCallable(Target) is false, throw a TypeError exception.</li>
<li>Let F be ? BoundFunctionCreate(Target, thisArg, args).</li>
<li>Let L be 0.</li>
<li>Let targetHasLength be ? HasOwnProperty(Target, â€œlengthâ€).</li>
<li>If targetHasLength is true, then<blockquote>
<p>a. Let targetLen be ? Get(Target, â€œlengthâ€).<br/><br>b. If targetLen is a Number, then<br/></p>
<blockquote>
<p>i. If targetLen is +âˆğ”½, set L to +âˆ.<br/></p>
<blockquote>
<p>ii. Else if targetLen is -âˆğ”½, set L to 0.<br/><br>iii. Else,</p>
</blockquote>
</blockquote>
</blockquote>
</li>
<li>Let targetLenAsInt be ! ToIntegerOrInfinity(targetLen).</li>
<li>Assert: targetLenAsInt is finite.</li>
<li>Let argCount be the number of elements in args.</li>
<li>Set L to max(targetLenAsInt - argCount, 0).</li>
<li>Perform SetFunctionLength(F, L).</li>
<li>Let targetName be ? Get(Target, â€œnameâ€).</li>
<li>If targetName is not a String, set targetName to the empty String.</li>
<li>Perform SetFunctionName(F, targetName, â€œboundâ€).</li>
<li>Return F.</li>
</ol>
</blockquote>
<p>è€ƒè™‘åœºæ™¯ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">A</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">A.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">say</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">B</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"><span class="keyword">const</span> C = A.<span class="title function_">bind</span>(B);</span><br><span class="line"><span class="keyword">const</span> c = <span class="keyword">new</span> <span class="title function_">C</span>();</span><br></pre></td></tr></table></figure>

<ul>
<li><p>è°ƒç”¨ bind åï¼Œä½¿ç”¨<code>new</code>å»åˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œé‚£ä¹ˆåœ¨<code>new</code>çš„æ—¶å€™ä¸åº”è¯¥æ”¹å˜<code>this</code>æŒ‡å‘</p>
<p>åœ¨è¿”å›çš„å‡½æ•°ä¸­ï¼Œç”¨<code>instanceof</code>åˆ¤æ–­æ˜¯å¦æ˜¯é€šè¿‡<code>new</code>æ–¹æ³•è¿›è¡Œè°ƒç”¨çš„</p>
</li>
<li><p>è°ƒç”¨ bind åï¼Œåœ¨ c ä¸Šé¢å¯ä»¥è°ƒç”¨ A ä¸Š <code>prototype</code> çš„æ–¹æ³•</p>
<p>é‡‡ç”¨ç»§æ‰¿çš„æ–¹å¼ï¼Œåœ¨è¿”å›çš„å‡½æ•°ä¸Šï¼Œç»§æ‰¿ A</p>
</li>
</ul>
<h3 id="å…·ä½“å®ç°-1"><a href="#å…·ä½“å®ç°-1" class="headerlink" title="å…·ä½“å®ç°"></a>å…·ä½“å®ç°</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">bind_handle_writing</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> that = <span class="variable language_">this</span>;</span><br><span class="line">  <span class="keyword">const</span> args = [...<span class="variable language_">arguments</span>].<span class="title function_">slice</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">cb</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> params = [...<span class="variable language_">arguments</span>, ...args];</span><br><span class="line">    fn = <span class="variable language_">this</span> <span class="keyword">instanceof</span> cb ? <span class="variable language_">this</span> : fn;</span><br><span class="line">    <span class="keyword">return</span> that.<span class="title function_">call</span>(fn, ...params);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ç”¨ä¸€ä¸ªä¸­é—´å‡½æ•°ï¼Œåœ¨åŸå‹é“¾ä¸ŠåŠ ä¸€å±‚ï¼Œé˜²æ­¢å±æ€§è¦†ç›–</span></span><br><span class="line">  <span class="keyword">const</span> buf = <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;;</span><br><span class="line">  buf.<span class="property"><span class="keyword">prototype</span></span> = <span class="variable language_">this</span>.<span class="property"><span class="keyword">prototype</span></span>;</span><br><span class="line">  cb.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="variable language_">this</span>.<span class="property"><span class="keyword">prototype</span></span>);</span><br><span class="line">  <span class="keyword">return</span> cb;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">bind_handle_writing</span> = bind_handle_writing;</span><br></pre></td></tr></table></figure>

<h3 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h3><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/b540e1e17f54">å¦‚ä½•æ‰‹å†™ä¸€ä¸ª bind æ–¹æ³•</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/08/14/%E3%80%90%E6%89%8B%E5%86%99%E3%80%91call%E3%80%81apply%E3%80%81bind/" data-id="cmebduivb0008pwfmh1sgdmzh" data-title="ã€æ‰‹å†™ã€‘callã€applyã€bind" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-ã€wasbã€‘ç¯å¢ƒæ­å»º" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/08/14/%E3%80%90wasb%E3%80%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" class="article-date">
  <time class="dt-published" datetime="2025-08-14T03:18:33.963Z" itemprop="datePublished">2025-08-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/webAssembly/">webAssembly</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/08/14/%E3%80%90wasb%E3%80%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">ã€wasbã€‘ç¯å¢ƒæ­å»º</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="ã€webAsbã€‘-Emscriptenç¯å¢ƒæ­å»º"><a href="#ã€webAsbã€‘-Emscriptenç¯å¢ƒæ­å»º" class="headerlink" title="ã€webAsbã€‘- Emscriptenç¯å¢ƒæ­å»º"></a>ã€webAsbã€‘- Emscriptenç¯å¢ƒæ­å»º</h1><h2 id="ä¾èµ–ç¯å¢ƒ"><a href="#ä¾èµ–ç¯å¢ƒ" class="headerlink" title="ä¾èµ–ç¯å¢ƒ"></a>ä¾èµ–ç¯å¢ƒ</h2><ul>
<li><p>python</p>
</li>
<li><p>git</p>
</li>
</ul>
<p>è¿™ä¸¤é¡¹ç¯å¢ƒæ˜¯å¿…è¦çš„ï¼Œå¦åˆ™æ— æ³•è¿›è¡Œå®‰è£…</p>
<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><h3 id="ä¸‹è½½é¡¹ç›®"><a href="#ä¸‹è½½é¡¹ç›®" class="headerlink" title="ä¸‹è½½é¡¹ç›®"></a>ä¸‹è½½é¡¹ç›®</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone <span class="attr">https</span>:<span class="comment">//github.com/juj/emsdk.git</span></span><br></pre></td></tr></table></figure>
<p>ä¸‹è½½emscriptené¡¹ç›®</p>
<h3 id="å®‰è£…ä¾èµ–åŒ…ç­‰"><a href="#å®‰è£…ä¾èµ–åŒ…ç­‰" class="headerlink" title="å®‰è£…ä¾èµ–åŒ…ç­‰"></a>å®‰è£…ä¾èµ–åŒ…ç­‰</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd emsdk <span class="comment">// è¿›å…¥é¡¹ç›®ç›®å½•ä¸­</span></span><br><span class="line">emsdk update <span class="comment">// å®‰è£…å„ç§å·¥å…·</span></span><br><span class="line">emsdk install latest <span class="comment">//ä¸‹è½½å„ç§åŒ…ï¼Œæ—¶é—´æ¯”è¾ƒé•¿</span></span><br><span class="line">emsdk activate latest <span class="comment">//ç”Ÿæˆ ~/.emscripten æ–‡ä»¶ï¼Œæ¿€æ´»é…ç½®</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pP6oCWT"><img src="https://s1.ax1x.com/2023/09/09/pP6oCWT.png" alt="pP6oCWT.png"></a></p>
<h3 id="é…ç½®ç¯å¢ƒå˜é‡"><a href="#é…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="é…ç½®ç¯å¢ƒå˜é‡"></a>é…ç½®ç¯å¢ƒå˜é‡</h3><p>å¯ä»¥å…ˆæ‰§è¡Œ<code>emsdk_env</code>è„šæœ¬ï¼Œè¿™ä¸ªè„šæœ¬é»˜è®¤ä¼šå†™å…¥ç¯å¢ƒå˜é‡ï¼Œä½†æ˜¯ä¹Ÿä¼šæœ‰ä¸æˆåŠŸçš„æƒ…å†µã€‚</p>
<p>åœ¨éemsdkç›®å½•ä¸‹æ‰§è¡Œ<code>emcc --version</code>ï¼Œåˆ¤æ–­æ˜¯å¦æŠ¥é”™ï¼Œå¦‚æœæŠ¥é”™ï¼Œå°±è¯æ˜ç¯å¢ƒå¹¶æœªé…ç½®æˆåŠŸï¼›å¦‚æœæœªæŠ¥é”™ï¼Œé‚£ä¹ˆç¯å¢ƒå·²ç»é…ç½®å®Œæˆå•¦</p>
<h4 id="ç¯å¢ƒæœªé…ç½®æˆåŠŸ"><a href="#ç¯å¢ƒæœªé…ç½®æˆåŠŸ" class="headerlink" title="ç¯å¢ƒæœªé…ç½®æˆåŠŸ"></a>ç¯å¢ƒæœªé…ç½®æˆåŠŸ</h4><ul>
<li><p>æ‰§è¡Œ <code>emcmdprompt.bat</code>å‘½ä»¤</p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pP6xUSA"><img src="https://s1.ax1x.com/2023/09/09/pP6xUSA.png" alt="pP6xUSA.png"></a></p>
</li>
<li><p>å°†å¸¦æœ‰<code>PATH +=</code>çš„è·¯å¾„å†™å…¥ç¯å¢ƒå˜é‡çš„Pathä¸­</p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pP6zKhQ"><img src="https://s1.ax1x.com/2023/09/09/pP6zKhQ.png" alt="pP6zKhQ.png"></a></p>
</li>
<li><p>å°†ä¸‹é¢å¸¦æœ‰é”®å€¼å¯¹çš„å†™å…¥ç³»ç»Ÿå˜é‡ä¸­</p>
<p>è®°ä½ä¸èƒ½æœ‰ç©ºæ ¼ï¼Œå¦åˆ™ä¼šæ‰§è¡Œä¸æˆåŠŸ</p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pP6z1cn"><img src="https://s1.ax1x.com/2023/09/09/pP6z1cn.png" alt="pP6z1cn.png"></a></p>
</li>
<li><p>åœ¨é<code>emsdk</code>ç›®å½•ä¸‹æ‰§è¡Œ<code>emcc --version</code></p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pP6zJBV"><img src="https://s1.ax1x.com/2023/09/09/pP6zJBV.png" alt="pP6zJBV.png"></a></p>
<p>ç¯å¢ƒé…ç½®æˆåŠŸ</p>
</li>
</ul>
<h2 id="é…ç½®c-ç¯å¢ƒ"><a href="#é…ç½®c-ç¯å¢ƒ" class="headerlink" title="é…ç½®c++ç¯å¢ƒ"></a>é…ç½®c++ç¯å¢ƒ</h2><h3 id="å®‰è£…é…ç½®c-c"><a href="#å®‰è£…é…ç½®c-c" class="headerlink" title="å®‰è£…é…ç½®c&#x2F;c++"></a>å®‰è£…é…ç½®c&#x2F;c++</h3><ul>
<li><p>å®‰è£…</p>
<p>å®‰è£…c&#x2F;c++ç¼–è¯‘å™¨ï¼š<a target="_blank" rel="noopener" href="https://sourceforge.net/projects/mingw-w64/">https://sourceforge.net/projects/mingw-w64/</a></p>
</li>
<li><p>é…ç½®</p>
<p>åœ¨ç¯å¢ƒå˜é‡çš„Pathä¸­ï¼ŒæŠŠè§£å‹çš„mingwçš„binç›®å½•åŠ å…¥è¿›å»</p>
</li>
</ul>
<h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p>åœ¨cmdè¾“å…¥<code>gcc -v</code>ï¼Œæ²¡æœ‰æŠ¥é”™å³å¯</p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pPIgD91"><img src="https://z1.ax1x.com/2023/09/21/pPIgD91.png" alt="pPIgD91.png"></a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43180456/article/details/126374156">å‚é“¾</a></p>
<h2 id="æµ‹è¯•-1"><a href="#æµ‹è¯•-1" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><h3 id="ç¼–å†™æµ‹è¯•ç¨‹åº"><a href="#ç¼–å†™æµ‹è¯•ç¨‹åº" class="headerlink" title="ç¼–å†™æµ‹è¯•ç¨‹åº"></a>ç¼–å†™æµ‹è¯•ç¨‹åº</h3><p>å»ºç«‹ä¸€ä¸ªcppæ–‡ä»¶ï¼Œå†™å…¥cçš„ä»£ç </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Hello, world!&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ç”Ÿæˆjsä»£ç "><a href="#ç”Ÿæˆjsä»£ç " class="headerlink" title="ç”Ÿæˆjsä»£ç "></a>ç”Ÿæˆjsä»£ç </h3><blockquote>
<p><code>emcc test.cpp -o test.html</code></p>
</blockquote>
<p>ä¼šç”Ÿæˆ<code>html</code>ï¼Œ<code>js</code>å’Œ<code>wasm</code>æ–‡ä»¶ï¼Œhtmlé»˜è®¤å¼•å…¥jsæ–‡ä»¶ï¼Œjsçš„ä½œç”¨æ˜¯å¼•å…¥wasmæ–‡ä»¶</p>
<ul>
<li><p><code>-s</code> è¡¨æ˜ç¼–è¯‘åˆ° Wasmï¼Œå¦åˆ™ç¼–è¯‘åˆ° Asm.jsï¼ˆWasm çš„å‰èº«ï¼‰ï¼Œ æœ€åˆ emscripten æ˜¯ç”¨äºç¼–è¯‘åˆ° Asm.js çš„ã€‚</p>
</li>
<li><p><code>SIDE_MODULE</code> è¡¨æ˜ç¼–è¯‘ä¸ºå‰¯æ¨¡å—ã€‚æœ‰å‰¯æ¨¡å—å°±æœ‰ä¸»æ¨¡å—ï¼Œç®€å•ç†è§£å‰¯æ¨¡å—ä¼šå»é™¤ C æ ‡å‡†åº“å‡½æ•°ï¼Œå› ä¸ºå‰¯æ¨¡å—ä¼šåœ¨è¿è¡Œæ—¶è¢«é“¾æ¥åˆ°ä¸€ä¸ªä¸»æ¨¡å—ï¼Œè€Œä¸»æ¨¡å—æœ‰Cæ ‡å‡†åº“å‡½æ•°ã€‚SIDE_MODULEçš„å€¼å¯é€‰ 1 æˆ–è€… 2ï¼Œå‰è€…ä¼šè‡ªåŠ¨å¯¼å‡ºä»£ç é‡Œæ‰€æœ‰çš„å‡½æ•°ï¼Œè€Œåè€…éœ€è¦æ‰‹åŠ¨å£°æ˜ã€‚</p>
</li>
<li><p><code>-o</code> xxxx å¯¼å‡ºé€‰é¡¹ï¼Œå¯¼å‡ºçš„æ–‡ä»¶å¯é€‰ .htmlã€.jsã€.wasmï¼ŒåŒºåˆ«åœ¨äºå‰é¢ä¸¤è€…ä¼šå¸®ä½ æŠŠèƒ¶æ°´ä»£ç å†™å¥½ ï¼Œè€Œ .wasm åˆ™éœ€è¦åœ¨ JS è‡ªå·±ç¼–å†™èƒ¶æ°´ä»£ç äº†ï¼Œä½†æ˜¯å‰é¢ä¸¤è€…ä»£ç å†—ä½™ï¼Œæ¯”å¦‚ç¼–è¯‘ä¸º JS æ–‡ä»¶æ—¶ï¼ŒJS æ–‡ä»¶ä¼šåŒ…å«ä¸¤åƒå¤šè¡Œä»£ç ï¼Œä¸è¿‡è¿™æ˜¯å­¦ä¹  Wasm çš„ç°æˆå®ä¾‹ã€‚</p>
</li>
</ul>
<h3 id="æ­å»ºæœ¬åœ°æœåŠ¡å™¨"><a href="#æ­å»ºæœ¬åœ°æœåŠ¡å™¨" class="headerlink" title="æ­å»ºæœ¬åœ°æœåŠ¡å™¨"></a>æ­å»ºæœ¬åœ°æœåŠ¡å™¨</h3><p>åœ¨ä»£ç è·¯å¾„ä¸­ï¼Œæ­å»ºæœ¬åœ°æœåŠ¡ã€‚åœ¨æµè§ˆå™¨è®¿é—®æœ¬åœ°çš„æ–‡ä»¶ä¼šæŠ¥é”™</p>
<ul>
<li><p><code>pnpm init</code></p>
<p>åˆ›å»ºpackage.jsonæ–‡ä»¶</p>
</li>
<li><p><code>pnpm i http-server</code></p>
<p>å®‰è£…<code>http-server</code></p>
</li>
<li><p><code>http-server -o</code></p>
<p>èµ·æœ¬åœ°æœåŠ¡ï¼Œåœ¨æµè§ˆå™¨æ‰“å¼€htmlæ–‡ä»¶</p>
</li>
</ul>
<h3 id="éªŒæ”¶"><a href="#éªŒæ”¶" class="headerlink" title="éªŒæ”¶"></a>éªŒæ”¶</h3><p>ç”¨<code>http-server</code>èµ·äº†æœ¬åœ°æœåŠ¡åï¼Œåœ¨æµè§ˆå™¨è®¿é—®å¯¹åº”çš„åŸŸååŠ ä¸Šç”Ÿæˆçš„htmlæ–‡ä»¶ï¼Œæ­£å¸¸è¿è¡Œé¡¹ç›®</p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pPIfE5Q"><img src="https://z1.ax1x.com/2023/09/21/pPIfE5Q.png" alt="pPIfE5Q.png"></a></p>
<h2 id="å‚é“¾"><a href="#å‚é“¾" class="headerlink" title="å‚é“¾"></a>å‚é“¾</h2><p><a target="_blank" rel="noopener" href="http://www.taodudu.cc/news/show-5750307.html?action=onClick">Emscriptenç¼–è¯‘å™¨å®‰è£…æ•™ç¨‹ï¼Œäº²æµ‹æˆåŠŸç¼–è¯‘å‡ºç¬¬ä¸€ä¸ªWebAssembly</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/08/14/%E3%80%90wasb%E3%80%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" data-id="cmebduiv50003pwfmdpv2b88q" data-title="ã€wasbã€‘ç¯å¢ƒæ­å»º" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-ã€RNã€‘ç¯å¢ƒæ­å»º" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/08/14/%E3%80%90RN%E3%80%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" class="article-date">
  <time class="dt-published" datetime="2025-08-14T03:18:33.959Z" itemprop="datePublished">2025-08-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/React-Native/">React Native</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/08/14/%E3%80%90RN%E3%80%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">ã€RNã€‘ç¯å¢ƒæ­å»º</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="ã€React-Nativeã€‘ç¯å¢ƒæ­å»º"><a href="#ã€React-Nativeã€‘ç¯å¢ƒæ­å»º" class="headerlink" title="ã€React Nativeã€‘ç¯å¢ƒæ­å»º"></a>ã€React Nativeã€‘ç¯å¢ƒæ­å»º</h1><h2 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h2><ul>
<li><p>Nodejs: <code>v16.16.0</code></p>
</li>
<li><p>react-native: <code>0.72.3</code></p>
</li>
<li><p>react-native-cli: <code>2.0.13</code></p>
</li>
<li><p>webStorm: <code>2023.1.2</code></p>
</li>
<li><p>Android Studio: <code>2022.2.1.20</code></p>
</li>
</ul>
<h2 id="åŸºæœ¬ç¯å¢ƒé…ç½®"><a href="#åŸºæœ¬ç¯å¢ƒé…ç½®" class="headerlink" title="åŸºæœ¬ç¯å¢ƒé…ç½®"></a>åŸºæœ¬ç¯å¢ƒé…ç½®</h2><h3 id="å®‰è£…nodejs"><a href="#å®‰è£…nodejs" class="headerlink" title="å®‰è£…nodejs"></a>å®‰è£…nodejs</h3><p><a target="_blank" rel="noopener" href="https://nodejs.p2hp.com/">Node.Jsä¸­æ–‡ç½‘</a></p>
<h3 id="å®‰è£…react-nativeåŠå…¶è„šæ‰‹æ¶"><a href="#å®‰è£…react-nativeåŠå…¶è„šæ‰‹æ¶" class="headerlink" title="å®‰è£…react-nativeåŠå…¶è„šæ‰‹æ¶"></a>å®‰è£…react-nativeåŠå…¶è„šæ‰‹æ¶</h3><blockquote>
<p>npm i -g react-native react-native-cli</p>
</blockquote>
<h3 id="å®‰è£…Android-Studio"><a href="#å®‰è£…Android-Studio" class="headerlink" title="å®‰è£…Android Studio"></a>å®‰è£…Android Studio</h3><p>è¿™ä¸ªæ˜¯é…ç½®å®‰å“ç¯å¢ƒçš„ï¼Œéœ€è¦é…ç½®å¥½åï¼Œæ‰èƒ½è¿è¡ŒæˆåŠŸã€‚</p>
<p><a target="_blank" rel="noopener" href="https://developer.android.google.cn/studio/">å®˜ç½‘ä¸‹è½½</a></p>
<p><a target="_blank" rel="noopener" href="https://reactnative.cn/docs/environment-setup">å®‰è£…æµç¨‹</a></p>
<ul>
<li><p>å¿…é¡»å®‰è£…çš„SDKï¼š</p>
<ul>
<li><code>Android SDK</code></li>
<li><code>Android SDK Platform</code></li>
<li><code>Android Virtual Device</code></li>
</ul>
</li>
</ul>
<p>å®‰è£…è¿‡ç¨‹ç”±äºä¸‹è½½å†…å®¹è¾ƒå¤šï¼Œå› æ­¤å®‰è£…è¿‡ç¨‹è¾ƒæ…¢ã€‚</p>
<ul>
<li><p>å®‰è£…åï¼Œéœ€è¦é¢å¤–å®‰è£…çš„SDK</p>
<ul>
<li><p><code>Android SDK Platform 33</code></p>
</li>
<li><p><code>Intel x86 Atom_64 System Image</code></p>
</li>
<li><p><code>Android SDK Build-Tools 33.0.0</code></p>
</li>
</ul>
<p>  ä»è®¾ç½®æŒ‰é’®-ã€‹settings-ã€‹Appearance &amp; Behavior -ã€‹ System Settings -ã€‹ Android SDK<br>  <a target="_blank" rel="noopener" href="https://imgse.com/i/pCbGec8"><img src="https://s1.ax1x.com/2023/07/21/pCbGec8.png" alt="pCbGec8.png"></a></p>
<p>  <a target="_blank" rel="noopener" href="https://imgse.com/i/pCb8Xfx"><img src="https://s1.ax1x.com/2023/07/21/pCb8Xfx.png" alt="pCb8Xfx.png"></a></p>
<p>  <a target="_blank" rel="noopener" href="https://imgse.com/i/pCbGJ3V"><img src="https://s1.ax1x.com/2023/07/21/pCbGJ3V.png" alt="pCbGJ3V.png"></a></p>
</li>
<li><p>é…ç½®è·¯å¾„</p>
<p>  åœ¨ç¯å¢ƒå˜é‡ä¸­è®¾ç½®ä»¥ä¸‹è·¯å¾„ï¼š</p>
<blockquote>
<p><code>ANDROID_HOME</code>: <code>ä¸Šä¸ªæ­¥éª¤ä¸­tabä¸­çš„Android SDK Location</code></p>
</blockquote>
<p>  åœ¨<code>Path</code>çš„ç¯å¢ƒå˜é‡ä¸­ï¼Œæ·»åŠ å¦‚ä¸‹æ–‡æ¡ˆï¼š</p>
<ul>
<li><code>%ANDROID_HOME%\platform-tools</code></li>
<li><code>%ANDROID_HOME%\emulator</code></li>
<li><code>%ANDROID_HOME%\tools</code></li>
<li><code>%ANDROID_HOME%\tools\bin</code></li>
</ul>
<p>  è®¾ç½®å®Œæˆåï¼Œç‚¹å‡»åº”ç”¨å³å¯</p>
</li>
</ul>
<h3 id="å®‰è£…webStorm"><a href="#å®‰è£…webStorm" class="headerlink" title="å®‰è£…webStorm"></a>å®‰è£…webStorm</h3><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/read/cv24375178/">å®‰è£…æ•™ç¨‹</a></p>
<p>æ³¨ï¼šå¦‚æœç ´è§£çš„codeä¸ç”Ÿæ•ˆï¼Œå¯ä»¥é‡å¯ç”µè„‘ç„¶åå†å¡«å…¥å¯¹åº”çš„code</p>
<h2 id="æ–°å»ºé¡¹ç›®"><a href="#æ–°å»ºé¡¹ç›®" class="headerlink" title="æ–°å»ºé¡¹ç›®"></a>æ–°å»ºé¡¹ç›®</h2><ul>
<li><p>åœ¨webStormæ–°å»ºä¸€ä¸ªReact Nativeé¡¹ç›®</p>
<p>  <a target="_blank" rel="noopener" href="https://imgse.com/i/pCbJkb4"><img src="https://s1.ax1x.com/2023/07/21/pCbJkb4.png" alt="pCbJkb4.png"></a></p>
</li>
<li><p>åˆ›å»ºé¡¹ç›®çš„æ–‡ä»¶ç›®å½•</p>
<p>  <a target="_blank" rel="noopener" href="https://imgse.com/i/pCbJ1qe"><img src="https://s1.ax1x.com/2023/07/21/pCbJ1qe.png" alt="pCbJ1qe.png"></a></p>
</li>
<li><p>å³ä¸Šè§’çš„å‘½ä»¤çš„editï¼Œè¿›å…¥å‘½ä»¤çš„ç¼–è¾‘é¡µé¢</p>
<p>  <a target="_blank" rel="noopener" href="https://imgse.com/i/pCbJ4LF"><img src="https://s1.ax1x.com/2023/07/21/pCbJ4LF.png" alt="pCbJ4LF.png"></a></p>
<p>  <a target="_blank" rel="noopener" href="https://imgse.com/i/pCbJodJ"><img src="https://s1.ax1x.com/2023/07/21/pCbJodJ.png" alt="pCbJodJ.png"></a></p>
</li>
<li><p>åœ¨Before launchçš„æ ‡ç­¾æ ï¼Œç‚¹å‡»+ï¼Œé€‰æ‹©<code>Run External Tool</code>ï¼Œé€‰æ‹©+</p>
<p>  <a target="_blank" rel="noopener" href="https://imgse.com/i/pCbwt0K"><img src="https://s1.ax1x.com/2023/07/21/pCbwt0K.png" alt="pCbwt0K.png"></a></p>
<p>  <a target="_blank" rel="noopener" href="https://imgse.com/i/pCbwwfH"><img src="https://s1.ax1x.com/2023/07/21/pCbwwfH.png" alt="pCbwwfH.png"></a></p>
</li>
<li><p>å¡«å†™ç›¸å…³ä¿¡æ¯</p>
<p>  Nameä¸ºè¯¥æŒ‰é’®çš„åå­—</p>
<p>  Programä¸ºreact Nativeçš„è·¯å¾„ï¼Œwinç»ˆç«¯å‘½ä»¤:where react-native </p>
<p>  working directoryï¼šè¯¥è¾“å…¥æ¡†ä¸­,å…ˆç‚¹å‡»å³è¾¹çš„insert macro,é€‰æ‹©ProjectFileDir.</p>
<p>  <a target="_blank" rel="noopener" href="https://imgse.com/i/pCb0mjI"><img src="https://s1.ax1x.com/2023/07/21/pCb0mjI.png" alt="pCb0mjI.png"></a></p>
<p>  å¡«å†™å†…å®¹ï¼š</p>
<p>  <a target="_blank" rel="noopener" href="https://imgse.com/i/pCb0KDP"><img src="https://s1.ax1x.com/2023/07/21/pCb0KDP.png" alt="pCb0KDP.png"></a></p>
</li>
<li><p>ä¿å­˜ä»¥ä¸Šæ“ä½œï¼Œç„¶åæ‰§è¡Œåˆšåˆšé…ç½®å¥½çš„å‘½ä»¤</p>
<p>  <a target="_blank" rel="noopener" href="https://imgse.com/i/pCb0D5F"><img src="https://s1.ax1x.com/2023/07/21/pCb0D5F.png" alt="pCb0D5F.png"></a></p>
</li>
</ul>
<h2 id="å‚é“¾"><a href="#å‚é“¾" class="headerlink" title="å‚é“¾"></a>å‚é“¾</h2><ul>
<li><p><a target="_blank" rel="noopener" href="https://reactnative.cn/docs/environment-setup">æ­å»ºå¼€å‘ç¯å¢ƒ</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/read/cv24375178/">webstormç ´è§£æ¿€æ´»2023æœ€æ–°æ°¸ä¹…æ•™ç¨‹ã€Œäº²æµ‹æœ‰æ•ˆã€</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/sinat_36279113/article/details/100576426">WebStormé‡Œé…ç½®è¿è¡ŒReact Native</a></p>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/08/14/%E3%80%90RN%E3%80%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" data-id="cmebduiv90006pwfmf67124ip" data-title="ã€RNã€‘ç¯å¢ƒæ­å»º" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-ã€ASTã€‘-è§£æattrs" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/08/14/%E3%80%90AST%E3%80%91-%E8%A7%A3%E6%9E%90attrs/" class="article-date">
  <time class="dt-published" datetime="2025-08-14T03:18:33.953Z" itemprop="datePublished">2025-08-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/vue/">vue</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/08/14/%E3%80%90AST%E3%80%91-%E8%A7%A3%E6%9E%90attrs/">è§£æ attrs</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="ã€ASTã€‘-è§£æ-attrs"><a href="#ã€ASTã€‘-è§£æ-attrs" class="headerlink" title="ã€ASTã€‘-è§£æ attrs"></a>ã€ASTã€‘-è§£æ attrs</h1><h2 id="è€ƒè™‘æƒ…å†µ"><a href="#è€ƒè™‘æƒ…å†µ" class="headerlink" title="è€ƒè™‘æƒ…å†µ"></a>è€ƒè™‘æƒ…å†µ</h2><ul>
<li>æ™®é€šæƒ…å†µ</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span>=<span class="string">&quot;a&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>ç©ºæ ¼æƒ…å†µ</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span>=<span class="string">&quot;a b c&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>æ— å¼•å·æƒ…å†µ</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data = <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>æ— èµ‹å€¼æƒ…å†µ</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data - a;</span><br></pre></td></tr></table></figure>

<h2 id="æ–¹æ¡ˆ"><a href="#æ–¹æ¡ˆ" class="headerlink" title="æ–¹æ¡ˆ"></a>æ–¹æ¡ˆ</h2><h3 id="å‰æƒ…"><a href="#å‰æƒ…" class="headerlink" title="å‰æƒ…"></a>å‰æƒ…</h3><p>1ã€attrs ä½œä¸ºä¸€æ•´ä¸²å­—ç¬¦ä¸²ä¼ å…¥ï¼Œå› ä¸ºç¬¬äºŒç§(ç©ºæ ¼)æƒ…å†µçš„å­˜åœ¨ï¼Œä¸èƒ½é€šè¿‡ç©ºæ ¼è¿›è¡Œæ•°ç»„åˆ†å‰²</p>
<p>2ã€å­˜åœ¨ç¬¬äºŒç§(æ— å¼•å·)çš„æƒ…å†µï¼Œä¸èƒ½å®Œå…¨é€šè¿‡å¼•å·ä½œä¸ºæ ‡å¿—ä½è¿›è¡Œåˆ†å‰²</p>
<h3 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h3><ul>
<li><p>ä»¥å¼•å·å’Œç­‰äºåŒæ—¶ä½œä¸ºæ ‡å¿—ä½ï¼Œå¯¹å­—ç¬¦ä¸²è¿›è¡Œåˆ‡åˆ†ã€‚å¼•å·ä¸ºç¬¬ä¸€å‡†åˆ™ï¼Œç­‰å·ä¸ºé™„ç”¨</p>
</li>
<li><p>åœ¨åˆ‡åˆ† key ä¸ value æ—¶ï¼Œä»¥ç­‰å·ä½œä¸ºåˆ†å‰²ç¬¦ï¼Œä½†è¿˜éœ€è¦æ£€æŸ¥ key ä¸­æ˜¯å¦å­˜åœ¨ç©ºæ ¼ï¼Œå¦‚æœæœ‰ç©ºæ ¼ï¼Œåˆ™è¡¨ç¤ºå­˜åœ¨ç¬¬å››ç§(æ— èµ‹å€¼æƒ…å†µ)æƒ…å†µ</p>
</li>
</ul>
<h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getKeyValue</span>(<span class="params">strs</span>) &#123;</span><br><span class="line">  <span class="comment">// å­˜æ”¾key-value/attrå­—ç¬¦çš„æ•°ç»„</span></span><br><span class="line">  <span class="keyword">let</span> res = [];</span><br><span class="line">  <span class="comment">// æ˜¯å¦æ˜¯æœ‰åŒå¼•å·çš„æ ‡å¿—ä½</span></span><br><span class="line">  <span class="keyword">let</span> is_start = <span class="literal">false</span>;</span><br><span class="line">  <span class="comment">// æ˜¯å¦æ˜¯æœ‰ç­‰å·çš„æ ‡å¿—ä½</span></span><br><span class="line">  <span class="keyword">let</span> is_equal = <span class="literal">false</span>;</span><br><span class="line">  <span class="comment">// å­˜æ”¾æ¯ä¸ªkey-valueçš„å­—ç¬¦</span></span><br><span class="line">  <span class="keyword">let</span> str = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="comment">// éå†æ•´ä¸ªattrså­—ç¬¦ä¸²</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; strs.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    str += strs[i];</span><br><span class="line">    <span class="comment">// å¦‚æœå½“å‰çš„å­—ç¬¦æ˜¯å¼•å·ï¼Œé‚£ä¹ˆè¡¨ç¤ºä¸€ä¸ªattrå€¼çš„å¼€å§‹æˆ–è€…ç»“æŸï¼Œclass=&quot;(å¼€å§‹)a&quot;(ç»“æŸ)</span></span><br><span class="line">    <span class="keyword">if</span> (strs[i] === <span class="string">`&quot;`</span>) &#123;</span><br><span class="line">      <span class="comment">// å¦‚æœä¹‹å‰å·²ç»å‡ºç°äº†å¼•å·ï¼Œé‚£ä¹ˆè¡¨ç¤ºè¿™ä¸ªå¼•å·æ˜¯attrçš„ç»“æŸä½ï¼Œclass=&quot;a&quot;(ç»“æŸ)</span></span><br><span class="line">      <span class="keyword">if</span> (is_start) &#123;</span><br><span class="line">        <span class="comment">// é‚£ä¹ˆå°±éœ€è¦å°†å½“å‰æ”¶é›†çš„å­—ç¬¦å­˜åˆ°attrçš„æ•°ç»„ä¸­</span></span><br><span class="line">        str = str.<span class="title function_">replaceAll</span>(<span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">        res.<span class="title function_">push</span>(str);</span><br><span class="line">        <span class="comment">// éœ€è¦é‡æ–°æ”¶é›†ï¼Œé‚£ä¹ˆä¸€åˆ‡å›åˆ°åˆå§‹</span></span><br><span class="line">        is_start = <span class="literal">false</span>;</span><br><span class="line">        is_equal = <span class="literal">false</span>;</span><br><span class="line">        str = <span class="string">&quot;&quot;</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœä¹‹å‰æ²¡æœ‰å¼•å·ï¼Œé‚£ä¹ˆè¡¨ç¤ºè¿™ä¸ªå¼•å·æ˜¯attrå€¼çš„å¼€å§‹ä½ï¼Œclass=&quot;(å¼€å§‹)a&quot;</span></span><br><span class="line">        is_start = <span class="literal">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¦‚æœæœ‰=ï¼Œä½†æ˜¯æ²¡æœ‰&quot;è¡¨ç¤ºå¼€å§‹ï¼Œé‚£ä¹ˆå°±è¡¨ç¤ºæ˜¯x=1çš„å½¢å¼</span></span><br><span class="line">    <span class="keyword">if</span> (strs[i] === <span class="string">&quot;=&quot;</span> &amp;&amp; !is_start) &#123;</span><br><span class="line">      is_equal = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¦‚æœå½“æ—¶æ˜¯ç©ºæ ¼ï¼Œå¹¶ä¸”æ˜¯å‡ºç°è¿‡ç­‰å·ä¸”æ²¡æœ‰å‡ºç°è¿‡å¼•å·ï¼Œé‚£ä¹ˆè¡¨ç¤ºæ˜¯data=1çš„æƒ…å†µ</span></span><br><span class="line">    <span class="keyword">if</span> (strs[i] === <span class="string">&quot; &quot;</span> &amp;&amp; is_equal &amp;&amp; !is_start) &#123;</span><br><span class="line">      <span class="comment">// é‚£ä¹ˆå°±éœ€è¦å°†å½“å‰æ”¶é›†çš„å­—ç¬¦å­˜åˆ°attrçš„æ•°ç»„ä¸­</span></span><br><span class="line">      res.<span class="title function_">push</span>(str);</span><br><span class="line">      <span class="comment">// éœ€è¦é‡æ–°æ”¶é›†ï¼Œé‚£ä¹ˆä¸€åˆ‡å›åˆ°åˆå§‹</span></span><br><span class="line">      is_start = <span class="literal">false</span>;</span><br><span class="line">      is_equal = <span class="literal">false</span>;</span><br><span class="line">      str = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// æ•°æ®å·²ç»éå†å®Œæˆï¼Œä½†æ˜¯strè¿˜æ²¡æœ‰ç»“æŸ</span></span><br><span class="line">  <span class="keyword">if</span> (str) &#123;</span><br><span class="line">    res.<span class="title function_">push</span>(str);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> data = res.<span class="title function_">reduce</span>(<span class="function">(<span class="params">pre, cur</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// é€šè¿‡ç­‰å·å°†attrçš„stråˆ†éš”å¼€</span></span><br><span class="line">    <span class="keyword">let</span> [key, val = <span class="string">&quot;&quot;</span>] = cur.<span class="title function_">split</span>(<span class="string">&quot;=&quot;</span>);</span><br><span class="line">    <span class="comment">// å»æ‰keyçš„å·¦å³ç©ºæ ¼</span></span><br><span class="line">    key = key.<span class="title function_">trim</span>();</span><br><span class="line">    <span class="comment">// å¦‚æœkeyè¿˜å­˜åœ¨ç©ºæ ¼ï¼Œé‚£ä¹ˆå°±è¡¨ç¤ºæ˜¯data-b data=1çš„æƒ…å†µ</span></span><br><span class="line">    <span class="keyword">if</span> (key.<span class="title function_">includes</span>(<span class="string">&quot; &quot;</span>)) &#123;</span><br><span class="line">      <span class="comment">// éœ€è¦å°†keyä»¥ç©ºæ ¼åˆ†å‰²å¼€</span></span><br><span class="line">      <span class="keyword">const</span> keys = key.<span class="title function_">split</span>(<span class="string">&quot; &quot;</span>);</span><br><span class="line">      <span class="comment">// å°†åœ¨æœ€åä¸€ä¸ªkeyä¹‹å‰çš„keyéƒ½æ”¾å…¥attrsæ•°ç»„é‡Œé¢</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; keys.<span class="property">length</span> - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        pre.<span class="title function_">push</span>(&#123; <span class="attr">key</span>: keys[i].<span class="title function_">trim</span>(), <span class="attr">val</span>: <span class="string">&quot;&quot;</span> &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// æœ€åä¸€ä¸ªkeyä½œä¸ºå¯¹äºçš„valueå€¼</span></span><br><span class="line">      key = keys[keys.<span class="property">length</span> - <span class="number">1</span>].<span class="title function_">trim</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// åœ¨attrsé‡Œé¢æ·»åŠ attrçš„keyåŠvalue</span></span><br><span class="line">    pre.<span class="title function_">push</span>(&#123; <span class="attr">key</span>: key.<span class="title function_">trim</span>(), <span class="attr">val</span>: val.<span class="title function_">trim</span>() &#125;);</span><br><span class="line">    <span class="keyword">return</span> pre;</span><br><span class="line">  &#125;, []);</span><br><span class="line">  <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">getKeyValue</span>( <span class="string">` class=&quot;a b  c &quot;   id=&quot;d &quot; data-b data-c data=1   data-a=&quot;111&quot; data-d`</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å‡º</span></span><br><span class="line"><span class="comment">// res(keyvalue)æ•°ç»„ï¼š</span></span><br><span class="line">Â [<span class="string">&#x27; class=a b  c &#x27;</span>, <span class="string">&#x27;   id=d &#x27;</span>, <span class="string">&#x27; data-b data-c data=1 &#x27;</span>, <span class="string">&#x27;  data-a=111&#x27;</span>, <span class="string">&#x27; data-d&#x27;</span>]</span><br><span class="line"><span class="comment">// dataç»“æœï¼š</span></span><br><span class="line">[</span><br><span class="line">    &#123;<span class="attr">key</span>: <span class="string">&#x27;class&#x27;</span>, <span class="attr">val</span>: <span class="string">&#x27;a b  c&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">key</span>: <span class="string">&#x27;id&#x27;</span>, <span class="attr">val</span>: <span class="string">&#x27;d&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">key</span>: <span class="string">&#x27;data-b&#x27;</span>, <span class="attr">val</span>: <span class="string">&#x27;&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">key</span>: <span class="string">&#x27;data-c&#x27;</span>, <span class="attr">val</span>: <span class="string">&#x27;&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">key</span>: <span class="string">&#x27;data&#x27;</span>, <span class="attr">val</span>: <span class="string">&#x27;1&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">key</span>: <span class="string">&#x27;data-a&#x27;</span>, <span class="attr">val</span>: <span class="string">&#x27;111&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">key</span>: <span class="string">&#x27;data-d&#x27;</span>, <span class="attr">val</span>: <span class="string">&#x27;&#x27;</span>&#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/08/14/%E3%80%90AST%E3%80%91-%E8%A7%A3%E6%9E%90attrs/" data-id="cmebduiv30002pwfm8u6tgc0b" data-title="è§£æ attrs" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vue/" rel="tag">vue</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-æºç /ã€æºç ã€‘vuex-æ‰§è¡Œå‡½æ•°" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/08/14/%E6%BA%90%E7%A0%81/%E3%80%90%E6%BA%90%E7%A0%81%E3%80%91vuex-%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0/" class="article-date">
  <time class="dt-published" datetime="2025-08-14T03:18:33.949Z" itemprop="datePublished">2025-08-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/vuex-%E6%BA%90%E7%A0%81/">vuex æºç </a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/08/14/%E6%BA%90%E7%A0%81/%E3%80%90%E6%BA%90%E7%A0%81%E3%80%91vuex-%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0/">vuex-æ‰§è¡Œå‡½æ•°</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="dispatch"><a href="#dispatch" class="headerlink" title="dispatch"></a>dispatch</h2><p>vuex ä¸­æœ‰ä¸‰ä¸ªå…³äº dispatch å›è°ƒçš„æ–¹æ³•ï¼š</p>
<ul>
<li><p>è¿›è¡Œåˆå§‹åŒ–æ—¶ Store ä¸­å¯¹ dispatch çš„é‡æ–°èµ‹å€¼</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">dispatch</span> = <span class="keyword">function</span> <span class="title function_">boundDispatch</span>(<span class="params">type, payload</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>, ref, <span class="variable language_">this</span> == ref);</span><br><span class="line">  <span class="keyword">return</span> dispatch.<span class="title function_">call</span>(store, type, payload);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Store çš„ prototypeï¼›</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Store</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">dispatch</span> = <span class="keyword">function</span> <span class="title function_">dispatch</span>(<span class="params">_type, _payload</span>) &#123;&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨èµ°åˆå§‹åŒ–æ—¶ï¼Œæ³¨å†Œæ¯ä¸ª action</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">registerAction</span>(<span class="params">store, type, handler, local</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> entry = store.<span class="property">_actions</span>[type] || (store.<span class="property">_actions</span>[type] = []);</span><br><span class="line">  entry.<span class="title function_">push</span>(<span class="keyword">function</span> <span class="title function_">wrappedActionHandler</span>(<span class="params">payload</span>) &#123;&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆå½“åœ¨é¡¹ç›®ä¸­è°ƒç”¨ dispatch æ—¶ï¼Œè°ƒç”¨é¡ºåºæ˜¯ä¾æ¬¡è°ƒç”¨çš„ï¼Œå®é™…è°ƒç”¨é¡¹ç›®çš„ action å‡½æ•°ï¼Œä¹Ÿæ˜¯åœ¨ registerAction ä¸­è¿›è¡Œè°ƒç”¨çš„ã€‚å¹³æ—¶å†™ action å‡½æ•°æ—¶çš„ rootï¼Œå°±æ˜¯åœ¨ registerAction çš„å‡½æ•°ä¸­è¿›è¡Œèµ‹å€¼çš„</p>
</li>
</ul>
<h3 id="Store-é‡æ–°èµ‹å€¼"><a href="#Store-é‡æ–°èµ‹å€¼" class="headerlink" title="Store é‡æ–°èµ‹å€¼"></a>Store é‡æ–°èµ‹å€¼</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> store = <span class="variable language_">this</span>;</span><br><span class="line"><span class="keyword">var</span> ref = <span class="variable language_">this</span>;</span><br><span class="line"><span class="keyword">var</span> dispatch = ref.<span class="property">dispatch</span>;</span><br><span class="line"><span class="keyword">var</span> commit = ref.<span class="property">commit</span>;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">dispatch</span> = <span class="keyword">function</span> <span class="title function_">boundDispatch</span>(<span class="params">type, payload</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> dispatch.<span class="title function_">call</span>(store, type, payload);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œçš„ dispatch ä¸»è¦æ˜¯ä¸ºäº†æ‰§è¡Œ dispatch æ—¶ï¼Œå°†å…¶ this ç¡®å®šç»‘å®šåˆ° Store ä¸­</p>
<h3 id="Store-åŸå‹é“¾çš„-dispatch"><a href="#Store-åŸå‹é“¾çš„-dispatch" class="headerlink" title="Store åŸå‹é“¾çš„ dispatch"></a>Store åŸå‹é“¾çš„ dispatch</h3><ul>
<li><p>è·å–åˆ° action å¯¹åº”çš„ type å’Œå‚æ•°<br>ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°å¯èƒ½æ˜¯ä¸ª objectï¼Œé‚£ä¹ˆéœ€è¦ä» object ä¸­å–å‡º type å’Œ action çš„å‚æ•°</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ref = <span class="title function_">unifyObjectStyle</span>(_type, _payload);</span><br><span class="line"><span class="keyword">var</span> type = ref.<span class="property">type</span>;</span><br><span class="line"><span class="keyword">var</span> payload = ref.<span class="property">payload</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> action = &#123; <span class="attr">type</span>: type, <span class="attr">payload</span>: payload &#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å¾ªç¯æ‰§è¡Œ Store æä¾›çš„ subscribeAction å›è°ƒçš„ before</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="comment">// æ‹¿åˆ°æ‰€æœ‰çš„subscribeActionåˆ—è¡¨ï¼Œè¿‡æ»¤æ‰åªå­˜åœ¨beforeçš„å‡½æ•°å¹¶ä¸”æ‰§è¡Œ</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">_actionSubscribers</span></span><br><span class="line">    .<span class="title function_">slice</span>() <span class="comment">// shallow copy to prevent iterator invalidation if subscriber synchronously calls unsubscribe</span></span><br><span class="line">    .<span class="title function_">filter</span>(<span class="keyword">function</span> (<span class="params">sub</span>) &#123;</span><br><span class="line">      <span class="comment">// è¿‡æ»¤åªå­˜åœ¨beforeçš„å‡½æ•°</span></span><br><span class="line">      <span class="keyword">return</span> sub.<span class="property">before</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">sub</span>) &#123;</span><br><span class="line">      <span class="comment">// å¾ªç¯æ‰§è¡Œå¯¹åº”çš„å‡½æ•°</span></span><br><span class="line">      <span class="keyword">return</span> sub.<span class="title function_">before</span>(action, <span class="variable language_">this</span>$1.<span class="property">state</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">  <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&quot;production&quot;</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;[vuex] error in before action subscribers: &quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(e);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>æ‰§è¡Œ action å‡½æ•°<br>action æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‡å¤çš„ action åç§°æ˜¯ä¼šæ”¾åˆ°åŒä¸€ä¸ª actionType ä¸‹çš„<br>å®é™…è¿™é‡Œæ‰§è¡Œçš„æ˜¯åœ¨ registerAction å¯¹å‡½æ•°è¿›è¡ŒåŒ…è£…äº†ä¸€å±‚çš„ action å‡½æ•°</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> result =</span><br><span class="line">  entry.<span class="property">length</span> &gt; <span class="number">1</span></span><br><span class="line">    ? <span class="title class_">Promise</span>.<span class="title function_">all</span>(</span><br><span class="line">        entry.<span class="title function_">map</span>(<span class="keyword">function</span> (<span class="params">handler</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="title function_">handler</span>(payload);</span><br><span class="line">        &#125;)</span><br><span class="line">      )</span><br><span class="line">    : entry[<span class="number">0</span>](payload);</span><br></pre></td></tr></table></figure>
</li>
<li><p>å¾ªç¯æ‰§è¡Œ Store æä¾›çš„ subscribeAction å›è°ƒçš„ after å’Œ errorï¼Œå¹¶å°† action æ‰§è¡Œç»“æœä¼ ç»™æ­¤å‡½æ•°</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">  <span class="comment">// åœ¨actionæˆåŠŸæ‰§è¡Œä¹‹å</span></span><br><span class="line">  result.<span class="title function_">then</span>(</span><br><span class="line">    <span class="keyword">function</span> (<span class="params">res</span>) &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>$1.<span class="property">_actionSubscribers</span></span><br><span class="line">          .<span class="title function_">filter</span>(<span class="keyword">function</span> (<span class="params">sub</span>) &#123;</span><br><span class="line">            <span class="comment">// è¿‡æ»¤åªå«æœ‰afterçš„é¡¹</span></span><br><span class="line">            <span class="keyword">return</span> sub.<span class="property">after</span>;</span><br><span class="line">          &#125;)</span><br><span class="line">          .<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">sub</span>) &#123;</span><br><span class="line">            <span class="comment">// å¾ªç¯æ‰§è¡Œå‡½æ•°</span></span><br><span class="line">            <span class="keyword">return</span> sub.<span class="title function_">after</span>(action, <span class="variable language_">this</span>$1.<span class="property">state</span>);</span><br><span class="line">          &#125;);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&quot;production&quot;</span>) &#123;</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;[vuex] error in after action subscribers: &quot;</span>);</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">error</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="title function_">resolve</span>(res);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// å¦‚æœå‡ºé”™äº†ï¼Œå°±éœ€è¦å°†é”™è¯¯ä¼ ç»™errorå›è°ƒ</span></span><br><span class="line">    <span class="keyword">function</span> (<span class="params">error</span>) &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>$1.<span class="property">_actionSubscribers</span></span><br><span class="line">          .<span class="title function_">filter</span>(<span class="keyword">function</span> (<span class="params">sub</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> sub.<span class="property">error</span>;</span><br><span class="line">          &#125;)</span><br><span class="line">          .<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">sub</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> sub.<span class="title function_">error</span>(action, <span class="variable language_">this</span>$1.<span class="property">state</span>, error);</span><br><span class="line">          &#125;);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&quot;production&quot;</span>) &#123;</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;[vuex] error in error action subscribers: &quot;</span>);</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">error</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="title function_">reject</span>(error);</span><br><span class="line">    &#125;</span><br><span class="line">  );</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="registerAction-çš„-action"><a href="#registerAction-çš„-action" class="headerlink" title="registerAction çš„ action"></a>registerAction çš„ action</h3><p>è¿™ä¸ªå‡½æ•°æ‰æ˜¯çœŸæ­£æ‰§è¡Œé¡¹ç›®ä¸­å†™çš„ action å›è°ƒ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">registerAction</span>(<span class="params">store, type, handler, local</span>) &#123;</span><br><span class="line">  <span class="comment">// æ‹¿åˆ°å½“å‰actionåˆ—è¡¨</span></span><br><span class="line">  <span class="keyword">var</span> entry = store.<span class="property">_actions</span>[type] || (store.<span class="property">_actions</span>[type] = []);</span><br><span class="line">  entry.<span class="title function_">push</span>(<span class="keyword">function</span> <span class="title function_">wrappedActionHandler</span>(<span class="params">payload</span>) &#123;</span><br><span class="line">    <span class="comment">// è¿™é‡Œæ˜¯åœ¨Store.prototype.dispatchä¸­è°ƒç”¨actionæ—¶ï¼Œè°ƒç”¨çš„å‡½æ•°</span></span><br><span class="line">    <span class="comment">// handleræ˜¯é¡¹ç›®ä¸­çš„actionï¼Œå°†å…¶thisæŒ‡å‘store</span></span><br><span class="line">    <span class="comment">// ä¼ å…¥rootå‚æ•°</span></span><br><span class="line">    <span class="keyword">var</span> res = handler.<span class="title function_">call</span>(</span><br><span class="line">      store,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">dispatch</span>: local.<span class="property">dispatch</span>,</span><br><span class="line">        <span class="attr">commit</span>: local.<span class="property">commit</span>,</span><br><span class="line">        <span class="attr">getters</span>: local.<span class="property">getters</span>,</span><br><span class="line">        <span class="attr">state</span>: local.<span class="property">state</span>,</span><br><span class="line">        <span class="attr">rootGetters</span>: store.<span class="property">getters</span>,</span><br><span class="line">        <span class="attr">rootState</span>: store.<span class="property">state</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      payload</span><br><span class="line">    );</span><br><span class="line">    <span class="comment">// å¦‚æœè¿”å›ç»“æœä¸æ˜¯ä¸€ä¸ªpromiseï¼Œé‚£ä¹ˆä¹ŸåŒ…è£…ä¸ºä¸€ä¸ªpromiseè¿”å›</span></span><br><span class="line">    <span class="comment">// è¿™é‡Œä¿è¯äº†åœ¨Store.prototype.dispatchçš„æ‰§è¡Œç»“æœå¿…é¡»æ˜¯ä¸ªpromise</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_">isPromise</span>(res)) &#123;</span><br><span class="line">      res = <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(res);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (store.<span class="property">_devtoolHook</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> res.<span class="title function_">catch</span>(<span class="keyword">function</span> (<span class="params">err</span>) &#123;</span><br><span class="line">        store.<span class="property">_devtoolHook</span>.<span class="title function_">emit</span>(<span class="string">&quot;vuex:error&quot;</span>, err);</span><br><span class="line">        <span class="keyword">throw</span> err;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="commit"><a href="#commit" class="headerlink" title="commit"></a>commit</h2><p>å’Œ dispatch ä¸€æ ·ï¼Œvuex ä¸­å…³äº commit çš„åœ°æ–¹ä¹Ÿæœ‰ä¸‰ä¸ªï¼š</p>
<ul>
<li><p>è¿›è¡Œåˆå§‹åŒ–æ—¶ Store ä¸­å¯¹ commit çš„é‡æ–°èµ‹å€¼</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">commit</span> = <span class="keyword">function</span> <span class="title function_">boundCommit</span>(<span class="params">type, payload, options</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> commit.<span class="title function_">call</span>(store, type, payload, options);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Store çš„ prototypeï¼›</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Store</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">commit</span> = <span class="keyword">function</span> <span class="title function_">commit</span>(<span class="params">_type, _payload, _options</span>) &#123;&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨èµ°åˆå§‹åŒ–æ—¶ï¼Œæ³¨å†Œæ¯ä¸ª action</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">registerMutation</span>(<span class="params">store, type, handler, local</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> entry = store.<span class="property">_mutations</span>[type] || (store.<span class="property">_mutations</span>[type] = []);</span><br><span class="line">  entry.<span class="title function_">push</span>(<span class="keyword">function</span> <span class="title function_">wrappedMutationHandler</span>(<span class="params">payload</span>) &#123;</span><br><span class="line">    handler.<span class="title function_">call</span>(store, local.<span class="property">state</span>, payload);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é‚£ä¹ˆå½“åœ¨é¡¹ç›®ä¸­è°ƒç”¨ commit æ—¶ï¼Œè°ƒç”¨é¡ºåºæ˜¯ä¾æ¬¡è°ƒç”¨çš„ï¼Œå®é™…è°ƒç”¨é¡¹ç›®çš„ commit å‡½æ•°ï¼Œä¹Ÿæ˜¯åœ¨ registerMutation ä¸­è¿›è¡Œè°ƒç”¨çš„ã€‚å¹³æ—¶å†™ commit å‡½æ•°æ—¶çš„ stateï¼Œå°±æ˜¯åœ¨ registerMutation çš„å‡½æ•°ä¸­è¿›è¡Œèµ‹å€¼çš„</p>
</li>
</ul>
<h3 id="Store-é‡æ–°èµ‹å€¼-1"><a href="#Store-é‡æ–°èµ‹å€¼-1" class="headerlink" title="Store é‡æ–°èµ‹å€¼"></a>Store é‡æ–°èµ‹å€¼</h3><p>ä½œç”¨å’Œ dispatch ä¸€æ ·ï¼Œä¹Ÿæ˜¯ç¡®ä¿æ‰§è¡Œçš„ this æŒ‡å‘ Store</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">commit</span> = <span class="keyword">function</span> <span class="title function_">boundCommit</span>(<span class="params">type, payload, options</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> commit.<span class="title function_">call</span>(store, type, payload, options);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="Store-prototype-commit"><a href="#Store-prototype-commit" class="headerlink" title="Store.prototype.commit"></a>Store.prototype.commit</h3><ul>
<li><p>å’Œ dispatch ä¸€æ ·ï¼Œå°†ä¼ å…¥çš„å‚æ•°æ ¼å¼åŒ–</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="variable language_">this</span>$1 = <span class="variable language_">this</span>;</span><br><span class="line"><span class="comment">// check object-style commit</span></span><br><span class="line"><span class="keyword">var</span> ref = <span class="title function_">unifyObjectStyle</span>(_type, _payload, _options);</span><br><span class="line"><span class="keyword">var</span> type = ref.<span class="property">type</span>;</span><br><span class="line"><span class="keyword">var</span> payload = ref.<span class="property">payload</span>;</span><br><span class="line"><span class="keyword">var</span> options = ref.<span class="property">options</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> mutation = &#123; <span class="attr">type</span>: type, <span class="attr">payload</span>: payload &#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ‰§è¡Œ commit<br>å…ˆè·å–åˆ° commit åˆ—è¡¨ï¼Œç„¶åæ‰§è¡Œ commit å‡½æ•°ï¼Œå’Œ dispatchï¼Œè¿™é‡Œæ‰§è¡Œçš„ä¹Ÿæ˜¯ registerMutation ä¸­çš„å‡½æ•°</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> entry = <span class="variable language_">this</span>.<span class="property">_mutations</span>[type];</span><br><span class="line"><span class="variable language_">this</span>.<span class="title function_">_withCommit</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  entry.<span class="title function_">forEach</span>(<span class="keyword">function</span> <span class="title function_">commitIterator</span>(<span class="params">handler</span>) &#123;</span><br><span class="line">    <span class="title function_">handler</span>(payload);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>_withCommit<br>è¿™é‡Œå°† Store çš„_committing ç½®ä¸º trueï¼Œç„¶åå†å»å¯¹åº”çš„ commit<br>å› æ­¤å¯ä»¥é€šè¿‡ Store çš„<code>_committing</code>å­—æ®µæ¥åˆ¤æ–­æ˜¯å¦æ˜¯é€šè¿‡ commit è¿›è¡Œçš„æ•°æ®ä¿®æ”¹</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Store</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">_withCommit</span> = <span class="keyword">function</span> <span class="title function_">_withCommit</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> committing = <span class="variable language_">this</span>.<span class="property">_committing</span>;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">_committing</span> = <span class="literal">true</span>;</span><br><span class="line">  <span class="title function_">fn</span>();</span><br><span class="line">  <span class="comment">// æ‰§è¡Œä¹‹åé‡ç½®æ•°æ®</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">_committing</span> = committing;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li><p>æ‰§è¡Œ subscribe åˆ—è¡¨<br>commit æ‰§è¡Œç»“æŸä¹‹åï¼Œå¾ªç¯æ‰§è¡Œ subscribe åˆ—è¡¨</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">_subscribers</span></span><br><span class="line">  .<span class="title function_">slice</span>() <span class="comment">// shallow copy to prevent iterator invalidation if subscriber synchronously calls unsubscribe</span></span><br><span class="line">  .<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">sub</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">sub</span>(mutation, <span class="variable language_">this</span>$1.<span class="property">state</span>);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure></li>
<li><p>è¾“å‡ºæ—¥å¿—<br>å¦‚æœcommitçš„æ—¶å€™ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯å¸¦æœ‰silentçš„ï¼Œé‚£ä¹ˆä¼šè¾“å‡ºä¸€è¡Œæ—¥å¿—</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&quot;production&quot;</span> &amp;&amp; options &amp;&amp; options.<span class="property">silent</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">warn</span>(</span><br><span class="line">    <span class="string">&quot;[vuex] mutation type: &quot;</span> +</span><br><span class="line">      type +</span><br><span class="line">      <span class="string">&quot;. Silent option has been removed. &quot;</span> +</span><br><span class="line">      <span class="string">&quot;Use the filter functionality in the vue-devtools&quot;</span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="registerMutation"><a href="#registerMutation" class="headerlink" title="registerMutation"></a>registerMutation</h3><p>å®é™…æƒ…å†µä¸‹ï¼Œactionå’Œcommitéƒ½æ˜¯è¢«æ‹‰å¹³äº†çš„ï¼Œé‚£ä¹ˆè¿™é‡Œå¦‚ä½•ç¡®ä¿åœ¨æ‰§è¡Œçš„æ—¶å€™ï¼Œä¼ å…¥é¡¹ç›®çš„commitå‡½æ•°stateçš„å¯¹åº”moduleä¸‹çš„å‘¢ï¼Ÿ</p>
<p>æ‰§è¡ŒregisterMutationçš„å‡½æ•°æ˜¯åœ¨installModuleï¼Œè¿›è¡ŒforEachMutationæ—¶è°ƒç”¨çš„ï¼Œåœ¨è¿™ä¸ªæ—¶å€™è°ƒç”¨registerMutationä¼ å…¥çš„moduleã€‚è¿™ä¸ªæƒ…å†µä¸‹ï¼Œå› ä¸ºè¿˜åœ¨å¯¹æ¯ä¸ªæ¨¡å—è¿›è¡Œéå†ï¼Œæ¨¡å—æ˜¯å•ç‹¬ç‹¬ç«‹çš„ï¼Œç„¶ååœ¨æ‰§è¡ŒwrappedMutationHandleræ—¶ï¼Œç”±äºé—­åŒ…çš„ç‰¹æ€§ï¼Œæ‰€ä»¥è®¿é—®çš„localæ˜¯æ²¡æœ‰è¢«æ±¡æŸ“çš„çœŸå®çš„module</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">registerMutation</span> (<span class="params">store, type, handler, local</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> entry = store.<span class="property">_mutations</span>[type] || (store.<span class="property">_mutations</span>[type] = []);</span><br><span class="line">  entry.<span class="title function_">push</span>(<span class="keyword">function</span> <span class="title function_">wrappedMutationHandler</span> (<span class="params">payload</span>) &#123;</span><br><span class="line">    <span class="comment">// ä¸»è¦æ˜¯è¿™é‡Œæ‰§è¡Œé¡¹ç›®ä¸­çœŸæ­£ç¼–å†™çš„commitå‡½æ•°</span></span><br><span class="line">    <span class="comment">// ä¹Ÿæ˜¯è¿™é‡Œå°†moduleçš„stateä¼ å…¥çš„</span></span><br><span class="line">    handler.<span class="title function_">call</span>(store, local.<span class="property">state</span>, payload);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/08/14/%E6%BA%90%E7%A0%81/%E3%80%90%E6%BA%90%E7%A0%81%E3%80%91vuex-%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0/" data-id="cmebduixl0060pwfm728p0qmh" data-title="vuex-æ‰§è¡Œå‡½æ•°" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vuex-%E6%BA%90%E7%A0%81/" rel="tag">vuex æºç </a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-æºç /ã€æºç ã€‘axios-æµç¨‹" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/08/14/%E6%BA%90%E7%A0%81/%E3%80%90%E6%BA%90%E7%A0%81%E3%80%91axios-%E6%B5%81%E7%A8%8B/" class="article-date">
  <time class="dt-published" datetime="2025-08-14T03:18:33.944Z" itemprop="datePublished">2025-08-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/axios-%E6%BA%90%E7%A0%81/">axios æºç </a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/08/14/%E6%BA%90%E7%A0%81/%E3%80%90%E6%BA%90%E7%A0%81%E3%80%91axios-%E6%B5%81%E7%A8%8B/">axiosè¯·æ±‚æµç¨‹</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="å…¥å£"><a href="#å…¥å£" class="headerlink" title="å…¥å£"></a>å…¥å£</h2><p>axiosçš„å…¥å£æ˜¯<code>/lib/axios.js</code>ï¼Œå®é™…ä¸»è¦çš„æµç¨‹åœ¨<code>/lib/core/Axios.js</code>ä¸­</p>
<p>åœ¨<code>/lib/axios.js</code>ä¸­ï¼Œåˆ›å»ºäº†ä¸€ä¸ª<code>/lib/core/Axios.js</code>å®ä¾‹ï¼Œå¹¶ç»§æ‰¿äº†å…¶çˆ¶ç±»çš„æ–¹æ³•ï¼Œå…¶ä¸­å°±åŒ…æ‹¬<code>get</code>&#x2F;<code>post</code>&#x2F;<code>delete</code>ç­‰æ–¹æ³•</p>
<p><code>axios</code>å®é™…æ˜¯ä»<code>request</code>æ–¹æ³•å‘èµ·å…¨éƒ¨è¯·æ±‚çš„ï¼Œåªæ˜¯å°è£…äº†<code>get</code>&#x2F;<code>post</code>&#x2F;<code>delete</code>ç­‰æ–¹æ³•ï¼Œ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// /lib/core/Axios.js</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Axios</span>(<span class="params">instanceConfig</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">defaults</span> = instanceConfig;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">interceptors</span> = &#123;</span><br><span class="line">    <span class="attr">request</span>: <span class="keyword">new</span> <span class="title class_">InterceptorManager</span>(),</span><br><span class="line">    <span class="attr">response</span>: <span class="keyword">new</span> <span class="title class_">InterceptorManager</span>()</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// /lib/axios.js</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">Axios</span> = <span class="built_in">require</span>(<span class="string">&#x27;./core/Axios&#x27;</span>);</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createInstance</span>(<span class="params">defaultConfig</span>) &#123;</span><br><span class="line">  <span class="comment">// contextçš„prototypeä¸Šå·²ç»åŒ…å«äº†getç­‰æ–¹æ³•</span></span><br><span class="line">  <span class="keyword">var</span> context = <span class="keyword">new</span> <span class="title class_">Axios</span>(defaultConfig);</span><br><span class="line">  <span class="comment">// ç›´æ¥è°ƒç”¨instanceæ—¶ï¼Œå®é™…å°±æ˜¯è°ƒç”¨äº†requestæ–¹æ³•</span></span><br><span class="line">  <span class="comment">// è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨è°ƒç”¨axiosæ—¶ï¼Œé™¤äº†å¯ä»¥é€šè¿‡get/postè¿›è¡Œè¯·æ±‚ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½œä¸ºä¸€ä¸ªå‡½æ•°è¿›è¡Œç›´æ¥è°ƒç”¨</span></span><br><span class="line">  <span class="keyword">var</span> instance = <span class="title function_">bind</span>(<span class="title class_">Axios</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">request</span>, context);</span><br><span class="line"></span><br><span class="line">  utils.<span class="title function_">extend</span>(instance, <span class="title class_">Axios</span>.<span class="property"><span class="keyword">prototype</span></span>, context);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Copy context to instance</span></span><br><span class="line">  utils.<span class="title function_">extend</span>(instance, context);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Factory for creating new instances</span></span><br><span class="line">  instance.<span class="property">create</span> = <span class="keyword">function</span> <span class="title function_">create</span>(<span class="params">instanceConfig</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">createInstance</span>(<span class="title function_">mergeConfig</span>(defaultConfig, instanceConfig));</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> instance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="è¯·æ±‚æµç¨‹"><a href="#è¯·æ±‚æµç¨‹" class="headerlink" title="è¯·æ±‚æµç¨‹"></a>è¯·æ±‚æµç¨‹</h2><p>ä¸»è¦çš„è¯·æ±‚æµç¨‹éƒ½åœ¨<code>request</code>æ–¹æ³•é‡Œï¼Œæ–¹æ³•å­˜åœ¨äº<code>/lib/core/Axios.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// /lib/core/Axios.js</span></span><br><span class="line"><span class="title class_">Axios</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">request</span> = <span class="keyword">function</span> <span class="title function_">request</span>(<span class="params">configOrUrl, config</span>) &#123;</span><br><span class="line">  <span class="comment">// é€‚é…æ— é¢å¤–é…ç½®ï¼Œç›´æ¥ä¼ å…¥urlçš„æƒ…å†µ</span></span><br><span class="line">  <span class="comment">// æ¯”å¦‚ axios(&#x27;example/url&#x27;)</span></span><br><span class="line">  <span class="comment">// Allow for axios(&#x27;example/url&#x27;[, config]) a la fetch API</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> configOrUrl === <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">    config = config || &#123;&#125;;</span><br><span class="line">    config.<span class="property">url</span> = configOrUrl;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    config = configOrUrl || &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// å°†é»˜è®¤é…ç½®å’Œä¼ å…¥çš„é…ç½®åˆå¹¶</span></span><br><span class="line">  config = <span class="title function_">mergeConfig</span>(<span class="variable language_">this</span>.<span class="property">defaults</span>, config);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è®¾ç½®è¯·æ±‚æ–¹æ³•</span></span><br><span class="line">  <span class="keyword">if</span> (config.<span class="property">method</span>) &#123;</span><br><span class="line">    config.<span class="property">method</span> = config.<span class="property">method</span>.<span class="title function_">toLowerCase</span>();</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">defaults</span>.<span class="property">method</span>) &#123;</span><br><span class="line">    config.<span class="property">method</span> = <span class="variable language_">this</span>.<span class="property">defaults</span>.<span class="property">method</span>.<span class="title function_">toLowerCase</span>();</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    config.<span class="property">method</span> = <span class="string">&#x27;get&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> transitional = config.<span class="property">transitional</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (transitional !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">    validator.<span class="title function_">assertOptions</span>(transitional, &#123;</span><br><span class="line">      <span class="comment">// ç‰ˆæœ¬å…¼å®¹é…ç½®-è¿”å›å€¼è½¬æ¢ä¸º Json å‡ºé”™æ—¶æ˜¯å¦ç½®ä¸º null è¿”å›</span></span><br><span class="line">      <span class="attr">silentJSONParsing</span>: validators.<span class="title function_">transitional</span>(validators.<span class="property">boolean</span>),</span><br><span class="line">      <span class="comment">// ç‰ˆæœ¬å…¼å®¹é…ç½®-responseType è®¾ç½®é json ç±»å‹æ—¶æ˜¯å¦å¼ºåˆ¶è½¬æ¢æˆ json æ ¼å¼</span></span><br><span class="line">      <span class="attr">forcedJSONParsing</span>: validators.<span class="title function_">transitional</span>(validators.<span class="property">boolean</span>),</span><br><span class="line">      <span class="comment">// ç‰ˆæœ¬å…¼å®¹é…ç½®-è¯·æ±‚è¶…æ—¶æ—¶æ˜¯å¦é»˜è®¤è¿”å› ETIMEDOUT ç±»å‹é”™</span></span><br><span class="line">      <span class="attr">clarifyTimeoutError</span>: validators.<span class="title function_">transitional</span>(validators.<span class="property">boolean</span>)</span><br><span class="line">    &#125;, <span class="literal">false</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// filter out skipped interceptors</span></span><br><span class="line">  <span class="comment">// è¯·æ±‚æ‹¦æˆªå™¨æ•°ç»„</span></span><br><span class="line">  <span class="keyword">var</span> requestInterceptorChain = [];</span><br><span class="line">  <span class="keyword">var</span> synchronousRequestInterceptors = <span class="literal">true</span>;</span><br><span class="line">  <span class="comment">// å¾ªç¯è®¿é—®æ‹¦æˆªå™¨çš„è¯·æ±‚æ•°ç»„ï¼Œå°†å…¶æ”¾åœ¨è¯·æ±‚çœŸå®æ‰§è¡Œä¹‹å‰</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span> <span class="title function_">unshiftRequestInterceptors</span>(<span class="params">interceptor</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> interceptor.<span class="property">runWhen</span> === <span class="string">&#x27;function&#x27;</span> &amp;&amp; interceptor.<span class="title function_">runWhen</span>(config) === <span class="literal">false</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    synchronousRequestInterceptors = synchronousRequestInterceptors &amp;&amp; interceptor.<span class="property">synchronous</span>;</span><br><span class="line"></span><br><span class="line">    requestInterceptorChain.<span class="title function_">unshift</span>(interceptor.<span class="property">fulfilled</span>, interceptor.<span class="property">rejected</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å“åº”æ‹¦æˆªå™¨æ•°ç»„</span></span><br><span class="line">  <span class="comment">// å¾ªç¯è®¿é—®æ‹¦æˆªå™¨çš„å“åº”æ•°ç»„ï¼Œå°†å…¶æ”¾åœ¨è¯·æ±‚çœŸå®æ‰§è¡Œä¹‹å</span></span><br><span class="line">  <span class="keyword">var</span> responseInterceptorChain = [];</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span> <span class="title function_">pushResponseInterceptors</span>(<span class="params">interceptor</span>) &#123;</span><br><span class="line">    responseInterceptorChain.<span class="title function_">push</span>(interceptor.<span class="property">fulfilled</span>, interceptor.<span class="property">rejected</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> promise;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!synchronousRequestInterceptors) &#123;</span><br><span class="line">    <span class="keyword">var</span> chain = [dispatchRequest, <span class="literal">undefined</span>];</span><br><span class="line"></span><br><span class="line">    <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">unshift</span>.<span class="title function_">apply</span>(chain, requestInterceptorChain);</span><br><span class="line">    chain = chain.<span class="title function_">concat</span>(responseInterceptorChain);</span><br><span class="line"></span><br><span class="line">    promise = <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(config);</span><br><span class="line">    <span class="keyword">while</span> (chain.<span class="property">length</span>) &#123;</span><br><span class="line">      promise = promise.<span class="title function_">then</span>(chain.<span class="title function_">shift</span>(), chain.<span class="title function_">shift</span>());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> promise;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> newConfig = config;</span><br><span class="line">  <span class="comment">// ä¸€æ­¥æ­¥æ‰§è¡Œè¯·æ±‚æ‹¦æˆªå™¨ï¼Œå¹¶å°†å…¶æ‰§è¡Œç»“æœè¦†ç›–è¯·æ±‚é…ç½®</span></span><br><span class="line">  <span class="keyword">while</span> (requestInterceptorChain.<span class="property">length</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> onFulfilled = requestInterceptorChain.<span class="title function_">shift</span>();</span><br><span class="line">    <span class="keyword">var</span> onRejected = requestInterceptorChain.<span class="title function_">shift</span>();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      newConfig = <span class="title function_">onFulfilled</span>(newConfig);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="title function_">onRejected</span>(error);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ‰§è¡Œè¯·æ±‚</span></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    promise = <span class="title function_">dispatchRequest</span>(newConfig);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// ä¸€æ­¥æ­¥æ‰§è¡Œå“åº”æ‹¦æˆªå™¨</span></span><br><span class="line">  <span class="keyword">while</span> (responseInterceptorChain.<span class="property">length</span>) &#123;</span><br><span class="line">    promise = promise.<span class="title function_">then</span>(responseInterceptorChain.<span class="title function_">shift</span>(), responseInterceptorChain.<span class="title function_">shift</span>());</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> promise;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡ŒåŒ…å«çš„æµç¨‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>åˆå¹¶é…ç½®ï¼ŒåŒ…æ‹¬é»˜è®¤é…ç½®å’Œä¼ å…¥çš„é…ç½®</li>
<li>è®¾ç½®è¯·æ±‚æ–¹æ³•</li>
<li>è¯·æ±‚æ‹¦æˆªå™¨ requestInterceptorChain</li>
<li>å“åº”æ‹¦æˆªå™¨ responseInterceptorChain</li>
<li>æ‰§è¡Œè¯·æ±‚ï¼ˆdispatchRequestï¼‰ï¼Œä¸”æ˜¯åœ¨è¯·æ±‚æ‹¦æˆªå™¨ä¹‹åï¼Œå“åº”æ‹¦æˆªå™¨ä¹‹å‰</li>
</ul>
<p>æ³¨æ„ç‚¹ï¼š</p>
<ul>
<li>è¿™é‡Œçš„æ‰§è¡Œæ˜¯æ”¾åœ¨ä¸€ä¸ªæ•°ç»„é‡Œé¢çš„ï¼Œæœ€å¼€å§‹åªæœ‰å®é™…çš„è¯·æ±‚ï¼Œç„¶ååœ¨æ•°ç»„å¼€å¤´åŠ ä¸Šè¯·æ±‚çš„æ‹¦æˆªå™¨å‡½æ•°ï¼Œåœ¨æ•°ç»„æœ€ååŠ ä¸Šè¯·æ±‚çš„å“åº”æ‹¦æˆªå™¨å¤„ç†å‡½æ•°</li>
<li>æ‹¦æˆªå™¨çš„å‡½æ•°çš„å‚æ•°æ˜¯ä»ä¸Šä¸€ä¸ªæ‹¦æˆªå™¨ä¸­è¿”å›çš„ç»“æœ</li>
<li>é»˜è®¤è¯·æ±‚å¤´æ˜¯<code>get</code></li>
</ul>
<h2 id="æ´¾å‘è¯·æ±‚"><a href="#æ´¾å‘è¯·æ±‚" class="headerlink" title="æ´¾å‘è¯·æ±‚"></a>æ´¾å‘è¯·æ±‚</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// /lib/core/dispatchRequest.js</span></span><br><span class="line"><span class="comment">// æ´¾å‘è¯·æ±‚</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">function</span> <span class="title function_">dispatchRequest</span>(<span class="params">config</span>) &#123;</span><br><span class="line">  <span class="comment">// å–æ¶ˆè¯·æ±‚ç›¸å…³</span></span><br><span class="line">  <span class="title function_">throwIfCancellationRequested</span>(config);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Ensure headers exist</span></span><br><span class="line">  config.<span class="property">headers</span> = config.<span class="property">headers</span> || &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Transform the data for a request or a response</span></span><br><span class="line">  config.<span class="property">data</span> = transformData.<span class="title function_">call</span>(</span><br><span class="line">    config,</span><br><span class="line">    config.<span class="property">data</span>,<span class="comment">//æ–¹æ³•å‚æ•°ï¼Œå¦‚æœæ˜¯å¤šä¸ªæ–¹æ³•ï¼Œé‚£ä¹ˆæ–¹æ³•2çš„å‚æ•°æ˜¯ç”±æ–¹æ³•1çš„è¿”å›å€¼å†³å®šçš„</span></span><br><span class="line">    config.<span class="property">headers</span>,<span class="comment">//è¯·æ±‚å¤´</span></span><br><span class="line">    config.<span class="property">transformRequest</span><span class="comment">//æ‰§è¡Œçš„æ–¹æ³•ï¼Œå…·ä½“æ˜¯åœ¨axiosé‡Œé¢è‡ªå·±å®šä¹‰äº†ï¼Œåœ¨/lib/defaults.jsæ–‡ä»¶ä¸­ï¼Œä¸»è¦æ˜¯ç”¨äºè¯·æ±‚å¤´çš„ä¿®æ”¹</span></span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆå¹¶æ‹‰å¹³è¯·æ±‚å¤´</span></span><br><span class="line">  config.<span class="property">headers</span> = utils.<span class="title function_">merge</span>(</span><br><span class="line">    config.<span class="property">headers</span>.<span class="property">common</span> || &#123;&#125;,</span><br><span class="line">    config.<span class="property">headers</span>[config.<span class="property">method</span>] || &#123;&#125;,</span><br><span class="line">    config.<span class="property">headers</span></span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å¦‚æœæ˜¯è¿™äº›è¯·æ±‚ï¼Œé‚£ä¹ˆå°±åˆ é™¤æ‰å¯¹åº”çš„è¯·æ±‚å¤´</span></span><br><span class="line">  utils.<span class="title function_">forEach</span>(</span><br><span class="line">    [<span class="string">&#x27;delete&#x27;</span>, <span class="string">&#x27;get&#x27;</span>, <span class="string">&#x27;head&#x27;</span>, <span class="string">&#x27;post&#x27;</span>, <span class="string">&#x27;put&#x27;</span>, <span class="string">&#x27;patch&#x27;</span>, <span class="string">&#x27;common&#x27;</span>],</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">cleanHeaderConfig</span>(<span class="params">method</span>) &#123;</span><br><span class="line">      <span class="keyword">delete</span> config.<span class="property">headers</span>[method];</span><br><span class="line">    &#125;</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> adapter = config.<span class="property">adapter</span> || defaults.<span class="property">adapter</span>;</span><br><span class="line">  <span class="comment">// æ‰§è¡Œé€‚é…å™¨</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">adapter</span>(config).<span class="title function_">then</span>(<span class="keyword">function</span> <span class="title function_">onAdapterResolution</span>(<span class="params">response</span>) &#123;</span><br><span class="line">    <span class="comment">// å–æ¶ˆç›¸å…³è¯·æ±‚çš„</span></span><br><span class="line">    <span class="title function_">throwIfCancellationRequested</span>(config);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Transform response data</span></span><br><span class="line">    response.<span class="property">data</span> = transformData.<span class="title function_">call</span>(</span><br><span class="line">      config,</span><br><span class="line">      response.<span class="property">data</span>,</span><br><span class="line">      response.<span class="property">headers</span>,</span><br><span class="line">      config.<span class="property">transformResponse</span><span class="comment">//æ‰§è¡Œçš„æ–¹æ³•ï¼Œå…·ä½“æ˜¯åœ¨axiosé‡Œé¢è‡ªå·±å®šä¹‰äº†ï¼Œåœ¨/lib/defaults.jsæ–‡ä»¶ä¸­ï¼Œä¸»è¦æ˜¯ç”¨äºå“åº”ç»“æœçš„ä¿®æ”¹</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> response;</span><br><span class="line">  &#125;, <span class="keyword">function</span> <span class="title function_">onAdapterRejection</span>(<span class="params">reason</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_">isCancel</span>(reason)) &#123;</span><br><span class="line">      <span class="title function_">throwIfCancellationRequested</span>(config);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Transform response data</span></span><br><span class="line">      <span class="keyword">if</span> (reason &amp;&amp; reason.<span class="property">response</span>) &#123;</span><br><span class="line">        reason.<span class="property">response</span>.<span class="property">data</span> = transformData.<span class="title function_">call</span>(</span><br><span class="line">          config,</span><br><span class="line">          reason.<span class="property">response</span>.<span class="property">data</span>,</span><br><span class="line">          reason.<span class="property">response</span>.<span class="property">headers</span>,</span><br><span class="line">          config.<span class="property">transformResponse</span></span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(reason);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>æµç¨‹ï¼š</p>
<ul>
<li>ç»Ÿä¸€å¤„ç†è¯·æ±‚å¤´</li>
<li>åˆå¹¶æ‹‰å¹³è¯·æ±‚å¤´</li>
<li>æŸäº›è¯·æ±‚ä¼šåˆ é™¤è¯·æ±‚å¤´çš„<code>config.headers[method]</code></li>
<li>æ‰§è¡Œè¯·æ±‚</li>
<li>è·å–åˆ°å“åº”æ•°æ®åï¼Œç»Ÿä¸€å¤„ç†å“åº”ç»“æœ</li>
</ul>
<p>æ³¨æ„ç‚¹ï¼š</p>
<ul>
<li><code>[&#39;delete&#39;, &#39;get&#39;, &#39;head&#39;, &#39;post&#39;, &#39;put&#39;, &#39;patch&#39;, &#39;common&#39;]</code>è¿™äº›è¯·æ±‚axiosä¼šåˆ é™¤è¯·æ±‚å¤´çš„<code>config.headers[method]</code></li>
<li>å…³äºè¯·æ±‚å¤´çš„ç»Ÿä¸€é¢å¤–å¤„ç†ï¼Œåœ¨è¿™ä¸ªé˜¶æ®µè¿›è¡Œ</li>
<li>å…³äºå“åº”ç»“æœçš„è§£æï¼Œæ˜¯åœ¨è¿™ä¸ªé˜¶æ®µæ‰§è¡Œçš„</li>
</ul>
<h2 id="å®é™…è¯·æ±‚å‘é€"><a href="#å®é™…è¯·æ±‚å‘é€" class="headerlink" title="å®é™…è¯·æ±‚å‘é€"></a>å®é™…è¯·æ±‚å‘é€</h2><p>é€‚é…å™¨è§£é‡Šäº†ä¸ºä»€ä¹ˆaxioså¯ä»¥åœ¨nodejså’Œæµè§ˆå™¨é‡Œé¢éƒ½å‘é€è¯·æ±‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// /lib/defaults/index,js</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">getDefaultAdapter</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> adapter;</span><br><span class="line">  <span class="comment">// å¦‚æœæ˜¯æµè§ˆå™¨çš„ç¯å¢ƒï¼Œé‚£ä¹ˆå°±ç”¨çš„æ˜¯xhr</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="title class_">XMLHttpRequest</span> !== <span class="string">&#x27;undefined&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">// For browsers use XHR adapter</span></span><br><span class="line">    adapter = <span class="built_in">require</span>(<span class="string">&#x27;../adapters/xhr&#x27;</span>);</span><br><span class="line">  <span class="comment">// å¦‚æœæ˜¯éæµè§ˆå™¨çš„ç¯å¢ƒï¼ˆä¾‹å¦‚nodejsï¼‰ï¼Œé‚£ä¹ˆå°±ç”¨çš„æ˜¯httpçš„æ–‡ä»¶</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> process !== <span class="string">&#x27;undefined&#x27;</span> &amp;&amp; <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(process) === <span class="string">&#x27;[object process]&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">// For node use HTTP adapter</span></span><br><span class="line">    adapter = <span class="built_in">require</span>(<span class="string">&#x27;../adapters/http&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> adapter;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// /lib/adapters/xhr.js</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">function</span> <span class="title function_">xhrAdapter</span>(<span class="params">config</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> <span class="title function_">dispatchXhrRequest</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">    <span class="comment">// æ‹¿åˆ°è¯·æ±‚é…ç½®é¡¹</span></span><br><span class="line">    <span class="keyword">var</span> requestData = config.<span class="property">data</span>;</span><br><span class="line">    <span class="keyword">var</span> requestHeaders = config.<span class="property">headers</span>;</span><br><span class="line">    <span class="keyword">var</span> responseType = config.<span class="property">responseType</span>;</span><br><span class="line">    <span class="keyword">var</span> onCanceled;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">done</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="comment">// å¦‚æœæœ‰å–æ¶ˆçš„ï¼Œé‚£ä¹ˆèµ°å–æ¶ˆè¯·æ±‚</span></span><br><span class="line">      <span class="keyword">if</span> (config.<span class="property">cancelToken</span>) &#123;</span><br><span class="line">        config.<span class="property">cancelToken</span>.<span class="title function_">unsubscribe</span>(onCanceled);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (config.<span class="property">signal</span>) &#123;</span><br><span class="line">        config.<span class="property">signal</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;abort&#x27;</span>, onCanceled);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è®¾ç½®formè¯·æ±‚çš„è¯·æ±‚å¤´</span></span><br><span class="line">    <span class="keyword">if</span> (utils.<span class="title function_">isFormData</span>(requestData) &amp;&amp; utils.<span class="title function_">isStandardBrowserEnv</span>()) &#123;</span><br><span class="line">      <span class="keyword">delete</span> requestHeaders[<span class="string">&#x27;Content-Type&#x27;</span>]; <span class="comment">// Let the browser set it</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// åˆ›å»ºxhrè¯·æ±‚</span></span><br><span class="line">    <span class="keyword">var</span> request = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœæœ‰è®¾ç½®æˆæƒç›¸å…³çš„ï¼Œé‚£ä¹ˆé…ç½®å…¶è¯·æ±‚å¤´</span></span><br><span class="line">    <span class="keyword">if</span> (config.<span class="property">auth</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> username = config.<span class="property">auth</span>.<span class="property">username</span> || <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">      <span class="keyword">var</span> password = config.<span class="property">auth</span>.<span class="property">password</span> ? <span class="built_in">unescape</span>(<span class="built_in">encodeURIComponent</span>(config.<span class="property">auth</span>.<span class="property">password</span>)) : <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">      requestHeaders.<span class="property">Authorization</span> = <span class="string">&#x27;Basic &#x27;</span> + <span class="title function_">btoa</span>(username + <span class="string">&#x27;:&#x27;</span> + password);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> fullPath = <span class="title function_">buildFullPath</span>(config.<span class="property">baseURL</span>, config.<span class="property">url</span>);</span><br><span class="line"></span><br><span class="line">    request.<span class="title function_">open</span>(config.<span class="property">method</span>.<span class="title function_">toUpperCase</span>(), <span class="title function_">buildURL</span>(fullPath, config.<span class="property">params</span>, config.<span class="property">paramsSerializer</span>), <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Set the request timeout in MS</span></span><br><span class="line">    request.<span class="property">timeout</span> = config.<span class="property">timeout</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">onloadend</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!request) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// Prepare the response</span></span><br><span class="line">      <span class="keyword">var</span> responseHeaders = <span class="string">&#x27;getAllResponseHeaders&#x27;</span> <span class="keyword">in</span> request ? <span class="title function_">parseHeaders</span>(request.<span class="title function_">getAllResponseHeaders</span>()) : <span class="literal">null</span>;</span><br><span class="line">      <span class="keyword">var</span> responseData = !responseType || responseType === <span class="string">&#x27;text&#x27;</span> ||  responseType === <span class="string">&#x27;json&#x27;</span> ?</span><br><span class="line">        request.<span class="property">responseText</span> : request.<span class="property">response</span>;</span><br><span class="line">      <span class="keyword">var</span> response = &#123;</span><br><span class="line">        <span class="attr">data</span>: responseData,</span><br><span class="line">        <span class="attr">status</span>: request.<span class="property">status</span>,</span><br><span class="line">        <span class="attr">statusText</span>: request.<span class="property">statusText</span>,</span><br><span class="line">        <span class="attr">headers</span>: responseHeaders,</span><br><span class="line">        <span class="attr">config</span>: config,</span><br><span class="line">        <span class="attr">request</span>: request</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      <span class="title function_">settle</span>(<span class="keyword">function</span> <span class="title function_">_resolve</span>(<span class="params">value</span>) &#123;</span><br><span class="line">        <span class="title function_">resolve</span>(value);</span><br><span class="line">        <span class="title function_">done</span>();</span><br><span class="line">      &#125;, <span class="keyword">function</span> <span class="title function_">_reject</span>(<span class="params">err</span>) &#123;</span><br><span class="line">        <span class="title function_">reject</span>(err);</span><br><span class="line">        <span class="title function_">done</span>();</span><br><span class="line">      &#125;, response);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Clean up request</span></span><br><span class="line">      request = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&#x27;onloadend&#x27;</span> <span class="keyword">in</span> request) &#123;</span><br><span class="line">      <span class="comment">// Use onloadend if available</span></span><br><span class="line">      request.<span class="property">onloadend</span> = onloadend;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// Listen for ready state to emulate onloadend</span></span><br><span class="line">      request.<span class="property">onreadystatechange</span> = <span class="keyword">function</span> <span class="title function_">handleLoad</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!request || request.<span class="property">readyState</span> !== <span class="number">4</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// The request errored out and we didn&#x27;t get a response, this will be</span></span><br><span class="line">        <span class="comment">// handled by onerror instead</span></span><br><span class="line">        <span class="comment">// With one exception: request that using file: protocol, most browsers</span></span><br><span class="line">        <span class="comment">// will return status as 0 even though it&#x27;s a successful request</span></span><br><span class="line">        <span class="keyword">if</span> (request.<span class="property">status</span> === <span class="number">0</span> &amp;&amp; !(request.<span class="property">responseURL</span> &amp;&amp; request.<span class="property">responseURL</span>.<span class="title function_">indexOf</span>(<span class="string">&#x27;file:&#x27;</span>) === <span class="number">0</span>)) &#123;</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// readystate handler is calling before onerror or ontimeout handlers,</span></span><br><span class="line">        <span class="comment">// so we should call onloadend on the next &#x27;tick&#x27;</span></span><br><span class="line">        <span class="built_in">setTimeout</span>(onloadend);</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Handle browser request cancellation (as opposed to a manual cancellation)</span></span><br><span class="line">    request.<span class="property">onabort</span> = <span class="keyword">function</span> <span class="title function_">handleAbort</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!request) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">AxiosError</span>(<span class="string">&#x27;Request aborted&#x27;</span>, <span class="title class_">AxiosError</span>.<span class="property">ECONNABORTED</span>, config, request));</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Clean up request</span></span><br><span class="line">      request = <span class="literal">null</span>;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Handle low level network errors</span></span><br><span class="line">    request.<span class="property">onerror</span> = <span class="keyword">function</span> <span class="title function_">handleError</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="comment">// Real errors are hidden from us by the browser</span></span><br><span class="line">      <span class="comment">// onerror should only fire if it&#x27;s a network error</span></span><br><span class="line">      <span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">AxiosError</span>(<span class="string">&#x27;Network Error&#x27;</span>, <span class="title class_">AxiosError</span>.<span class="property">ERR_NETWORK</span>, config, request, request));</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Clean up request</span></span><br><span class="line">      request = <span class="literal">null</span>;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Handle timeout</span></span><br><span class="line">    request.<span class="property">ontimeout</span> = <span class="keyword">function</span> <span class="title function_">handleTimeout</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> timeoutErrorMessage = config.<span class="property">timeout</span> ? <span class="string">&#x27;timeout of &#x27;</span> + config.<span class="property">timeout</span> + <span class="string">&#x27;ms exceeded&#x27;</span> : <span class="string">&#x27;timeout exceeded&#x27;</span>;</span><br><span class="line">      <span class="keyword">var</span> transitional = config.<span class="property">transitional</span> || transitionalDefaults;</span><br><span class="line">      <span class="keyword">if</span> (config.<span class="property">timeoutErrorMessage</span>) &#123;</span><br><span class="line">        timeoutErrorMessage = config.<span class="property">timeoutErrorMessage</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">AxiosError</span>(</span><br><span class="line">        timeoutErrorMessage,</span><br><span class="line">        transitional.<span class="property">clarifyTimeoutError</span> ? <span class="title class_">AxiosError</span>.<span class="property">ETIMEDOUT</span> : <span class="title class_">AxiosError</span>.<span class="property">ECONNABORTED</span>,</span><br><span class="line">        config,</span><br><span class="line">        request));</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Clean up request</span></span><br><span class="line">      request = <span class="literal">null</span>;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Add xsrf header</span></span><br><span class="line">    <span class="comment">// This is only done if running in a standard browser environment.</span></span><br><span class="line">    <span class="comment">// Specifically not if we&#x27;re in a web worker, or react-native.</span></span><br><span class="line">    <span class="keyword">if</span> (utils.<span class="title function_">isStandardBrowserEnv</span>()) &#123;</span><br><span class="line">      <span class="comment">// Add xsrf header</span></span><br><span class="line">      <span class="keyword">var</span> xsrfValue = (config.<span class="property">withCredentials</span> || <span class="title function_">isURLSameOrigin</span>(fullPath)) &amp;&amp; config.<span class="property">xsrfCookieName</span> ?</span><br><span class="line">        cookies.<span class="title function_">read</span>(config.<span class="property">xsrfCookieName</span>) :</span><br><span class="line">        <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (xsrfValue) &#123;</span><br><span class="line">        requestHeaders[config.<span class="property">xsrfHeaderName</span>] = xsrfValue;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Add headers to the request</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&#x27;setRequestHeader&#x27;</span> <span class="keyword">in</span> request) &#123;</span><br><span class="line">      utils.<span class="title function_">forEach</span>(requestHeaders, <span class="keyword">function</span> <span class="title function_">setRequestHeader</span>(<span class="params">val, key</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> requestData === <span class="string">&#x27;undefined&#x27;</span> &amp;&amp; key.<span class="title function_">toLowerCase</span>() === <span class="string">&#x27;content-type&#x27;</span>) &#123;</span><br><span class="line">          <span class="comment">// Remove Content-Type if data is undefined</span></span><br><span class="line">          <span class="keyword">delete</span> requestHeaders[key];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// Otherwise add header to the request</span></span><br><span class="line">          request.<span class="title function_">setRequestHeader</span>(key, val);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Add withCredentials to request if needed</span></span><br><span class="line">    <span class="keyword">if</span> (!utils.<span class="title function_">isUndefined</span>(config.<span class="property">withCredentials</span>)) &#123;</span><br><span class="line">      request.<span class="property">withCredentials</span> = !!config.<span class="property">withCredentials</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Add responseType to request if needed</span></span><br><span class="line">    <span class="keyword">if</span> (responseType &amp;&amp; responseType !== <span class="string">&#x27;json&#x27;</span>) &#123;</span><br><span class="line">      request.<span class="property">responseType</span> = config.<span class="property">responseType</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Handle progress if needed</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> config.<span class="property">onDownloadProgress</span> === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">      request.<span class="title function_">addEventListener</span>(<span class="string">&#x27;progress&#x27;</span>, config.<span class="property">onDownloadProgress</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Not all browsers support upload events</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> config.<span class="property">onUploadProgress</span> === <span class="string">&#x27;function&#x27;</span> &amp;&amp; request.<span class="property">upload</span>) &#123;</span><br><span class="line">      request.<span class="property">upload</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;progress&#x27;</span>, config.<span class="property">onUploadProgress</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å–æ¶ˆè¯·æ±‚ç›¸å…³</span></span><br><span class="line">    <span class="keyword">if</span> (config.<span class="property">cancelToken</span> || config.<span class="property">signal</span>) &#123;</span><br><span class="line">      <span class="comment">// Handle cancellation</span></span><br><span class="line">      <span class="comment">// eslint-disable-next-line func-names</span></span><br><span class="line">      onCanceled = <span class="keyword">function</span>(<span class="params">cancel</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!request) &#123;</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">reject</span>(!cancel || (cancel &amp;&amp; cancel.<span class="property">type</span>) ? <span class="keyword">new</span> <span class="title class_">CanceledError</span>() : cancel);</span><br><span class="line">        request.<span class="title function_">abort</span>();</span><br><span class="line">        request = <span class="literal">null</span>;</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      config.<span class="property">cancelToken</span> &amp;&amp; config.<span class="property">cancelToken</span>.<span class="title function_">subscribe</span>(onCanceled);</span><br><span class="line">      <span class="keyword">if</span> (config.<span class="property">signal</span>) &#123;</span><br><span class="line">        config.<span class="property">signal</span>.<span class="property">aborted</span> ? <span class="title function_">onCanceled</span>() : config.<span class="property">signal</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;abort&#x27;</span>, onCanceled);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!requestData) &#123;</span><br><span class="line">      requestData = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> protocol = <span class="title function_">parseProtocol</span>(fullPath);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (protocol &amp;&amp; [ <span class="string">&#x27;http&#x27;</span>, <span class="string">&#x27;https&#x27;</span>, <span class="string">&#x27;file&#x27;</span> ].<span class="title function_">indexOf</span>(protocol) === -<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">AxiosError</span>(<span class="string">&#x27;Unsupported protocol &#x27;</span> + protocol + <span class="string">&#x27;:&#x27;</span>, <span class="title class_">AxiosError</span>.<span class="property">ERR_BAD_REQUEST</span>, config));</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Send the request</span></span><br><span class="line">    request.<span class="title function_">send</span>(requestData);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ç‚¹ï¼š</p>
<ul>
<li><code>auth</code>æ˜¯è¡¨ç¤ºæˆæƒç›¸å…³çš„è¯·æ±‚å¤´ï¼Œaxiosä¼šé»˜è®¤åŠ ä¸Šé…ç½®</li>
<li>å¦‚æœæ˜¯formè¡¨å•è¯·æ±‚ï¼Œaxiosä¼šåˆ é™¤<code>Content-Type</code>è¯·æ±‚å¤´</li>
<li>åœ¨è¿™é‡Œä¹Ÿåšäº†å–æ¶ˆè¯·æ±‚ç›¸å…³çš„ï¼Œåˆ©ç”¨çš„æ˜¯xhrçš„<code>abort</code>å‡½æ•°è¿›è¡Œè¯·æ±‚å–æ¶ˆ</li>
</ul>
<h2 id="å‚é“¾"><a href="#å‚é“¾" class="headerlink" title="å‚é“¾"></a>å‚é“¾</h2><ul>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzA5MjQwMzQyNw==&mid=2650744604&idx=1&sn=51d8d865c9848fd59f7763f5fb9ce789&chksm=88662490bf11ad86061ae76ff71a1177eeddab02c38d046eecd0e1ad25dc16f7591f91e9e3b2&scene=21#wechat_redirect">å­¦ä¹  axios æºç æ•´ä½“æ¶æ„ï¼Œæ‰“é€ å±äºè‡ªå·±çš„è¯·æ±‚åº“</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://www.axios-js.com/zh-cn/docs/#axios-spread-callback">axioså®˜ç½‘</a></p>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/08/14/%E6%BA%90%E7%A0%81/%E3%80%90%E6%BA%90%E7%A0%81%E3%80%91axios-%E6%B5%81%E7%A8%8B/" data-id="cmebduixk005xpwfm6gvvf3sd" data-title="axiosè¯·æ±‚æµç¨‹" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/axios-%E6%BA%90%E7%A0%81/" rel="tag">axios æºç </a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-æºç /ã€æºç ã€‘vuex-åˆå§‹åŒ–" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/08/14/%E6%BA%90%E7%A0%81/%E3%80%90%E6%BA%90%E7%A0%81%E3%80%91vuex-%E5%88%9D%E5%A7%8B%E5%8C%96/" class="article-date">
  <time class="dt-published" datetime="2025-08-14T03:18:33.944Z" itemprop="datePublished">2025-08-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/vuex-%E6%BA%90%E7%A0%81/">vuex æºç </a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/08/14/%E6%BA%90%E7%A0%81/%E3%80%90%E6%BA%90%E7%A0%81%E3%80%91vuex-%E5%88%9D%E5%A7%8B%E5%8C%96/">vuex-æµç¨‹</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>æºç ä½ç½®ï¼š<code>vuex/dist/vuex.esm.js</code>ï¼Œè¯¥æ–‡ä»¶é»˜è®¤å¯¼å‡ºäº†<code>&#123; Store, createLogger, createNamespacedHelpers, install, mapActions, mapGetters, mapMutations, mapState &#125;</code>ï¼Œåœ¨ä½¿ç”¨ vuex æ—¶ï¼Œç”¨çš„<code>vue.use(Vuex)</code>å®é™…æ‰§è¡Œçš„æ˜¯<code>install</code>æ–¹æ³•</p>
<h2 id="å¼•å…¥-vuex"><a href="#å¼•å…¥-vuex" class="headerlink" title="å¼•å…¥ vuex"></a>å¼•å…¥ vuex</h2><h3 id="install"><a href="#install" class="headerlink" title="install"></a>install</h3><ul>
<li>é¦–å…ˆåˆ¤æ–­ä¼ å…¥çš„ vue æ˜¯å¦å’Œä¹‹å‰çš„ vue ä¸€è‡´ï¼Œå¦‚æœä¸€è‡´çš„è¯ä¸”é prd ç¯å¢ƒï¼Œåˆ™ä¼šæŠ›å‡ºå¼‚å¸¸<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="title class_">Vue</span> &amp;&amp; _Vue === <span class="title class_">Vue</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&quot;production&quot;</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(</span><br><span class="line">      <span class="string">&quot;[vuex] already installed. Vue.use(Vuex) should be called only once.&quot;</span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>å°†ä¼ å…¥çš„ vue èµ‹å€¼ç»™ vuex çš„å…¨å±€å˜é‡<br>  ç”¨äºåˆ¤æ–­æ˜¯å¦å·²ç»è£…è½½å’Œå‡å°‘å…¨å±€ä½œç”¨åŸŸæŸ¥æ‰¾<br><code>Vue = _Vue;</code></li>
<li>åˆ©ç”¨ vue3 ä»¥ä¸‹çš„ mixinï¼Œå°† vuex æŒ‚è½½åˆ° vm çš„å…¨å±€ä¸Š</li>
</ul>
<h3 id="mixin"><a href="#mixin" class="headerlink" title="mixin"></a>mixin</h3><ul>
<li>é¦–å…ˆåˆ¤æ–­ vue çš„ç‰ˆæœ¬ï¼Œå¦‚æœæ˜¯åœ¨ v2 ä»¥ä¸Šï¼Œé‚£ä¹ˆç›´æ¥è°ƒç”¨<code>mixin</code>æ–¹æ³•<br><code> Vue.mixin(&#123; beforeCreate: vuexInit &#125;);</code></li>
<li>è‹¥é vue2 ä»¥ä¸Šï¼Œé‚£ä¹ˆå°±è°ƒç”¨ vue çš„ init æ–¹æ³•ã€‚å°†åˆå§‹åŒ–çš„å‡½æ•°åŠ å…¥ vue çš„ init æ–¹æ³•åˆ—è¡¨ä¸­ï¼Œå¹¶è¿›è¡Œå¾ªç¯è°ƒç”¨<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">options.<span class="property">init</span> = options.<span class="property">init</span> ? [vuexInit].<span class="title function_">concat</span>(options.<span class="property">init</span>) : vuexInit;</span><br><span class="line">_init.<span class="title function_">call</span>(<span class="variable language_">this</span>, options);</span><br></pre></td></tr></table></figure>
<ul>
<li>vuexInit æ–¹æ³•ï¼šåˆ¤æ–­å½“å‰ vue æ˜¯å¦æ˜¯ rootï¼ˆç”¨æ˜¯å¦æœ‰ parent è¿›è¡Œåˆ¤æ–­ï¼‰ã€‚è‹¥æ˜¯ rootï¼Œé‚£ä¹ˆå°±å°† store èµ‹å€¼åˆ° rootVue çš„<code>$store</code>ä¸­ï¼Œè‹¥ä¸æ˜¯ï¼Œé‚£ä¹ˆå°±å°†çˆ¶ Vue çš„<code>$store</code>ä½œä¸ºå½“å‰ vue çš„<code>$store</code><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (options.<span class="property">store</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">$store</span> =</span><br><span class="line">    <span class="keyword">typeof</span> options.<span class="property">store</span> === <span class="string">&quot;function&quot;</span> ? options.<span class="title function_">store</span>() : options.<span class="property">store</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (options.<span class="property">parent</span> &amp;&amp; options.<span class="property">parent</span>.<span class="property">$store</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">$store</span> = options.<span class="property">parent</span>.<span class="property">$store</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h2 id="åˆ›å»º-store"><a href="#åˆ›å»º-store" class="headerlink" title="åˆ›å»º store"></a>åˆ›å»º store</h2><p>åˆ›å»º store æ—¶ï¼Œæ‰§è¡Œçš„æ˜¯<code>Store</code>æ–¹æ³•</p>
<h3 id="Store"><a href="#Store" class="headerlink" title="Store"></a>Store</h3><ul>
<li><p>é¦–å…ˆè¿›è¡Œä¸€å †åˆå§‹å€¼èµ‹å€¼</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> plugins = options.<span class="property">plugins</span>;</span><br><span class="line"><span class="keyword">if</span> (plugins === <span class="keyword">void</span> <span class="number">0</span>) plugins = [];</span><br><span class="line"><span class="keyword">var</span> strict = options.<span class="property">strict</span>;</span><br><span class="line"><span class="keyword">if</span> (strict === <span class="keyword">void</span> <span class="number">0</span>) strict = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// store internal state</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">_committing</span> = <span class="literal">false</span>; <span class="comment">//æ˜¯å¦æ˜¯ä¿®æ”¹state</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">_actions</span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="literal">null</span>);</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">_actionSubscribers</span> = [];</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">_mutations</span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="literal">null</span>);</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">_wrappedGetters</span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="literal">null</span>);</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">_modules</span> = <span class="keyword">new</span> <span class="title class_">ModuleCollection</span>(options); <span class="comment">//åˆå§‹åŒ–æ³¨å†Œmodule</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">_modulesNamespaceMap</span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="literal">null</span>);</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">_subscribers</span> = [];</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">_watcherVM</span> = <span class="keyword">new</span> <span class="title class_">Vue</span>(); <span class="comment">//ç”¨äºstoreçš„watchä½¿ç”¨</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">_makeLocalGettersCache</span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="literal">null</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>å°† dispatch é‡æ–°èµ‹å€¼æ‰§è¡Œ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ref = <span class="variable language_">this</span>;</span><br><span class="line"><span class="keyword">var</span> dispatch = ref.<span class="property">dispatch</span>;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">dispatch</span> = <span class="keyword">function</span> <span class="title function_">boundDispatch</span>(<span class="params">type, payload</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> dispatch.<span class="title function_">call</span>(store, type, payload);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œè°ƒç”¨çš„è¿˜æ˜¯ store ä¸Šé¢çš„ dispatch æ–¹æ³•</p>
</li>
<li><p>å°† commit é‡æ–°èµ‹å€¼æ‰§è¡Œ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">commit</span> = <span class="keyword">function</span> <span class="title function_">boundCommit</span>(<span class="params">type, payload, options</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> commit.<span class="title function_">call</span>(store, type, payload, options);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li><p>åˆå§‹åŒ– moduleï¼ˆinstallModuleï¼‰<br>è¿™é‡Œçš„ stateï¼Œæ˜¯ç»è¿‡äº†<code>new ModuleCollection</code>æµç¨‹çš„ï¼Œå–ç”¨çš„æ˜¯ module æ ¹èŠ‚ç‚¹çš„ stateï¼Œå®é™…å°±æ˜¯é¡¹ç›®ä¸­ store çš„ module é…ç½®åˆ—è¡¨</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> state = <span class="variable language_">this</span>.<span class="property">_modules</span>.<span class="property">root</span>.<span class="property">state</span>;</span><br><span class="line"><span class="title function_">installModule</span>(<span class="variable language_">this</span>, state, [], <span class="variable language_">this</span>.<span class="property">_modules</span>.<span class="property">root</span>);</span><br></pre></td></tr></table></figure></li>
<li><p>å¯¹ store çš„<code>_vm</code>é‡æ–°èµ‹å€¼<br><code>resetStoreVM(this, state);</code></p>
</li>
<li><p>æ‰§è¡Œ plugins åˆ—è¡¨</p>
</li>
</ul>
<h3 id="module-ç›¸å…³"><a href="#module-ç›¸å…³" class="headerlink" title="module ç›¸å…³"></a>module ç›¸å…³</h3><h4 id="new-ModuleCollection"><a href="#new-ModuleCollection" class="headerlink" title="new ModuleCollection"></a>new ModuleCollection</h4><p>åˆ›å»ºäº†ä¸€ä¸ª module çš„å¯¹è±¡ï¼Œstore é‡Œé¢çš„ module å¹¶ä¸æ˜¯ç›´æ¥å½’å± store ä¸‹çš„ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œæ˜¯ ModuleCollection å‡½æ•°ï¼Œè¿™ä¸ªæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å¯¹è±¡</p>
<p>è€Œ ModuleCollection åˆæ˜¯ç”±ä¸€ä¸ªä¸ª Module å¯¹è±¡é›†åˆè€Œæˆçš„</p>
<p>ModuleCollection æœ‰ä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼Œæ ¹èŠ‚ç‚¹åˆ›å»ºå®Œæˆä¹‹åï¼Œåç»­çš„ module éƒ½ä¼šé€šè¿‡æ ¹èŠ‚ç‚¹(Module å¯¹è±¡)çš„ addChild å‡½æ•°è¿›è¡Œæ·»åŠ </p>
<p>modules ç»“æ„å¦‚ä¸‹ï¼š<br><a target="_blank" rel="noopener" href="https://imgse.com/i/pAWHwB4"><img src="https://s21.ax1x.com/2024/11/21/pAWHwB4.png" alt="pAWHwB4.png"></a></p>
<p>å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼Œç„¶åå…¶ä¸‹çš„ state æ‰æ˜¯ä¿å­˜çš„å®é™…çš„é¡¹ç›®ä¸­çš„ storeModule</p>
<ul>
<li><p>åœ¨ vuex åˆå§‹åŒ–æ—¶æ‰§è¡Œè¿™ä¸ªå‡½æ•°,è¿›å…¥ register æµç¨‹</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">ModuleCollection</span> = <span class="keyword">function</span> <span class="title function_">ModuleCollection</span>(<span class="params">rawRootModule</span>) &#123;</span><br><span class="line">  <span class="comment">// register root module (Vuex.Store options)</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">register</span>([], rawRootModule, <span class="literal">false</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li><p>åˆ›å»º module çš„æ ¹èŠ‚ç‚¹<br>è¿™é‡Œç”±äºæ˜¯ç¬¬ä¸€æ¬¡è°ƒç”¨çš„è¯ï¼Œpath é»˜è®¤å°±æ˜¯ä¸ªç©ºæ•°ç»„ï¼Œæ‰€ä»¥è°ƒç”¨ ModuleCollection çš„ register éƒ½ä¼šå…ˆåˆ›å»ºä¸€ä¸ª modules çš„æ ¹èŠ‚ç‚¹</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> newModule = <span class="keyword">new</span> <span class="title class_">Module</span>(rawModule, runtime);</span><br><span class="line"><span class="comment">// ç”±äºè°ƒç”¨registerçš„æ—¶å€™ä¼ å…¥çš„pathæ˜¯ä¸ªç©ºæ•°ç»„ï¼Œæ‰€ä»¥è¿™é‡Œä¼šæŠŠç¬¬ä¸€ä¸ªåˆ›å»ºçš„moduleä½œä¸ºæ ¹èŠ‚ç‚¹</span></span><br><span class="line"><span class="keyword">if</span> (path.<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">root</span> = newModule;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> parent = <span class="variable language_">this</span>.<span class="title function_">get</span>(path.<span class="title function_">slice</span>(<span class="number">0</span>, -<span class="number">1</span>));</span><br><span class="line">  parent.<span class="title function_">addChild</span>(path[path.<span class="property">length</span> - <span class="number">1</span>], newModule);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å¾ªç¯è°ƒç”¨ registerï¼Œå°†é¡¹ç›®ä¸­çš„ store å¾ªç¯æ”¾åœ¨æ ¹èŠ‚ç‚¹çš„ children ä¸­</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// register nested modules</span></span><br><span class="line"><span class="keyword">if</span> (rawModule.<span class="property">modules</span>) &#123;</span><br><span class="line">  <span class="title function_">forEachValue</span>(rawModule.<span class="property">modules</span>, <span class="keyword">function</span> (<span class="params">rawChildModule, key</span>) &#123;</span><br><span class="line">    <span class="comment">// è¿™é‡Œæ‰§è¡Œçš„ä¹Ÿæ˜¯ModuleCollectionçš„registerå‡½æ•°ï¼Œä¸è¿‡ç”±äºpathé‡Œé¢å·²ç»æœ‰æ•°æ®äº†ï¼Œæ‰€ä»¥è¿™é‡Œèµ°çš„æ˜¯ä¸Šä¸€æ­¥çš„elseæµç¨‹</span></span><br><span class="line">    <span class="variable language_">this</span>$1.<span class="title function_">register</span>(path.<span class="title function_">concat</span>(key), rawChildModule, runtime);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="installModule"><a href="#installModule" class="headerlink" title="installModule"></a>installModule</h3><p>è¿™ä¸ªå‡½æ•°ä¸»è¦æ˜¯ç”¨äºå°†ä¸Šä¸€æ­¥å¾—åˆ°çš„_modules è¿›è¡Œå¤„ç†ï¼Œç„¶åå¾ªç¯æ³¨å†Œ module çš„ getterã€actionã€mutation ç­‰</p>
<ul>
<li><p>å‰ç½®å¤„ç†<br>åˆ¤æ–­å½“å‰æ˜¯å¦æ˜¯æ ¹èŠ‚ç‚¹ï¼Œå¦‚æœæ˜¯éæ ¹èŠ‚ç‚¹ï¼Œå³é¡¹ç›®ä¸­çš„æ¯ä¸ª moduleï¼ŒæŠŠè¿™äº›æ”¾åœ¨æ ¹èŠ‚ç‚¹çš„ state ä¸­</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ¤æ–­æ˜¯å¦æ˜¯æ ¹èŠ‚ç‚¹ï¼Œå®é™…åªæœ‰ä»Storeä¸­åˆå§‹åŒ–çš„å…¥å£ï¼Œå…¶ä»–è¿›å…¥çš„éƒ½æ˜¯éæ ¹èŠ‚ç‚¹</span></span><br><span class="line"><span class="keyword">var</span> isRoot = !path.<span class="property">length</span>;</span><br><span class="line"><span class="keyword">var</span> namespace = store.<span class="property">_modules</span>.<span class="title function_">getNamespace</span>(path);</span><br><span class="line"></span><br><span class="line"><span class="comment">// register in namespace map</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">module</span>.<span class="property">namespaced</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    store.<span class="property">_modulesNamespaceMap</span>[namespace] &amp;&amp;</span><br><span class="line">    process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&quot;production&quot;</span></span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(</span><br><span class="line">      <span class="string">&quot;[vuex] duplicate namespace &quot;</span> +</span><br><span class="line">        namespace +</span><br><span class="line">        <span class="string">&quot; for the namespaced module &quot;</span> +</span><br><span class="line">        path.<span class="title function_">join</span>(<span class="string">&quot;/&quot;</span>)</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  store.<span class="property">_modulesNamespaceMap</span>[namespace] = <span class="variable language_">module</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// set state</span></span><br><span class="line"><span class="keyword">if</span> (!isRoot &amp;&amp; !hot) &#123;</span><br><span class="line">  <span class="keyword">var</span> parentState = <span class="title function_">getNestedState</span>(rootState, path.<span class="title function_">slice</span>(<span class="number">0</span>, -<span class="number">1</span>));</span><br><span class="line">  <span class="keyword">var</span> moduleName = path[path.<span class="property">length</span> - <span class="number">1</span>];</span><br><span class="line">  store.<span class="title function_">_withCommit</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&quot;production&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (moduleName <span class="keyword">in</span> parentState) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">warn</span>(</span><br><span class="line">          <span class="string">&#x27;[vuex] state field &quot;&#x27;</span> +</span><br><span class="line">            moduleName +</span><br><span class="line">            <span class="string">&#x27;&quot; was overridden by a module with the same name at &quot;&#x27;</span> +</span><br><span class="line">            path.<span class="title function_">join</span>(<span class="string">&quot;.&quot;</span>) +</span><br><span class="line">            <span class="string">&#x27;&quot;&#x27;</span></span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å°†moduleçš„stateéƒ½æŒ‚åˆ°æ ¹èŠ‚ç‚¹çš„stateä¸Š</span></span><br><span class="line">    <span class="title class_">Vue</span>.<span class="title function_">set</span>(parentState, moduleName, <span class="variable language_">module</span>.<span class="property">state</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å¾ªç¯æ³¨å†Œæ¯ä¸ªæ¨¡å—çš„ getterã€actionã€mutation</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="title function_">forEachMutation</span>(<span class="keyword">function</span> (<span class="params">mutation, key</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> namespacedType = namespace + key;</span><br><span class="line">  <span class="title function_">registerMutation</span>(store, namespacedType, mutation, local);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="title function_">forEachAction</span>(<span class="keyword">function</span> (<span class="params">action, key</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> type = action.<span class="property">root</span> ? key : namespace + key;</span><br><span class="line">  <span class="keyword">var</span> handler = action.<span class="property">handler</span> || action;</span><br><span class="line">  <span class="title function_">registerAction</span>(store, type, handler, local);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="title function_">forEachGetter</span>(<span class="keyword">function</span> (<span class="params">getter, key</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> namespacedType = namespace + key;</span><br><span class="line">  <span class="title function_">registerGetter</span>(store, namespacedType, getter, local);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>å¾ªç¯æ‰§è¡Œæ¯ä¸ª module<br>å¯¹é¡¹ç›®ä¸­çš„æ¯ä¸ª module æ¯æ¬¡éƒ½èµ°ä¸€ä¸ªç¬¬ä¸€æ­¥</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="title function_">forEachChild</span>(<span class="keyword">function</span> (<span class="params">child, key</span>) &#123;</span><br><span class="line">  <span class="title function_">installModule</span>(store, rootState, path.<span class="title function_">concat</span>(key), child, hot);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="resetStoreVM-this-state"><a href="#resetStoreVM-this-state" class="headerlink" title="resetStoreVM(this, state);"></a>resetStoreVM(this, state);</h3><p>è¿™ä¸ªä¸»è¦æ˜¯ç”¨äºåˆå§‹åŒ– store ä¸Šçš„<code>_vm</code>ï¼Œä»¥åŠå°† gettter æ”¾åˆ° store çš„<code>getters</code>ä¸Šï¼Œå³èµ°äº†è¿™ä¸€æ­¥ï¼Œstore é‡Œé¢æ‰æœ‰ getterã€‚dispatchã€commit ç­‰æ˜¯ç›´æ¥æŒ‚è½½åœ¨ Store.prototype ä¸Šçš„</p>
<ul>
<li><p>æŒ‚è½½ getters<br>è¿™é‡Œæ˜¯å°†_wrappedGetters çš„æ•°æ®æŒ‚è½½åˆ° store é‡Œé¢çš„ getter ä¸Šï¼Œ_wrappedGetters æ˜¯æ‰§è¡Œçš„å‡½æ•°ï¼Œgetters æ˜¯æ‰§è¡Œçš„ç»“æœ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> oldVm = store.<span class="property">_vm</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(store);</span><br><span class="line"><span class="comment">// bind store public getters</span></span><br><span class="line">store.<span class="property">getters</span> = &#123;&#125;;</span><br><span class="line"><span class="comment">// reset local getters cache</span></span><br><span class="line">store.<span class="property">_makeLocalGettersCache</span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="literal">null</span>);</span><br><span class="line"><span class="keyword">var</span> wrappedGetters = store.<span class="property">_wrappedGetters</span>;</span><br><span class="line"><span class="keyword">var</span> computed = &#123;&#125;;</span><br><span class="line"><span class="title function_">forEachValue</span>(wrappedGetters, <span class="keyword">function</span> (<span class="params">fn, key</span>) &#123;</span><br><span class="line">  <span class="comment">// use computed to leverage its lazy-caching mechanism</span></span><br><span class="line">  <span class="comment">// direct inline function use will lead to closure preserving oldVm.</span></span><br><span class="line">  <span class="comment">// using partial to return function with only arguments preserved in closure environment.</span></span><br><span class="line">  computed[key] = <span class="title function_">partial</span>(fn, store);</span><br><span class="line">  <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(store.<span class="property">getters</span>, key, &#123;</span><br><span class="line">    <span class="attr">get</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> store.<span class="property">_vm</span>[key];</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">enumerable</span>: <span class="literal">true</span>, <span class="comment">// for local getters</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li><p>å¯¹ store çš„_vm é‡æ–°èµ‹å€¼<br>è¿™é‡Œçš„ state æ˜¯_modules æ ¹èŠ‚ç‚¹çš„ state</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> silent = <span class="title class_">Vue</span>.<span class="property">config</span>.<span class="property">silent</span>;</span><br><span class="line"><span class="comment">// æš‚æ—¶å°†Vueè®¾ä¸ºé™é»˜æ¨¡å¼ï¼Œé¿å…æŠ¥å‡ºç”¨æˆ·åŠ è½½çš„æŸäº›æ’ä»¶è§¦å‘çš„è­¦å‘Š</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="property">config</span>.<span class="property">silent</span> = <span class="literal">true</span>;</span><br><span class="line">store.<span class="property">_vm</span> = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  <span class="attr">data</span>: &#123;</span><br><span class="line">    <span class="attr">$$state</span>: state,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">computed</span>: computed,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// æ¢å¤Vueçš„æ¨¡å¼</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="property">config</span>.<span class="property">silent</span> = silent;</span><br><span class="line"><span class="comment">// å¦‚æœè®¾ç½®äº†ä¸¥æ ¼æ¨¡å¼</span></span><br><span class="line"><span class="keyword">if</span> (store.<span class="property">strict</span>) &#123;</span><br><span class="line">  <span class="title function_">enableStrictMode</span>(store);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>é”€æ¯è€çš„ vm</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (oldVm) &#123;</span><br><span class="line">  <span class="keyword">if</span> (hot) &#123;</span><br><span class="line">    <span class="comment">// dispatch changes in all subscribed watchers</span></span><br><span class="line">    <span class="comment">// to force getter re-evaluation for hot reloading.</span></span><br><span class="line">    store.<span class="title function_">_withCommit</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      oldVm.<span class="property">_data</span>.<span class="property">$$state</span> = <span class="literal">null</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title class_">Vue</span>.<span class="title function_">nextTick</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> oldVm.$destroy();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="æ¨¡å—å‡½æ•°æ³¨å†Œ"><a href="#æ¨¡å—å‡½æ•°æ³¨å†Œ" class="headerlink" title="æ¨¡å—å‡½æ•°æ³¨å†Œ"></a>æ¨¡å—å‡½æ•°æ³¨å†Œ</h3><p>åœ¨installModuleä¸­ï¼Œä¼šå¯¹æ¯ä¸ªæ¨¡å—è¿›è¡Œmutationã€actionã€getterçš„æ³¨å†Œ</p>
<ul>
<li><p>registerMutation<br>  è°ƒç”¨æ–¹ï¼š<br>  module.forEachMutationæ˜¯å°†_modulesä¸­çš„mutationå–å‡ºæ¥ï¼Œç„¶åå¾ªç¯æ‰§è¡Œå›è°ƒå‡½æ•°</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="title function_">forEachMutation</span>(<span class="keyword">function</span> (<span class="params">mutation, key</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> namespacedType = namespace + key;</span><br><span class="line">    <span class="title function_">registerMutation</span>(store, namespacedType, mutation, local);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line"><span class="comment">// this._rawModule.mutations.foreach()</span></span><br></pre></td></tr></table></figure>
<p>  è·å–åˆ°å¯¹åº”çš„muationï¼Œè¿™é‡Œçš„åˆ›å»ºstoreçš„_muationçš„åœ°æ–¹</p>
<p>  å¦‚æœæ²¡æœ‰åŒåçš„muationï¼Œé‚£ä¹ˆå°±åˆ›å»ºå‡ºï¼›ç„¶åå†å°†é¡¹ç›®çš„muationåŒ…è£…ä¸€ä¸‹ï¼Œå¢åŠ åˆ°storeçš„_mutationä¸­</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">registerMutation</span> (<span class="params">store, type, handler, local</span>) &#123;</span><br><span class="line"><span class="comment">//    åˆ›å»ºmuationçš„åœ°æ–¹ store._mutations[type] = []</span></span><br><span class="line"><span class="keyword">var</span> entry = store.<span class="property">_mutations</span>[type] || (store.<span class="property">_mutations</span>[type] = []);</span><br><span class="line">entry.<span class="title function_">push</span>(<span class="keyword">function</span> <span class="title function_">wrappedMutationHandler</span> (<span class="params">payload</span>) &#123;</span><br><span class="line">    <span class="comment">// handlerå°±æ˜¯å®é™…é¡¹ç›®ä¸­çš„çš„muationï¼Œå°†æ‰§è¡Œçš„thisç»‘å®šåˆ°storeä¸­ï¼Œ</span></span><br><span class="line">    <span class="comment">// localæ˜¯`module.context`ï¼Œæ˜¯åœ¨åˆ›å»ºModuleçš„æ—¶å€™ï¼Œä¼ å…¥çš„ </span></span><br><span class="line">    <span class="comment">// installModule ä¸­çš„ var local = module.context = makeLocalContext(store, namespace, path);</span></span><br><span class="line">    <span class="comment">// å³åœ¨ä¸Šä¸€æ­¥ä¸­ï¼Œæ¯ä¸ªModuleåˆ›å»ºæ—¶çš„</span></span><br><span class="line">    <span class="comment">//  ModuleCollectionæ ¹èŠ‚ç‚¹ï¼Œå…¶ä¸‹_childrené‡Œé¢çš„Module</span></span><br><span class="line">    handler.<span class="title function_">call</span>(store, local.<span class="property">state</span>, payload);</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  <a target="_blank" rel="noopener" href="https://imgse.com/i/pAf1YiF"><img src="https://s21.ax1x.com/2024/11/22/pAf1YiF.png" alt="pAf1YiF.png"></a></p>
<p>  æ³¨æ„ï¼Œvuexä¸­çš„muationå’Œdispatchéƒ½æ˜¯æ•°ç»„ï¼Œåªæœ‰getteræ˜¯éæ•°ç»„</p>
</li>
<li><p>å¹³æ—¶åœ¨æ‰§è¡Œcommitæ—¶çš„é¡ºåº</p>
<ul>
<li>Storeåˆå§‹åŒ–ä¸­çš„<code>this.commit</code></li>
<li>StoreåŸå‹é“¾ä¸­çš„<code>Store.prototype.commit</code></li>
<li>æ³¨å†Œmutationä¸­ï¼ˆä¸Šä¸€æ­¥ï¼‰çš„<code>wrappedMutationHandler</code></li>
</ul>
</li>
<li><p>registerAction<br>  module.forEachActionæ˜¯å°†_modulesä¸­çš„actionï¼ˆaction.handler || actionï¼‰å–å‡ºæ¥ï¼Œç„¶åå¾ªç¯æ‰§è¡Œå›è°ƒå‡½æ•°</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">function</span> <span class="title function_">registerAction</span> (<span class="params">store, type, handler, local</span>) &#123;</span><br><span class="line">  <span class="comment">// è·å–åˆ°å¯¹åº”çš„actionå‡½æ•°ï¼Œå³é¡¹ç›®ä¸­å®é™…å†™çš„dispatchå›è°ƒ</span></span><br><span class="line">  <span class="keyword">var</span> entry = store.<span class="property">_actions</span>[type] || (store.<span class="property">_actions</span>[type] = []);</span><br><span class="line">  <span class="comment">// å› ä¸ºactionå’Œmutationéƒ½æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ‰€ä»¥ç”¨çš„æ˜¯pushæ–¹æ³•ï¼Œå°†å¯¹åº”çš„dispatchTypeæ”¾åˆ°æ•°ç»„ä¸­</span></span><br><span class="line">  <span class="comment">// è¿™é‡Œå°±æ˜¯è°ƒç”¨é¡¹ç›®ä¸­dispatchå›è°ƒï¼Œåœ¨è°ƒç”¨ä¹‹å‰åŒ…äº†ä¸€å±‚ï¼Œå°†æ‰§è¡Œä½œç”¨äºç»‘å®šåˆ°storeä¸­ï¼Œ</span></span><br><span class="line">  <span class="comment">// dispatchä¸­çš„ä¸¤ä¸ªå‚æ•°ä¹Ÿæ˜¯åœ¨è¿™é‡Œè¿›è¡Œä¼ é€’çš„</span></span><br><span class="line">  entry.<span class="title function_">push</span>(<span class="keyword">function</span> <span class="title function_">wrappedActionHandler</span> (<span class="params">payload</span>) &#123;</span><br><span class="line">    <span class="comment">// dispathçš„rootå°±æ˜¯ç¬¬äºŒä¸ªå‚æ•°ï¼Œè°ƒç”¨æ—¶ä¼ é€’çš„æ•°æ®æ˜¯payload</span></span><br><span class="line">    <span class="keyword">var</span> res = handler.<span class="title function_">call</span>(store, &#123;</span><br><span class="line">      <span class="attr">dispatch</span>: local.<span class="property">dispatch</span>,</span><br><span class="line">      <span class="attr">commit</span>: local.<span class="property">commit</span>,</span><br><span class="line">      <span class="attr">getters</span>: local.<span class="property">getters</span>,</span><br><span class="line">      <span class="attr">state</span>: local.<span class="property">state</span>,</span><br><span class="line">      <span class="attr">rootGetters</span>: store.<span class="property">getters</span>,</span><br><span class="line">      <span class="attr">rootState</span>: store.<span class="property">state</span></span><br><span class="line">    &#125;, payload);</span><br><span class="line">    <span class="comment">// dispatchæ˜¯promiseçš„å¤„ç†</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_">isPromise</span>(res)) &#123;</span><br><span class="line">      res = <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(res);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (store.<span class="property">_devtoolHook</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> res.<span class="title function_">catch</span>(<span class="keyword">function</span> (<span class="params">err</span>) &#123;</span><br><span class="line">        store.<span class="property">_devtoolHook</span>.<span class="title function_">emit</span>(<span class="string">&#x27;vuex:error&#x27;</span>, err);</span><br><span class="line">        <span class="keyword">throw</span> err</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> res</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å¹³æ—¶åœ¨æ‰§è¡Œdispatchæ—¶çš„é¡ºåº</p>
<ul>
<li>Storeåˆå§‹åŒ–ä¸­çš„<code>this.dispatch</code></li>
<li>StoreåŸå‹é“¾ä¸­çš„<code>Store.prototype.dispatch</code></li>
<li>æ³¨å†Œdispatchä¸­ï¼ˆä¸Šä¸€æ­¥ï¼‰çš„<code>registerAction</code>ä¸­entryåŒ…è¿‡çš„å‡½æ•°</li>
</ul>
</li>
<li><p>registerGetter<br>  module.forEachActionæ˜¯å°†_modulesä¸­çš„getterså–å‡ºæ¥ï¼Œç„¶åå¾ªç¯æ‰§è¡Œå›è°ƒå‡½æ•°<br>  rawGetterå’Œactionç¬¬ä¸‰ä¸ªå‚æ•°ä¸€æ ·ï¼Œéƒ½æ˜¯getterçš„å›è°ƒ</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">function</span> <span class="title function_">registerGetter</span> (<span class="params">store, type, rawGetter, local</span>) &#123;</span><br><span class="line">    <span class="comment">// gettterä¸èƒ½æœ‰é‡å¤å‘½åçš„ï¼Œæ‰€ä»¥ä¼šæŠ¥é”™ï¼Œè¿™ä¸ªæ˜¯å’Œactionã€mutationä¸åŒçš„ç‚¹</span></span><br><span class="line">  <span class="keyword">if</span> (store.<span class="property">_wrappedGetters</span>[type]) &#123;</span><br><span class="line">    <span class="keyword">if</span> ((process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&#x27;production&#x27;</span>)) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>((<span class="string">&quot;[vuex] duplicate getter key: &quot;</span> + type));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// storeå°±æ˜¯Storeï¼Œæ˜¯åˆå§‹åˆ›å»ºçš„</span></span><br><span class="line">  store.<span class="property">_wrappedGetters</span>[type] = <span class="keyword">function</span> <span class="title function_">wrappedGetter</span> (<span class="params">store</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">rawGetter</span>(</span><br><span class="line">      local.<span class="property">state</span>, <span class="comment">// local state</span></span><br><span class="line">      local.<span class="property">getters</span>, <span class="comment">// local getters</span></span><br><span class="line">      store.<span class="property">state</span>, <span class="comment">// root state</span></span><br><span class="line">      store.<span class="property">getters</span> <span class="comment">// root getters</span></span><br><span class="line">    )</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å¹³æ—¶åœ¨æ‰§è¡Œgetteræ—¶çš„é¡ºåº</p>
<ul>
<li>å…ˆéå†æ‰§è¡Œä¸€æ¬¡<code>module.forEachGetter</code></li>
<li>è°ƒç”¨çš„æ—¶å€™æ‰§è¡ŒresetStoreVmä¸­ï¼Œå°†getterè°ƒç”¨<code>store._vm[key]</code>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(store.<span class="property">getters</span>, key, &#123;</span><br><span class="line">  <span class="attr">get</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123; </span><br><span class="line">    <span class="keyword">debugger</span></span><br><span class="line">    <span class="keyword">return</span> store.<span class="property">_vm</span>[key];</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">enumerable</span>: <span class="literal">true</span> <span class="comment">// for local getters</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>æ‰§è¡ŒregisterGetterä¸­å°è£…å¥½çš„getter</li>
</ul>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/08/14/%E6%BA%90%E7%A0%81/%E3%80%90%E6%BA%90%E7%A0%81%E3%80%91vuex-%E5%88%9D%E5%A7%8B%E5%8C%96/" data-id="cmebduixm0064pwfm21fkgrep" data-title="vuex-æµç¨‹" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vuex-%E6%BA%90%E7%A0%81/" rel="tag">vuex æºç </a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-æºç /ã€æºç ã€‘axios-æ‹¦æˆªå™¨" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/08/14/%E6%BA%90%E7%A0%81/%E3%80%90%E6%BA%90%E7%A0%81%E3%80%91axios-%E6%8B%A6%E6%88%AA%E5%99%A8/" class="article-date">
  <time class="dt-published" datetime="2025-08-14T03:18:33.939Z" itemprop="datePublished">2025-08-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/axios-%E6%BA%90%E7%A0%81/">axios æºç </a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/08/14/%E6%BA%90%E7%A0%81/%E3%80%90%E6%BA%90%E7%A0%81%E3%80%91axios-%E6%8B%A6%E6%88%AA%E5%99%A8/">axiosæ‹¦æˆªå™¨åŸç†</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="æ‹¦æˆªå™¨ä½¿ç”¨"><a href="#æ‹¦æˆªå™¨ä½¿ç”¨" class="headerlink" title="æ‹¦æˆªå™¨ä½¿ç”¨"></a>æ‹¦æˆªå™¨ä½¿ç”¨</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// http request æ‹¦æˆªå™¨</span></span><br><span class="line">axios.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">config: any</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è¯·æ±‚æ‹¦æˆªå™¨&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> config;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(err);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// http response æ‹¦æˆªå™¨</span></span><br><span class="line">axios.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å“åº”æ‹¦æˆªå™¨&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> response.<span class="property">data</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">onError</span>(<span class="string">&quot;ç³»ç»Ÿå¼‚å¸¸ï¼&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">axios.<span class="title function_">get</span>(url).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è¯·æ±‚ç»“æœ&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// è¾“å‡ºç»“æœï¼š</span></span><br><span class="line"><span class="comment">// è¯·æ±‚æ‹¦æˆªå™¨</span></span><br><span class="line"><span class="comment">// è¯·æ±‚ç»“æœ</span></span><br><span class="line"><span class="comment">// å“åº”æ‹¦æˆªå™¨</span></span><br></pre></td></tr></table></figure>

<h2 id="å…¥å£ä»£ç "><a href="#å…¥å£ä»£ç " class="headerlink" title="å…¥å£ä»£ç "></a>å…¥å£ä»£ç </h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// /lib/core/axios.js</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Axios</span>(<span class="params">instanceConfig</span>) &#123;</span><br><span class="line">  <span class="comment">// åˆ†åˆ«è®¾ç½®è¯·æ±‚å’Œå“åº”æ‹¦æˆªå™¨ç®¡ç†</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">interceptors</span> = &#123;</span><br><span class="line">    <span class="attr">request</span>: <span class="keyword">new</span> <span class="title class_">InterceptorManager</span>(),</span><br><span class="line">    <span class="attr">response</span>: <span class="keyword">new</span> <span class="title class_">InterceptorManager</span>(),</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Axios</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">request</span> = <span class="keyword">function</span> <span class="title function_">request</span>(<span class="params">configOrUrl, config</span>) &#123;</span><br><span class="line">  <span class="comment">// ä¸ç›¸å…³ä»£ç ...</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// filter out skipped interceptors</span></span><br><span class="line">  <span class="comment">// è¯·æ±‚æ‹¦æˆªå™¨ç›¸å…³</span></span><br><span class="line">  <span class="keyword">var</span> requestInterceptorChain = [];</span><br><span class="line">  <span class="keyword">var</span> synchronousRequestInterceptors = <span class="literal">true</span>;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span> <span class="title function_">unshiftRequestInterceptors</span>(<span class="params"></span></span><br><span class="line"><span class="params">    interceptor</span></span><br><span class="line"><span class="params">  </span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">      <span class="keyword">typeof</span> interceptor.<span class="property">runWhen</span> === <span class="string">&quot;function&quot;</span> &amp;&amp;</span><br><span class="line">      interceptor.<span class="title function_">runWhen</span>(config) === <span class="literal">false</span></span><br><span class="line">    ) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    synchronousRequestInterceptors =</span><br><span class="line">      synchronousRequestInterceptors &amp;&amp; interceptor.<span class="property">synchronous</span>;</span><br><span class="line"></span><br><span class="line">    requestInterceptorChain.<span class="title function_">unshift</span>(</span><br><span class="line">      interceptor.<span class="property">fulfilled</span>,</span><br><span class="line">      interceptor.<span class="property">rejected</span></span><br><span class="line">    );</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// å“åº”æ‹¦æˆªå™¨ç›¸å…³ä»£ç </span></span><br><span class="line">  <span class="keyword">var</span> responseInterceptorChain = [];</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span> <span class="title function_">pushResponseInterceptors</span>(<span class="params"></span></span><br><span class="line"><span class="params">    interceptor</span></span><br><span class="line"><span class="params">  </span>) &#123;</span><br><span class="line">    responseInterceptorChain.<span class="title function_">push</span>(interceptor.<span class="property">fulfilled</span>, interceptor.<span class="property">rejected</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> promise;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!synchronousRequestInterceptors) &#123;</span><br><span class="line">    <span class="keyword">var</span> chain = [dispatchRequest, <span class="literal">undefined</span>];</span><br><span class="line"></span><br><span class="line">    <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">unshift</span>.<span class="title function_">apply</span>(chain, requestInterceptorChain);</span><br><span class="line">    chain = chain.<span class="title function_">concat</span>(responseInterceptorChain);</span><br><span class="line"></span><br><span class="line">    promise = <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(config);</span><br><span class="line">    <span class="keyword">while</span> (chain.<span class="property">length</span>) &#123;</span><br><span class="line">      promise = promise.<span class="title function_">then</span>(chain.<span class="title function_">shift</span>(), chain.<span class="title function_">shift</span>());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> promise;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> newConfig = config;</span><br><span class="line">  <span class="keyword">while</span> (requestInterceptorChain.<span class="property">length</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> onFulfilled = requestInterceptorChain.<span class="title function_">shift</span>();</span><br><span class="line">    <span class="keyword">var</span> onRejected = requestInterceptorChain.<span class="title function_">shift</span>();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      newConfig = <span class="title function_">onFulfilled</span>(newConfig);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="title function_">onRejected</span>(error);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    promise = <span class="title function_">dispatchRequest</span>(newConfig);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (responseInterceptorChain.<span class="property">length</span>) &#123;</span><br><span class="line">    promise = promise.<span class="title function_">then</span>(</span><br><span class="line">      responseInterceptorChain.<span class="title function_">shift</span>(),</span><br><span class="line">      responseInterceptorChain.<span class="title function_">shift</span>()</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> promise;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="æ‹¦æˆªå™¨ç®¡ç†"><a href="#æ‹¦æˆªå™¨ç®¡ç†" class="headerlink" title="æ‹¦æˆªå™¨ç®¡ç†"></a>æ‹¦æˆªå™¨ç®¡ç†</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// /lib/core/InterceptorManager.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> utils = <span class="built_in">require</span>(<span class="string">&quot;./../utils&quot;</span>);</span><br><span class="line"><span class="comment">// å›è°ƒæ•°ç»„</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">InterceptorManager</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">handlers</span> = [];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å°†æ–°çš„æ‹¦æˆªå™¨æ·»åŠ åˆ°å›è°ƒä¸­</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Function</span>&#125; fulfilled The function to handle `then` for a `Promise`</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Function</span>&#125; rejected The function to handle `reject` for a `Promise`</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">Number</span>&#125; An ID used to remove interceptor later</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">InterceptorManager</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">use</span> = <span class="keyword">function</span> <span class="title function_">use</span>(<span class="params">fulfilled, rejected, options</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">handlers</span>.<span class="title function_">push</span>(&#123;</span><br><span class="line">    <span class="attr">fulfilled</span>: fulfilled,</span><br><span class="line">    <span class="attr">rejected</span>: rejected,</span><br><span class="line">    <span class="attr">synchronous</span>: options ? options.<span class="property">synchronous</span> : <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">runWhen</span>: options ? options.<span class="property">runWhen</span> : <span class="literal">null</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">handlers</span>.<span class="property">length</span> - <span class="number">1</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆ é™¤æ‹¦æˆªå™¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Number</span>&#125; id The ID that was returned by `use`</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">InterceptorManager</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">eject</span> = <span class="keyword">function</span> <span class="title function_">eject</span>(<span class="params">id</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">handlers</span>[id]) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">handlers</span>[id] = <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * éå†æ‹¦æˆªå™¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Function</span>&#125; fn The function to call for each interceptor</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">InterceptorManager</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">forEach</span> = <span class="keyword">function</span> <span class="title function_">forEach</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">  utils.<span class="title function_">forEach</span>(<span class="variable language_">this</span>.<span class="property">handlers</span>, <span class="keyword">function</span> <span class="title function_">forEachHandler</span>(<span class="params">h</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (h !== <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="title function_">fn</span>(h);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title class_">InterceptorManager</span>;</span><br></pre></td></tr></table></figure>

<p>æ€»ç»“ï¼š</p>
<ul>
<li><code>InterceptorManager</code>æ˜¯ä¸€ä¸ªç®¡ç†æ‹¦æˆªå™¨çš„ç±»ï¼Œå®ƒåŒ…å«ä¸€ä¸ª<code>handlers</code>æ•°ç»„ï¼Œç”¨äºå­˜å‚¨æ‹¦æˆªå™¨ã€‚<code>use</code>æ–¹æ³•ç”¨äºæ·»åŠ æ‹¦æˆªå™¨ï¼Œ<code>eject</code>æ–¹æ³•ç”¨äºåˆ é™¤æ‹¦æˆªå™¨ï¼Œ<code>forEach</code>æ–¹æ³•ç”¨äºéå†æ‹¦æˆªå™¨ã€‚</li>
<li>åœ¨ä½¿ç”¨æ‹¦æˆªå™¨æ—¶ï¼Œè°ƒç”¨çš„<code>use</code>å®é™…ä¸Šæ˜¯è°ƒç”¨çš„<code>InterceptorManager</code>çš„<code>use</code>æ–¹æ³•</li>
</ul>
<h2 id="è¯·æ±‚æ‹¦æˆªå™¨"><a href="#è¯·æ±‚æ‹¦æˆªå™¨" class="headerlink" title="è¯·æ±‚æ‹¦æˆªå™¨"></a>è¯·æ±‚æ‹¦æˆªå™¨</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> requestInterceptorChain = [];</span><br><span class="line"><span class="keyword">var</span> synchronousRequestInterceptors = <span class="literal">true</span>;</span><br><span class="line"><span class="comment">// this.interceptorsæŒ‡å‘çš„æ˜¯åœ¨æ–‡ä»¶`/lib/core/Axios.js`ä¸­Axiosæ–¹æ³•ä¸­å®šä¹‰çš„`this.interceptors`</span></span><br><span class="line"><span class="comment">// this.interceptorsæ˜¯ä¸€ä¸ªInterceptorManagerå®ä¾‹</span></span><br><span class="line"><span class="comment">// åœ¨å¤–éƒ¨(é¡¹ç›®)è°ƒç”¨axios.interceptors.requestçš„æ—¶å€™ï¼Œä¼šæŠŠå¯¹åº”çš„è¯·æ±‚å›è°ƒåŠ å…¥åˆ°this.interceptors.requestçš„handlersä¸­</span></span><br><span class="line"><span class="comment">// è¿™é‡Œçš„this.interceptors.requestå®é™…è°ƒç”¨çš„æ˜¯InterceptorManagerçš„`forEach`æ–¹æ³•ï¼Œæ‰€ä»¥è¿™é‡Œçš„foreachå®é™…æ˜¯éå†this.interceptors.requestçš„handlersæ•°ç»„</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span> <span class="title function_">unshiftRequestInterceptors</span>(<span class="params"></span></span><br><span class="line"><span class="params">  interceptor</span></span><br><span class="line"><span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    <span class="keyword">typeof</span> interceptor.<span class="property">runWhen</span> === <span class="string">&quot;function&quot;</span> &amp;&amp;</span><br><span class="line">    interceptor.<span class="title function_">runWhen</span>(config) === <span class="literal">false</span></span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// åˆ¤æ–­è¯·æ±‚æ‹¦æˆªå™¨ä¸­æ˜¯å¦æœ‰å¼‚æ­¥çš„å‡½æ•°</span></span><br><span class="line">  synchronousRequestInterceptors =</span><br><span class="line">    synchronousRequestInterceptors &amp;&amp; interceptor.<span class="property">synchronous</span>;</span><br><span class="line">  <span class="comment">// å°†è¯·æ±‚æ‹¦æˆªå™¨çš„å›è°ƒæ–¹æ³•åŠ å…¥åˆ°requestInterceptorChainä¸­ï¼Œæ³¨æ„è¿™é‡Œå…¶å®æ˜¯ä»¥requestçš„é¡ºåºå€’å™äº†ä¸€æ¬¡</span></span><br><span class="line">  <span class="comment">// å³å¦‚æœrequest.handlers = [1,2,3]</span></span><br><span class="line">  <span class="comment">// é‚£ä¹ˆrequestInterceptorChain = [3,2,1]</span></span><br><span class="line">  requestInterceptorChain.<span class="title function_">unshift</span>(interceptor.<span class="property">fulfilled</span>, interceptor.<span class="property">rejected</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// å¦‚æœè¯·æ±‚æ‹¦æˆªå™¨ä¸­æœ‰å¼‚æ­¥çš„å‡½æ•°</span></span><br><span class="line"><span class="keyword">if</span> (!synchronousRequestInterceptors) &#123;</span><br><span class="line">  <span class="comment">// dispatchRequestæ˜¯å®é™…çš„è¯·æ±‚</span></span><br><span class="line">    <span class="keyword">var</span> chain = [dispatchRequest, <span class="literal">undefined</span>];</span><br><span class="line">    <span class="comment">// chainç»„æˆä¸€ä¸ª[è¯·æ±‚æ‹¦æˆªå™¨1æˆåŠŸï¼Œ è¯·æ±‚æ‹¦æˆªå™¨1å¤±è´¥ï¼Œè¯·æ±‚æ‹¦æˆªå™¨2æˆåŠŸï¼Œè¯·æ±‚æ‹¦æˆªå™¨2å¤±è´¥ï¼Œå®é™…è¯·æ±‚ï¼Œå“åº”æ‹¦æˆªå™¨1æˆåŠŸï¼Œå“åº”æ‹¦æˆªå™¨1å¤±è´¥ï¼Œå“åº”æ‹¦æˆªå™¨2æˆåŠŸï¼Œå“åº”æ‹¦æˆªå™¨2å¤±è´¥]</span></span><br><span class="line">    <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">unshift</span>.<span class="title function_">apply</span>(chain, requestInterceptorChain);</span><br><span class="line">    chain = chain.<span class="title function_">concat</span>(responseInterceptorChain);</span><br><span class="line"></span><br><span class="line">    promise = <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(config);</span><br><span class="line">    <span class="keyword">while</span> (chain.<span class="property">length</span>) &#123;</span><br><span class="line">      <span class="comment">// æ‰§è¡Œé¡ºåºåº”è¯¥ä¸ºï¼š</span></span><br><span class="line">      <span class="comment">// promise.then(è¯·æ±‚æ‹¦æˆªå™¨1æˆåŠŸï¼Œ è¯·æ±‚æ‹¦æˆªå™¨1å¤±è´¥)</span></span><br><span class="line">      <span class="comment">// promise.then(è¯·æ±‚æ‹¦æˆªå™¨2æˆåŠŸï¼Œè¯·æ±‚æ‹¦æˆªå™¨2å¤±è´¥)</span></span><br><span class="line">      <span class="comment">// promise.then(å®é™…è¯·æ±‚, undefined)</span></span><br><span class="line">      <span class="comment">// promise.then(å“åº”æ‹¦æˆªå™¨1æˆåŠŸï¼Œå“åº”æ‹¦æˆªå™¨1å¤±è´¥)</span></span><br><span class="line">      <span class="comment">// promise.then(å“åº”æ‹¦æˆªå™¨2æˆåŠŸï¼Œå“åº”æ‹¦æˆªå™¨2å¤±è´¥)</span></span><br><span class="line">      promise = promise.<span class="title function_">then</span>(chain.<span class="title function_">shift</span>(), chain.<span class="title function_">shift</span>());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> promise;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ— å…³ä»£ç ...</span></span><br><span class="line"><span class="comment">// å°†åŸæœ‰çš„è¯·æ±‚é…ç½®æµ…æ‹·è´ä¸€ä»½å‡ºæ¥</span></span><br><span class="line"><span class="keyword">var</span> newConfig = config;</span><br><span class="line"><span class="comment">// å¾ªç¯æ‰§è¡ŒrequestInterceptorChainä¸­çš„å›è°ƒæ–¹æ³•;</span></span><br><span class="line"><span class="keyword">while</span> (requestInterceptorChain.<span class="property">length</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> onFulfilled = requestInterceptorChain.<span class="title function_">shift</span>();</span><br><span class="line">  <span class="keyword">var</span> onRejected = requestInterceptorChain.<span class="title function_">shift</span>();</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// æ‰§è¡Œæ–°çš„è¯·æ±‚æ‹¦æˆªå™¨ï¼Œå¹¶å°†è¯·æ±‚æ‹¦æˆªå™¨çš„ç»“æœä½œä¸ºä¸‹ä¸€æ¬¡æ‰§è¡Œè¯·æ±‚æ‹¦æˆªå™¨çš„å‚æ•°</span></span><br><span class="line">    newConfig = <span class="title function_">onFulfilled</span>(newConfig);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœè¯·æ±‚æ‹¦æˆªå™¨ä¸­æŠ¥é”™ï¼Œé‚£ä¹ˆä¸æ‰§è¡Œåç»­çš„æ“ä½œ</span></span><br><span class="line">    <span class="title function_">onRejected</span>(error);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ‰§è¡Œè¯·æ±‚</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  promise = <span class="title function_">dispatchRequest</span>(newConfig);</span><br><span class="line">&#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ€»ç»“ï¼š</p>
<ul>
<li>è¯·æ±‚æ‹¦æˆªå™¨çš„æ‰§è¡Œé¡ºåºæ˜¯ä¸ä¹¦å†™é¡ºåºç›¸åçš„<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">axios.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">config: any</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è¯·æ±‚æ‹¦æˆªå™¨1&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> config;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(err);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line">axios.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">config: any</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è¯·æ±‚æ‹¦æˆªå™¨2&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> config;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(err);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"><span class="comment">// æ‰§è¡Œç»“æœï¼š</span></span><br><span class="line"><span class="comment">// è¯·æ±‚æ‹¦æˆªå™¨2</span></span><br><span class="line"><span class="comment">// è¯·æ±‚æ‹¦æˆªå™¨1</span></span><br></pre></td></tr></table></figure></li>
<li>è¯·æ±‚æ‹¦æˆªå™¨ä¸­å¦‚æœæŠ¥é”™ï¼Œé‚£ä¹ˆä¸æ‰§è¡Œåç»­çš„æ“ä½œ</li>
<li>å¦‚æœè¯·æ±‚æ‹¦æˆªå™¨ä¸­ä¼ å…¥<code>synchronous=false</code>è¡¨ç¤ºä¸ºå¼‚æ­¥è¯·æ±‚ï¼Œé»˜è®¤éƒ½æ˜¯å¼‚æ­¥è¯·æ±‚å¤„ç†æ“ä½œ</li>
<li>å¦‚æœæ˜¯å¼‚æ­¥è¯·æ±‚ï¼Œaxiosæ˜¯å’Œç›¸åº”æ‹¦æˆªå™¨ä¸€æ ·çš„å¤„ç†ï¼Œç”¨PromiseåŒ…è£¹äº†ä¸€å±‚</li>
<li>å¦‚æœæ˜¯åŒæ­¥è¯·æ±‚ï¼Œé‚£ä¹ˆæ˜¯ç›´æ¥å¾ªç¯æ‰§è¡Œçš„</li>
</ul>
<h2 id="å“åº”æ‹¦æˆªå™¨"><a href="#å“åº”æ‹¦æˆªå™¨" class="headerlink" title="å“åº”æ‹¦æˆªå™¨"></a>å“åº”æ‹¦æˆªå™¨</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">  <span class="title class_">Axios</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">request</span> = <span class="keyword">function</span> <span class="title function_">request</span>(<span class="params">configOrUrl, config</span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="comment">// å“åº”æ‹¦æˆªå™¨æ•°ç»„</span></span><br><span class="line">  <span class="keyword">var</span> responseInterceptorChain = [];</span><br><span class="line">  <span class="comment">// æŒ‰ä¹¦å†™é¡ºåºå°†å“åº”æ‹¦æˆªå™¨åŠ å…¥åˆ°æ•°ç»„ä¸­</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span> <span class="title function_">pushResponseInterceptors</span>(<span class="params">interceptor</span>) &#123;</span><br><span class="line">    responseInterceptorChain.<span class="title function_">push</span>(interceptor.<span class="property">fulfilled</span>, interceptor.<span class="property">rejected</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ— å…³ä»£ç ...</span></span><br><span class="line">  <span class="keyword">var</span> promise;</span><br><span class="line">  <span class="comment">// æ‰§è¡ŒçœŸå®è¯·æ±‚</span></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    promise = <span class="title function_">dispatchRequest</span>(newConfig);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// æŒ‰ä¹¦å†™é¡ºåºæ‰§è¡Œå“åº”æ‹¦æˆªå™¨ï¼Œå¹¶ä¸”æ˜¯ä»¥å¼‚æ­¥æ‰§è¡Œçš„</span></span><br><span class="line">  <span class="keyword">while</span> (responseInterceptorChain.<span class="property">length</span>) &#123;</span><br><span class="line">    promise = promise.<span class="title function_">then</span>(responseInterceptorChain.<span class="title function_">shift</span>(), responseInterceptorChain.<span class="title function_">shift</span>());</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> promise;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>æ€»ç»“ï¼š</p>
<ul>
<li>ä¸è¯·æ±‚æ‹¦æˆªå™¨æ‰§è¡Œé¡ºåºä¸åŒï¼Œå“åº”æ‹¦æˆªå™¨æŒ‰ä¹¦å†™é¡ºåºæ‰§è¡Œ</li>
<li>å“åº”æ‹¦æˆªå™¨æ˜¯é»˜è®¤ç”¨å¼‚æ­¥å‡½æ•°åŒ…è£¹äº†ä¸€å±‚ï¼Œè€Œè¯·æ±‚æ‹¦æˆªå™¨æ˜¯å°†åŒæ­¥å’Œå¼‚æ­¥åˆ†ä¸ºä¸¤ç§æƒ…å†µçš„</li>
</ul>
<h2 id="å‚é“¾"><a href="#å‚é“¾" class="headerlink" title="å‚é“¾"></a>å‚é“¾</h2><ul>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzA5MjQwMzQyNw==&mid=2650744604&idx=1&sn=51d8d865c9848fd59f7763f5fb9ce789&chksm=88662490bf11ad86061ae76ff71a1177eeddab02c38d046eecd0e1ad25dc16f7591f91e9e3b2&scene=21#wechat_redirect">å­¦ä¹  axios æºç æ•´ä½“æ¶æ„ï¼Œæ‰“é€ å±äºè‡ªå·±çš„è¯·æ±‚åº“</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://www.axios-js.com/zh-cn/docs/#axios-spread-callback">axioså®˜ç½‘</a></p>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/08/14/%E6%BA%90%E7%A0%81/%E3%80%90%E6%BA%90%E7%A0%81%E3%80%91axios-%E6%8B%A6%E6%88%AA%E5%99%A8/" data-id="cmebduixj005tpwfmahfx3luy" data-title="axiosæ‹¦æˆªå™¨åŸç†" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/axios-%E6%BA%90%E7%A0%81/" rel="tag">axios æºç </a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-æºç /ã€æºç ã€‘axios-å–æ¶ˆè¯·æ±‚" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/08/14/%E6%BA%90%E7%A0%81/%E3%80%90%E6%BA%90%E7%A0%81%E3%80%91axios-%E5%8F%96%E6%B6%88%E8%AF%B7%E6%B1%82/" class="article-date">
  <time class="dt-published" datetime="2025-08-14T03:18:33.934Z" itemprop="datePublished">2025-08-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/axios-%E6%BA%90%E7%A0%81/">axios æºç </a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/08/14/%E6%BA%90%E7%A0%81/%E3%80%90%E6%BA%90%E7%A0%81%E3%80%91axios-%E5%8F%96%E6%B6%88%E8%AF%B7%E6%B1%82/">axioså–æ¶ˆè¯·æ±‚åŸç†</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://imgse.com/i/pFqWBin"><img src="https://s21.ax1x.com/2024/04/07/pFqWBin.png" alt="pFqWBin.png"></a></p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pFqWrR0"><img src="https://s21.ax1x.com/2024/04/07/pFqWrR0.png" alt="pFqWrR0.png"></a></p>
<h2 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">CancelToken</span> = axios.<span class="property">CancelToken</span>;</span><br><span class="line"><span class="keyword">const</span> source = <span class="title class_">CancelToken</span>.<span class="title function_">source</span>();</span><br><span class="line"></span><br><span class="line">axios</span><br><span class="line">  .<span class="title function_">get</span>(<span class="string">&quot;/get/server&quot;</span>, &#123;</span><br><span class="line">    <span class="attr">cancelToken</span>: source.<span class="property">token</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="keyword">function</span> (<span class="params">err</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (axios.<span class="title function_">isCancel</span>(err)) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è¯·æ±‚å–æ¶ˆ&quot;</span>, err.<span class="property">message</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// handle error</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å–æ¶ˆå‡½æ•°ã€‚</span></span><br><span class="line">source.<span class="title function_">cancel</span>(<span class="string">&quot;è°ƒç”¨cancelæ–¹æ³•&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="å–æ¶ˆç±»"><a href="#å–æ¶ˆç±»" class="headerlink" title="å–æ¶ˆç±»"></a>å–æ¶ˆç±»</h2><h3 id="CancelToken"><a href="#CancelToken" class="headerlink" title="CancelToken"></a>CancelToken</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// /lib/cancel/CancelToken.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">CancelToken</span>(<span class="params">executor</span>) &#123;</span><br><span class="line">  <span class="comment">// executorä¼ å…¥çš„å‡½æ•°ï¼Œå‚æ•°æ˜¯å–æ¶ˆå‡½æ•°ï¼Œè°ƒç”¨è¿™ä¸ªå‚æ•°å¯ä»¥ç›´æ¥å–æ¶ˆè¯·æ±‚</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> executor !== <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">&quot;executor must be a function.&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> resolvePromise;</span><br><span class="line">  <span class="comment">// å®ä¾‹åŒ–ä¸€ä¸ªPromise</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">promise</span> = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> <span class="title function_">promiseExecutor</span>(<span class="params">resolve</span>) &#123;</span><br><span class="line">    resolvePromise = resolve;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> token = <span class="variable language_">this</span>;</span><br><span class="line">  <span class="comment">// å¦‚æœæ‰§è¡Œäº†å–æ¶ˆï¼Œé‚£ä¹ˆå°±æ‰§è¡Œç›‘å¬å–æ¶ˆçš„å‡½æ•°</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">promise</span>.<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">cancel</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!token.<span class="property">_listeners</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> i;</span><br><span class="line">    <span class="keyword">var</span> l = token.<span class="property">_listeners</span>.<span class="property">length</span>;</span><br><span class="line">    <span class="comment">// å¾ªç¯æ‰§è¡Œ</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; l; i++) &#123;</span><br><span class="line">      token.<span class="property">_listeners</span>[i](cancel);</span><br><span class="line">    &#125;</span><br><span class="line">    token.<span class="property">_listeners</span> = <span class="literal">null</span>;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¿™ä¸ªæ²¡æœ‰åœ¨axiosé‡Œé¢çœ‹åˆ°ä½¿ç”¨è¿‡ï¼ŒçŒœæµ‹åº”è¯¥æ˜¯ä¹‹å‰è€axiosé—ç•™ä»£ç </span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">promise</span>.<span class="property">then</span> = <span class="keyword">function</span> (<span class="params">onfulfilled</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> _resolve;</span><br><span class="line">    <span class="keyword">var</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve</span>) &#123;</span><br><span class="line">      token.<span class="title function_">subscribe</span>(resolve);</span><br><span class="line">      _resolve = resolve;</span><br><span class="line">    &#125;).<span class="title function_">then</span>(onfulfilled);</span><br><span class="line"></span><br><span class="line">    promise.<span class="property">cancel</span> = <span class="keyword">function</span> <span class="title function_">reject</span>(<span class="params"></span>) &#123;</span><br><span class="line">      token.<span class="title function_">unsubscribe</span>(_resolve);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> promise;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">// æ‰§è¡Œä¼ å…¥çš„å‡½æ•°ï¼Œå½“source.cancelæ—¶ï¼Œå°±æ‰§è¡Œè¿™ä¸ªå›è°ƒ</span></span><br><span class="line">  <span class="title function_">executor</span>(<span class="keyword">function</span> <span class="title function_">cancel</span>(<span class="params">message</span>) &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœå·²ç»æœ‰reasonï¼Œé‚£ä¹ˆè¡¨ç¤ºæ˜¯å·²ç»å–æ¶ˆè¯·æ±‚äº†</span></span><br><span class="line">    <span class="keyword">if</span> (token.<span class="property">reason</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æŠŠCanceledErrorå®ä¾‹ä½œä¸ºä¸€ä¸ªreasonï¼Œå¹¶ä¸”æŠŠmessageä½œä¸ºreasonçš„message</span></span><br><span class="line">    token.<span class="property">reason</span> = <span class="keyword">new</span> <span class="title class_">CanceledError</span>(message);</span><br><span class="line">    <span class="comment">// æ‰§è¡Œthis.promise.then()çš„å›è°ƒ</span></span><br><span class="line">    <span class="title function_">resolvePromise</span>(token.<span class="property">reason</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆ¤æ–­æ˜¯å¦å·²ç»å–æ¶ˆï¼Œå› ä¸ºåªæœ‰reasonæœ‰å€¼æ—¶ï¼Œæ‰è¡¨ç¤ºå·²ç»å–æ¶ˆè¯·æ±‚äº†</span></span><br><span class="line"><span class="comment"> * å¦‚æœå·²ç»å–æ¶ˆè¯·æ±‚ï¼Œé‚£ä¹ˆç›´æ¥æŠ›å‡ºé”™è¯¯ï¼Œèµ°å…¥catch</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">CancelToken</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">throwIfRequested</span> = <span class="keyword">function</span> <span class="title function_">throwIfRequested</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">reason</span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="variable language_">this</span>.<span class="property">reason</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ·»åŠ å–æ¶ˆç›‘å¬å‡½æ•°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">CancelToken</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">subscribe</span> = <span class="keyword">function</span> <span class="title function_">subscribe</span>(<span class="params">listener</span>) &#123;</span><br><span class="line">  <span class="comment">// å¦‚æœå·²ç»æ‰§è¡Œå–æ¶ˆï¼Œé‚£ä¹ˆå°±ç›´æ¥æ‰§è¡Œç›‘å¬å‡½æ•°</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">reason</span>) &#123;</span><br><span class="line">    <span class="title function_">listener</span>(<span class="variable language_">this</span>.<span class="property">reason</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// å°†ç›‘å¬å‡½æ•°åŠ å…¥æ•°ç»„ä¸­</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_listeners</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_listeners</span>.<span class="title function_">push</span>(listener);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_listeners</span> = [listener];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆ é™¤ç›‘å¬å‡½æ•°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">CancelToken</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">unsubscribe</span> = <span class="keyword">function</span> <span class="title function_">unsubscribe</span>(<span class="params">listener</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">_listeners</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> index = <span class="variable language_">this</span>.<span class="property">_listeners</span>.<span class="title function_">indexOf</span>(listener);</span><br><span class="line">  <span class="keyword">if</span> (index !== -<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_listeners</span>.<span class="title function_">splice</span>(index, <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Returns an object that contains a new `CancelToken` and a function that, when called,</span></span><br><span class="line"><span class="comment"> * cancels the `CancelToken`.</span></span><br><span class="line"><span class="comment"> * è°ƒç”¨åˆ›å»ºå–æ¶ˆtokençš„å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«ä¸€ä¸ªå–æ¶ˆtokenå’Œä¸€ä¸ªå–æ¶ˆå‡½æ•°</span></span><br><span class="line"><span class="comment"> * tokenæ˜¯è¿”å›çš„å‡½æ•°å®ä¾‹ï¼Œå³å¯ä»¥ç›´æ¥è®¿é—®å‡½æ•°å†…éƒ¨</span></span><br><span class="line"><span class="comment"> * cancelæ˜¯åœ¨CancelTokené‡Œé¢æ‰§è¡Œexecutoræ—¶ï¼Œé‡Œé¢åŒ…è£¹çš„å›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">CancelToken</span>.<span class="property">source</span> = <span class="keyword">function</span> <span class="title function_">source</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> cancel;</span><br><span class="line">  <span class="comment">// åˆ›å»ºä¸€ä¸ªå®ä¾‹</span></span><br><span class="line">  <span class="keyword">var</span> token = <span class="keyword">new</span> <span class="title class_">CancelToken</span>(<span class="keyword">function</span> <span class="title function_">executor</span>(<span class="params">c</span>) &#123;</span><br><span class="line">    cancel = c;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// è¿”å›å®ä¾‹å’Œå–æ¶ˆè°ƒç”¨çš„å‡½æ•°</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">token</span>: token,</span><br><span class="line">    <span class="attr">cancel</span>: cancel,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title class_">CancelToken</span>;</span><br></pre></td></tr></table></figure>

<h2 id="å–æ¶ˆè°ƒç”¨æµç¨‹"><a href="#å–æ¶ˆè°ƒç”¨æµç¨‹" class="headerlink" title="å–æ¶ˆè°ƒç”¨æµç¨‹"></a>å–æ¶ˆè°ƒç”¨æµç¨‹</h2><p>ä»¥ä¸‹æ˜¯ä»¥æµè§ˆå™¨çš„æµç¨‹ä¸ºç¤ºä¾‹</p>
<ul>
<li><p><code>dispatchRequest</code>ä¸­åˆ¤æ–­ä¸€æ¬¡æ­¤è¯·æ±‚æ˜¯å¦ç¡®è®¤å–æ¶ˆ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// /lib/core/dispatchRequest.js</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">throwIfCancellationRequested</span>(<span class="params">config</span>) &#123;</span><br><span class="line">  <span class="comment">// å¦‚æœæœ‰cancelTokenï¼Œé‚£ä¹ˆè¡¨ç¤ºè¿™ä¸ªè¯·æ±‚æ˜¯å¯è¢«å–æ¶ˆçš„ï¼Œè°ƒç”¨cancelTokençš„è¯·æ±‚å–æ¶ˆæŠ¥é”™å³å¯ç»“æŸ</span></span><br><span class="line">  <span class="keyword">if</span> (config.<span class="property">cancelToken</span>) &#123;</span><br><span class="line">    config.<span class="property">cancelToken</span>.<span class="title function_">throwIfRequested</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (config.<span class="property">signal</span> &amp;&amp; config.<span class="property">signal</span>.<span class="property">aborted</span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">CanceledError</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨ xhr æ–‡ä»¶ä¸­ï¼Œè¿›è¡Œå–æ¶ˆç›‘å¬å‡½æ•°çš„æ·»åŠ </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¦‚æœé…ç½®åˆ—è¡¨é‡Œæœ‰cancelTokenï¼Œé‚£ä¹ˆè¡¨ç¤ºéœ€è¦èµ°å–æ¶ˆç›‘å¬</span></span><br><span class="line"><span class="comment">// /lib/adapters/xhr</span></span><br><span class="line"><span class="keyword">if</span> (config.<span class="property">cancelToken</span> || config.<span class="property">signal</span>) &#123;</span><br><span class="line">    <span class="comment">// å–æ¶ˆå‡½æ•°çš„å›è°ƒ</span></span><br><span class="line">    onCanceled = <span class="keyword">function</span>(<span class="params">cancel</span>) &#123;</span><br><span class="line">      <span class="comment">// å¦‚æœè¿™ä¸ªè¯·æ±‚å·²ç»è¿›è¡Œå®Œæˆäº†,é‚£ä¹ˆå°±ä¸èµ°åé¢çš„å‡½æ•°</span></span><br><span class="line">      <span class="keyword">if</span> (!request) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// å¦‚æœè¿™ä¸ªè¯·æ±‚è¿˜æ²¡æœ‰ç»“æŸæˆ–è€…å–æ¶ˆ,é‚£ä¹ˆå°±ä½¿è¯·æ±‚å›è°ƒèµ°å…¥catchä¸­</span></span><br><span class="line">      <span class="title function_">reject</span>(!cancel || (cancel &amp;&amp; cancel.<span class="property">type</span>) ? <span class="keyword">new</span> <span class="title class_">CanceledError</span>() : cancel);</span><br><span class="line">      <span class="comment">// å–æ¶ˆè¯·æ±‚.è°ƒç”¨xhrçš„å–æ¶ˆ</span></span><br><span class="line">      request.<span class="title function_">abort</span>();</span><br><span class="line">      <span class="comment">// è¡¨æ˜è¯·æ±‚å·²ç»ç»“æŸ,é˜²æ­¢é‡å¤å–æ¶ˆ</span></span><br><span class="line">      request = <span class="literal">null</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// å¦‚æœæœ‰cancelToken,é‚£ä¹ˆå°±æ·»åŠ å–æ¶ˆå‡½æ•°</span></span><br><span class="line">    config.<span class="property">cancelToken</span> &amp;&amp; config.<span class="property">cancelToken</span>.<span class="title function_">subscribe</span>(onCanceled);</span><br><span class="line">   <span class="comment">// è¿™ä¸ªæ˜¯é’ˆå¯¹äºfetchçš„å–æ¶ˆå¤„ç†</span></span><br><span class="line">    <span class="keyword">if</span> (config.<span class="property">signal</span>) &#123;</span><br><span class="line">      config.<span class="property">signal</span>.<span class="property">aborted</span> ? <span class="title function_">onCanceled</span>() : config.<span class="property">signal</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;abort&#x27;</span>, onCanceled);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>onCanceled</code>è¿™ä¸ªå‡½æ•°çš„æ‰§è¡Œæ˜¯åœ¨è°ƒç”¨<code>source.cancel()</code>æ‰§è¡Œçš„</p>
</li>
<li><p>è¯·æ±‚ç»“æŸå,åœ¨ xhr çš„<code>onloadend</code>&#x2F;<code>onreadystatechange</code>ä¹Ÿè¿›è¡Œäº†å¤„ç†</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¯·æ±‚ç»“æŸä¹‹åçš„å›è°ƒ,ä¸ç®¡æ˜¯å¤±è´¥è¿˜æ˜¯æˆåŠŸéƒ½ä¼šæ‰§è¡Œ</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">done</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// å¦‚æœæœ‰cancelToken,é‚£ä¹ˆå°±å–æ¶ˆç›‘å¬è®¢é˜…çš„è¿™ä¸ªå‡½æ•°</span></span><br><span class="line">  <span class="keyword">if</span> (config.<span class="property">cancelToken</span>) &#123;</span><br><span class="line">    config.<span class="property">cancelToken</span>.<span class="title function_">unsubscribe</span>(onCanceled);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// fetchåˆ™æ˜¯å–æ¶ˆç›‘å¬å–æ¶ˆçš„å‡½æ•°</span></span><br><span class="line">  <span class="keyword">if</span> (config.<span class="property">signal</span>) &#123;</span><br><span class="line">    config.<span class="property">signal</span>.<span class="title function_">removeEventListener</span>(<span class="string">&quot;abort&quot;</span>, onCanceled);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="string">&quot;onloadend&quot;</span> <span class="keyword">in</span> request) &#123;</span><br><span class="line">  <span class="comment">// Use onloadend if available</span></span><br><span class="line">  request.<span class="property">onloadend</span> = onloadend;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(onloadend);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">onloadend</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// å¦‚æœè¯·æ±‚å·²ç»å–æ¶ˆ,é‚£ä¹ˆç›´æ¥ç»“æŸå°±è¡Œ</span></span><br><span class="line">  <span class="keyword">if</span> (!request) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> responseHeaders =</span><br><span class="line">    <span class="string">&quot;getAllResponseHeaders&quot;</span> <span class="keyword">in</span> request</span><br><span class="line">      ? <span class="title function_">parseHeaders</span>(request.<span class="title function_">getAllResponseHeaders</span>())</span><br><span class="line">      : <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">var</span> responseData =</span><br><span class="line">    !responseType || responseType === <span class="string">&quot;text&quot;</span> || responseType === <span class="string">&quot;json&quot;</span></span><br><span class="line">      ? request.<span class="property">responseText</span></span><br><span class="line">      : request.<span class="property">response</span>;</span><br><span class="line">  <span class="keyword">var</span> response = &#123;</span><br><span class="line">    <span class="attr">data</span>: responseData,</span><br><span class="line">    <span class="attr">status</span>: request.<span class="property">status</span>,</span><br><span class="line">    <span class="attr">statusText</span>: request.<span class="property">statusText</span>,</span><br><span class="line">    <span class="attr">headers</span>: responseHeaders,</span><br><span class="line">    <span class="attr">config</span>: config,</span><br><span class="line">    <span class="attr">request</span>: request,</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">// ç”¨è¯·æ±‚ç»“æœå»è¿›è¡Œåˆ¤æ–­</span></span><br><span class="line">  <span class="title function_">settle</span>(</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">_resolve</span>(<span class="params">value</span>) &#123;</span><br><span class="line">      <span class="title function_">resolve</span>(value);</span><br><span class="line">      <span class="title function_">done</span>();</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">_reject</span>(<span class="params">err</span>) &#123;</span><br><span class="line">      <span class="title function_">reject</span>(err);</span><br><span class="line">      <span class="title function_">done</span>();</span><br><span class="line">    &#125;,</span><br><span class="line">    response</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// /lib/core/settle.js</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">settle</span>(<span class="params">resolve, reject, response</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> validateStatus = response.<span class="property">config</span>.<span class="property">validateStatus</span>;</span><br><span class="line">  <span class="comment">// å¦‚æœè¯·æ±‚è¿”å›çŠ¶æ€æ˜¯åˆç†çš„,é‚£ä¹ˆå°±ç›´æ¥resolve</span></span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    !response.<span class="property">status</span> ||</span><br><span class="line">    !validateStatus ||</span><br><span class="line">    <span class="title function_">validateStatus</span>(response.<span class="property">status</span>)</span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="title function_">resolve</span>(response);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_">reject</span>(</span><br><span class="line">      <span class="keyword">new</span> <span class="title class_">AxiosError</span>(</span><br><span class="line">        <span class="string">&quot;Request failed with status code &quot;</span> + response.<span class="property">status</span>,</span><br><span class="line">        [<span class="title class_">AxiosError</span>.<span class="property">ERR_BAD_REQUEST</span>, <span class="title class_">AxiosError</span>.<span class="property">ERR_BAD_RESPONSE</span>][</span><br><span class="line">          <span class="title class_">Math</span>.<span class="title function_">floor</span>(response.<span class="property">status</span> / <span class="number">100</span>) - <span class="number">4</span></span><br><span class="line">        ],</span><br><span class="line">        response.<span class="property">config</span>,</span><br><span class="line">        response.<span class="property">request</span>,</span><br><span class="line">        response</span><br><span class="line">      )</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>è¯·æ±‚ç»“æŸå,åœ¨<code>dispatchRequest</code>ä¸­,ä¹Ÿæœ‰ç›¸å¯¹äºå–æ¶ˆè¯·æ±‚çš„å¤„ç†</p>
<p>å…¶å®å’Œå¼€å§‹è¯·æ±‚ä¹‹å‰çš„é€»è¾‘ä¸€æ ·</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="title function_">adapter</span>(config).<span class="title function_">then</span>(<span class="keyword">function</span> <span class="title function_">onAdapterResolution</span>(<span class="params">response</span>) &#123;</span><br><span class="line">  <span class="title function_">throwIfCancellationRequested</span>(config);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ul>
<p>æ€»ç»“: </p>
<ul>
<li><p>å¯¹äºè¯·æ±‚å¼€å§‹å‰å’Œç»“æŸå,éƒ½æ˜¯åœ¨<code>dispatchRequest</code>æ–‡ä»¶ä¸­è°ƒç”¨<code>cancelToken.throwIfRequested()</code>è¿›è¡Œè¯·æ±‚å–æ¶ˆçš„</p>
</li>
<li><p>å¯¹äºå·²ç»å¼€å§‹è¯·æ±‚çš„,åˆ†ä¸ºä¸¤ä¸ª</p>
<ul>
<li><p>è¯·æ±‚ç»“æœè¿˜æœªè¿”å›: è°ƒç”¨<code>cancelToken.subscribe()</code>è¿›è¡Œè¯·æ±‚å–æ¶ˆå›è°ƒçš„<strong>æ·»åŠ </strong></p>
</li>
<li><p>è¯·æ±‚ç»“æœå·²ç»è¿”å›: è°ƒç”¨<code>cancelToken.unsubscribe()</code>è¿›è¡Œè¯·æ±‚å–æ¶ˆå›è°ƒçš„<strong>åˆ é™¤</strong></p>
</li>
<li><p>å–æ¶ˆè¯·æ±‚å›è°ƒå…·ä½“æ˜¯åœ¨å¤–éƒ¨è°ƒç”¨<code>source.cancel</code>è¿›è¡Œçš„,å› æ­¤ä¼šå­˜åœ¨è¯·æ±‚ç»“æœå‰æˆ–è€…è¯·æ±‚ç»“æœè¿”å›åéƒ½å­˜åœ¨çš„æƒ…å†µ</p>
</li>
</ul>
</li>
</ul>
<h2 id="å‚é“¾"><a href="#å‚é“¾" class="headerlink" title="å‚é“¾"></a>å‚é“¾</h2><ul>
<li><p><a target="_blank" rel="noopener" href="https://juejin.cn/post/7284417436752265277?searchId=202403261358326BBE4B654AB52795AB71">äº”åˆ†é’Ÿï¼è®©ä½ å½»åº•ææ‡‚axiosçš„è¯·æ±‚å–æ¶ˆåŸç†ï¼é™„æºç åˆ†æ</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzA5MjQwMzQyNw==&mid=2650744604&idx=1&sn=51d8d865c9848fd59f7763f5fb9ce789&chksm=88662490bf11ad86061ae76ff71a1177eeddab02c38d046eecd0e1ad25dc16f7591f91e9e3b2&scene=21#wechat_redirect">å­¦ä¹  axios æºç æ•´ä½“æ¶æ„ï¼Œæ‰“é€ å±äºè‡ªå·±çš„è¯·æ±‚åº“</a></p>
<p>æ³¨:ç”±äºè¿™ç¯‡æ–‡ç« æ—¶é—´è¾ƒä¹…,æ‰€ä»¥é‡Œé¢å¯¹äºxhrçš„å–æ¶ˆå¤„ç†æ˜¯ä¹‹å‰çš„æµç¨‹,å’Œç°åœ¨çš„æœ€æ–°ç‰ˆæœ¬ä¸ä¸€è‡´</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/API/AbortController">AbortController</a></p>
<p>é’ˆå¯¹äºfetchçš„å–æ¶ˆè¯·æ±‚å¤„ç†æ§åˆ¶å™¨</p>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/08/14/%E6%BA%90%E7%A0%81/%E3%80%90%E6%BA%90%E7%A0%81%E3%80%91axios-%E5%8F%96%E6%B6%88%E8%AF%B7%E6%B1%82/" data-id="cmebduixd005fpwfmdbx916or" data-title="axioså–æ¶ˆè¯·æ±‚åŸç†" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/axios-%E6%BA%90%E7%A0%81/" rel="tag">axios æºç </a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/HTML/">HTML</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/HTTP/">HTTP</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JS/">JS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/PWA/">PWA</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/React-Native/">React Native</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Typescript/">Typescript</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/VueTest/">VueTest</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Web3/">Web3</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/axios-%E6%BA%90%E7%A0%81/">axios æºç </a></li><li class="category-list-item"><a class="category-list-link" href="/categories/css/">css</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/http/">http</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/js/">js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/react/">react</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/vue/">vue</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/vuex-%E6%BA%90%E7%A0%81/">vuex æºç </a></li><li class="category-list-item"><a class="category-list-link" href="/categories/web3/">web3</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/webAssembly/">webAssembly</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/webpack/">webpack</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/webwork/">webwork</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%B8%9A%E5%8A%A1%E5%9C%BA%E6%99%AF/">ä¸šåŠ¡åœºæ™¯</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%89%8D%E7%AB%AF/">å‰ç«¯</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B0%8F%E7%A8%8B%E5%BA%8F/">å°ç¨‹åº</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%89%A9%E5%B1%95%E9%98%85%E8%AF%BB/">æ‰©å±•é˜…è¯»</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%B5%8F%E8%A7%88%E5%99%A8/">æµè§ˆå™¨</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%A2%9D%E5%A4%96%E5%86%85%E5%AE%B9/">é¢å¤–å†…å®¹</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML/" rel="tag">HTML</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Typescript/" rel="tag">Typescript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VueTest/" rel="tag">VueTest</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web3/" rel="tag">Web3</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/axios-%E6%BA%90%E7%A0%81/" rel="tag">axios æºç </a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/chrome/" rel="tag">chrome</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/console/" rel="tag">console</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/" rel="tag">css</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http/" rel="tag">http</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/" rel="tag">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/react/" rel="tag">react</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue/" rel="tag">vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vuex-%E6%BA%90%E7%A0%81/" rel="tag">vuex æºç </a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web3/" rel="tag">web3</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webAssembly/" rel="tag">webAssembly</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webRTC/" rel="tag">webRTC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webpack/" rel="tag">webpack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webwork/" rel="tag">webwork</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%9A%E5%8A%A1%E5%9C%BA%E6%99%AF/" rel="tag">ä¸šåŠ¡åœºæ™¯</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF/" rel="tag">å‰ç«¯</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/" rel="tag">å°ç¨‹åº</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%89%A9%E5%B1%95%E9%98%85%E8%AF%BB/" rel="tag">æ‰©å±•é˜…è¯»</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/" rel="tag">æµè§ˆå™¨</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B5%8F%E8%A7%88%E5%99%A8-Performance-Chrome/" rel="tag">æµè§ˆå™¨ Performance Chrome</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%A2%9D%E5%A4%96%E5%86%85%E5%AE%B9/" rel="tag">é¢å¤–å†…å®¹</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/HTML/" style="font-size: 10px;">HTML</a> <a href="/tags/Typescript/" style="font-size: 12px;">Typescript</a> <a href="/tags/VueTest/" style="font-size: 10px;">VueTest</a> <a href="/tags/Web3/" style="font-size: 20px;">Web3</a> <a href="/tags/axios-%E6%BA%90%E7%A0%81/" style="font-size: 14px;">axios æºç </a> <a href="/tags/chrome/" style="font-size: 10px;">chrome</a> <a href="/tags/console/" style="font-size: 10px;">console</a> <a href="/tags/css/" style="font-size: 18px;">css</a> <a href="/tags/http/" style="font-size: 12px;">http</a> <a href="/tags/js/" style="font-size: 20px;">js</a> <a href="/tags/react/" style="font-size: 12px;">react</a> <a href="/tags/vue/" style="font-size: 12px;">vue</a> <a href="/tags/vuex-%E6%BA%90%E7%A0%81/" style="font-size: 12px;">vuex æºç </a> <a href="/tags/web3/" style="font-size: 12px;">web3</a> <a href="/tags/webAssembly/" style="font-size: 10px;">webAssembly</a> <a href="/tags/webRTC/" style="font-size: 12px;">webRTC</a> <a href="/tags/webpack/" style="font-size: 10px;">webpack</a> <a href="/tags/webwork/" style="font-size: 10px;">webwork</a> <a href="/tags/%E4%B8%9A%E5%8A%A1%E5%9C%BA%E6%99%AF/" style="font-size: 10px;">ä¸šåŠ¡åœºæ™¯</a> <a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 20px;">å‰ç«¯</a> <a href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 12px;">å°ç¨‹åº</a> <a href="/tags/%E6%89%A9%E5%B1%95%E9%98%85%E8%AF%BB/" style="font-size: 12px;">æ‰©å±•é˜…è¯»</a> <a href="/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/" style="font-size: 16px;">æµè§ˆå™¨</a> <a href="/tags/%E6%B5%8F%E8%A7%88%E5%99%A8-Performance-Chrome/" style="font-size: 10px;">æµè§ˆå™¨ Performance Chrome</a> <a href="/tags/%E9%A2%9D%E5%A4%96%E5%86%85%E5%AE%B9/" style="font-size: 10px;">é¢å¤–å†…å®¹</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/08/">August 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/10/">October 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">July 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/08/14/%E6%89%8B%E5%86%99%E9%A2%98/">æ‰‹å†™é¢˜</a>
          </li>
        
          <li>
            <a href="/2025/08/14/%E3%80%90%E6%89%8B%E5%86%99%E3%80%91call%E3%80%81apply%E3%80%81bind/">ã€æ‰‹å†™ã€‘callã€applyã€bind</a>
          </li>
        
          <li>
            <a href="/2025/08/14/%E3%80%90wasb%E3%80%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">ã€wasbã€‘ç¯å¢ƒæ­å»º</a>
          </li>
        
          <li>
            <a href="/2025/08/14/%E3%80%90RN%E3%80%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">ã€RNã€‘ç¯å¢ƒæ­å»º</a>
          </li>
        
          <li>
            <a href="/2025/08/14/%E3%80%90AST%E3%80%91-%E8%A7%A3%E6%9E%90attrs/">è§£æ attrs</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 yangxin<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>